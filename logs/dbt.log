

============================== 2023-04-19 10:07:43.054395 | b7dbf154-ec89-4d9a-abbf-60ec6a5a7e14 ==============================
[0m10:07:43.054395 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:07:43.057236 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'c:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m10:07:43.058222 [debug] [MainThread]: Tracking: tracking
[0m10:07:43.058222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983C7C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983C7C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983C7CFD0>]}
[0m10:07:43.207134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:43.207134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:43.215094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7dbf154-ec89-4d9a-abbf-60ec6a5a7e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983DA70D0>]}
[0m10:07:43.228095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7dbf154-ec89-4d9a-abbf-60ec6a5a7e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983CD1730>]}
[0m10:07:43.229097 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 305 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:07:43.229097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7dbf154-ec89-4d9a-abbf-60ec6a5a7e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983CD1970>]}
[0m10:07:43.231093 [info ] [MainThread]: 
[0m10:07:43.233108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:07:43.235133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m10:07:43.251317 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m10:07:43.252315 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m10:07:43.252895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:44.176823 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m10:07:44.181883 [debug] [ThreadPool]: On list_PERSO: Close
[0m10:07:44.336926 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PERSO_ARO_DWH'
[0m10:07:44.338039 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PERSO_ARO_DWH'
[0m10:07:44.338039 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='perso', schema='aro_dwh', identifier=None)"
[0m10:07:44.343925 [debug] [ThreadPool]: Using snowflake connection "create_PERSO_ARO_DWH"
[0m10:07:44.344958 [debug] [ThreadPool]: On create_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "create_PERSO_ARO_DWH"} */
create schema if not exists PERSO.ARO_DWH
[0m10:07:44.345465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:44.936524 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m10:07:44.937518 [debug] [ThreadPool]: On create_PERSO_ARO_DWH: Close
[0m10:07:45.493022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m10:07:45.500020 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m10:07:45.501021 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m10:07:45.502023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:45.975447 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0 seconds
[0m10:07:45.977660 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m10:07:46.168069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7dbf154-ec89-4d9a-abbf-60ec6a5a7e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983CD1370>]}
[0m10:07:46.169102 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m10:07:46.170063 [info ] [MainThread]: 
[0m10:07:46.181270 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m10:07:46.182269 [info ] [Thread-1  ]: 1 of 1 START sql incremental model ARO_DWH.conso_client ........................ [RUN]
[0m10:07:46.184271 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m10:07:46.185270 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m10:07:46.203269 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m10:07:46.209384 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 10:07:46.186271 => 2023-04-19 10:07:46.209384
[0m10:07:46.210270 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m10:07:46.286276 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m10:07:46.292273 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m10:07:46.292273 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
create or replace transient table PERSO.ARO_DWH.conso_client  as
        (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_PERSO.ARO_DWH.conso_client


        );
[0m10:07:46.293268 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:07:46.972978 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abba9f-3201-ba10-0001-2d1600366c8e
[0m10:07:46.972978 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:07:46.974114 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 10:07:46.210270 => 2023-04-19 10:07:46.974114
[0m10:07:46.974979 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m10:07:47.087282 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m10:07:47.087282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7dbf154-ec89-4d9a-abbf-60ec6a5a7e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9841640A0>]}
[0m10:07:47.088911 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model ARO_DWH.conso_client ............... [[31mERROR[0m in 0.90s]
[0m10:07:47.090285 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m10:07:47.093299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:07:47.094273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:47.095252 [debug] [MainThread]: Connection 'create_PERSO_ARO_DWH' was properly closed.
[0m10:07:47.095561 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m10:07:47.095561 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m10:07:47.096253 [info ] [MainThread]: 
[0m10:07:47.097100 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m10:07:47.097249 [debug] [MainThread]: Command end result
[0m10:07:47.112249 [info ] [MainThread]: 
[0m10:07:47.113321 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:07:47.114252 [info ] [MainThread]: 
[0m10:07:47.114252 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m10:07:47.115252 [error] [MainThread]:   002043 (02000): SQL compilation error:
[0m10:07:47.116309 [error] [MainThread]:   Object does not exist, or operation cannot be performed.
[0m10:07:47.117250 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m10:07:47.121249 [info ] [MainThread]: 
[0m10:07:47.121249 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:07:47.122251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983DA76A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9831A6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A983C7C340>]}
[0m10:07:47.123358 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 10:08:28.036630 | fcfe1363-186d-431b-9521-40ae5f13e859 ==============================
[0m10:08:28.036630 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:08:28.039595 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:08:28.039595 [debug] [MainThread]: Tracking: tracking
[0m10:08:28.040769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39E65BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39E65F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39E65E50>]}
[0m10:08:28.286657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:08:28.290656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:08:28.304659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcfe1363-186d-431b-9521-40ae5f13e859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39F96DF0>]}
[0m10:08:28.321655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcfe1363-186d-431b-9521-40ae5f13e859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39F57D30>]}
[0m10:08:28.322655 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 305 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:08:28.324657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfe1363-186d-431b-9521-40ae5f13e859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39EF1040>]}
[0m10:08:28.325658 [info ] [MainThread]: 
[0m10:08:28.333657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:08:28.335654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m10:08:28.371655 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m10:08:28.372656 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m10:08:28.373663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:29.170748 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m10:08:29.173748 [debug] [ThreadPool]: On list_PERSO: Close
[0m10:08:29.914219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m10:08:29.925219 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m10:08:29.926219 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m10:08:29.927434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:30.459927 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m10:08:30.464909 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m10:08:30.590265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfe1363-186d-431b-9521-40ae5f13e859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39F57E20>]}
[0m10:08:30.591267 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m10:08:30.594616 [info ] [MainThread]: 
[0m10:08:30.607268 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m10:08:30.609269 [info ] [Thread-1  ]: 1 of 1 START sql incremental model ARO_DWH.conso_client ........................ [RUN]
[0m10:08:30.613271 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m10:08:30.614374 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m10:08:30.638476 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m10:08:30.642712 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 10:08:30.616108 => 2023-04-19 10:08:30.642712
[0m10:08:30.647476 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m10:08:30.785656 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m10:08:30.788569 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m10:08:30.789568 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
create or replace transient table PERSO.ARO_DWH.conso_client  as
        (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_PERSO.ARO_DWH.conso_client


        );
[0m10:08:30.793571 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:08:31.129710 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbaa0-3201-bb68-0001-2d160036f3da
[0m10:08:31.130712 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:08:31.131709 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 10:08:30.648712 => 2023-04-19 10:08:31.131709
[0m10:08:31.131709 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m10:08:31.612951 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m10:08:31.612951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfe1363-186d-431b-9521-40ae5f13e859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3A3741F0>]}
[0m10:08:31.614664 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model ARO_DWH.conso_client ............... [[31mERROR[0m in 1.00s]
[0m10:08:31.617951 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m10:08:31.620949 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:08:31.622121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:31.623266 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m10:08:31.623923 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m10:08:31.624924 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m10:08:31.625920 [info ] [MainThread]: 
[0m10:08:31.628922 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m10:08:31.631953 [debug] [MainThread]: Command end result
[0m10:08:31.649923 [info ] [MainThread]: 
[0m10:08:31.651926 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:08:31.657356 [info ] [MainThread]: 
[0m10:08:31.659918 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m10:08:31.661928 [error] [MainThread]:   002043 (02000): SQL compilation error:
[0m10:08:31.662917 [error] [MainThread]:   Object does not exist, or operation cannot be performed.
[0m10:08:31.664919 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m10:08:31.666104 [info ] [MainThread]: 
[0m10:08:31.667922 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:08:31.674937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39E82730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39EF1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B39F57E20>]}
[0m10:08:31.676922 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 10:08:45.791600 | 5f5e2e34-05cc-455d-b632-c11b497bbe68 ==============================
[0m10:08:45.791600 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:08:45.794222 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m10:08:45.794222 [debug] [MainThread]: Tracking: tracking
[0m10:08:45.795225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B50A6BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B50A6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B50A6E50>]}
[0m10:08:45.948296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:08:45.948296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:08:45.956269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f5e2e34-05cc-455d-b632-c11b497bbe68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B51D7DF0>]}
[0m10:08:45.966854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f5e2e34-05cc-455d-b632-c11b497bbe68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B5198F10>]}
[0m10:08:45.967307 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 305 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:08:45.968268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f5e2e34-05cc-455d-b632-c11b497bbe68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B519F040>]}
[0m10:08:45.969268 [info ] [MainThread]: 
[0m10:08:45.972269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:08:45.974266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m10:08:45.993360 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m10:08:45.994157 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m10:08:45.994267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:46.720711 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m10:08:46.724743 [debug] [ThreadPool]: On list_PERSO: Close
[0m10:08:46.827819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m10:08:46.837820 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m10:08:46.838853 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m10:08:46.839852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:47.124436 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0 seconds
[0m10:08:47.126431 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m10:08:47.243884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f5e2e34-05cc-455d-b632-c11b497bbe68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B5198DC0>]}
[0m10:08:47.245889 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m10:08:47.248883 [info ] [MainThread]: 
[0m10:08:47.261883 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m10:08:47.262913 [info ] [Thread-1  ]: 1 of 1 START sql incremental model ARO_DWH.conso_client ........................ [RUN]
[0m10:08:47.264880 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m10:08:47.264880 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m10:08:47.278915 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m10:08:47.279916 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 10:08:47.265909 => 2023-04-19 10:08:47.279916
[0m10:08:47.280954 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m10:08:47.355918 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m10:08:47.357876 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m10:08:47.357876 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
create or replace transient table PERSO.ARO_DWH.conso_client  as
        (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_PERSO.ARO_DWH.conso_client


        );
[0m10:08:47.357876 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:08:47.865838 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbaa0-3201-ba10-0001-2d1600366c9a
[0m10:08:47.865838 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:08:47.866868 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 10:08:47.280954 => 2023-04-19 10:08:47.866868
[0m10:08:47.867866 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m10:08:48.023802 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m10:08:48.024802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f5e2e34-05cc-455d-b632-c11b497bbe68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B55B41F0>]}
[0m10:08:48.025587 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model ARO_DWH.conso_client ............... [[31mERROR[0m in 0.76s]
[0m10:08:48.028814 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m10:08:48.031774 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:08:48.032877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:48.033779 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m10:08:48.034810 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m10:08:48.035777 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m10:08:48.036773 [info ] [MainThread]: 
[0m10:08:48.037780 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m10:08:48.039778 [debug] [MainThread]: Command end result
[0m10:08:48.049774 [info ] [MainThread]: 
[0m10:08:48.051778 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:08:48.054137 [info ] [MainThread]: 
[0m10:08:48.054774 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m10:08:48.056855 [error] [MainThread]:   002043 (02000): SQL compilation error:
[0m10:08:48.057777 [error] [MainThread]:   Object does not exist, or operation cannot be performed.
[0m10:08:48.059866 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m10:08:48.061775 [info ] [MainThread]: 
[0m10:08:48.063774 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:08:48.064867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B50C2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B51C18B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B519F040>]}
[0m10:08:48.064867 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 10:09:21.743222 | 8ca82f10-0539-493a-9bd5-b4ca85d0f09e ==============================
[0m10:09:21.743222 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:09:21.745181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m10:09:21.746181 [debug] [MainThread]: Tracking: tracking
[0m10:09:21.746181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDEDA6C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDEDA6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDEDA6EB0>]}
[0m10:09:21.903377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:21.903377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:21.910231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ca82f10-0539-493a-9bd5-b4ca85d0f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDEED6E50>]}
[0m10:09:21.922183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ca82f10-0539-493a-9bd5-b4ca85d0f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDEE97FD0>]}
[0m10:09:21.922183 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 305 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:09:21.924183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ca82f10-0539-493a-9bd5-b4ca85d0f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDEE9F130>]}
[0m10:09:21.925225 [info ] [MainThread]: 
[0m10:09:21.927183 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:09:21.929184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m10:09:21.948222 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m10:09:21.948222 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m10:09:21.949187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:23.217613 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m10:09:23.220614 [debug] [ThreadPool]: On list_PERSO: Close
[0m10:09:23.628998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m10:09:23.637033 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m10:09:23.637033 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m10:09:23.638107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:24.158760 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m10:09:24.161757 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m10:09:24.258182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ca82f10-0539-493a-9bd5-b4ca85d0f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDEE97D60>]}
[0m10:09:24.259185 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m10:09:24.261151 [info ] [MainThread]: 
[0m10:09:24.270818 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m10:09:24.271965 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m10:09:24.275742 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m10:09:24.276742 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m10:09:24.291776 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m10:09:24.292734 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 10:09:24.277744 => 2023-04-19 10:09:24.292734
[0m10:09:24.293736 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m10:09:24.295738 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 10:09:24.294200 => 2023-04-19 10:09:24.295738
[0m10:09:24.298234 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  No materialization 'incremental_stream' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m10:09:24.298772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca82f10-0539-493a-9bd5-b4ca85d0f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDF24CB80>]}
[0m10:09:24.299073 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.02s]
[0m10:09:24.302740 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m10:09:24.306771 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:09:24.307988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:24.308736 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m10:09:24.308736 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m10:09:24.308736 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m10:09:24.309737 [info ] [MainThread]: 
[0m10:09:24.310736 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m10:09:24.312754 [debug] [MainThread]: Command end result
[0m10:09:24.325737 [info ] [MainThread]: 
[0m10:09:24.326738 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:09:24.328738 [info ] [MainThread]: 
[0m10:09:24.330901 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m10:09:24.332743 [error] [MainThread]:   No materialization 'incremental_stream' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m10:09:24.334741 [info ] [MainThread]: 
[0m10:09:24.335739 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:09:24.336741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDEDC22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDF2AA520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FDF2AA850>]}
[0m10:09:24.338971 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 10:11:46.228223 | 318fd8e8-0540-4809-aa9d-3a63fb95befa ==============================
[0m10:11:46.228223 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:11:46.231235 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m10:11:46.231235 [debug] [MainThread]: Tracking: tracking
[0m10:11:46.232227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245606E5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245606E5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245606E5EB0>]}
[0m10:11:46.386801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:46.386801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:46.392801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '318fd8e8-0540-4809-aa9d-3a63fb95befa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024560816E50>]}
[0m10:11:46.403802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '318fd8e8-0540-4809-aa9d-3a63fb95befa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245607D7FD0>]}
[0m10:11:46.404803 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 305 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:11:46.405808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '318fd8e8-0540-4809-aa9d-3a63fb95befa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245607DF130>]}
[0m10:11:46.406807 [info ] [MainThread]: 
[0m10:11:46.409802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:46.411808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m10:11:46.432492 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m10:11:46.433982 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m10:11:46.434546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:47.300173 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m10:11:47.302177 [debug] [ThreadPool]: On list_PERSO: Close
[0m10:11:47.560993 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m10:11:47.570025 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m10:11:47.570025 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m10:11:47.571002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:48.087067 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m10:11:48.089941 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m10:11:48.298471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '318fd8e8-0540-4809-aa9d-3a63fb95befa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245607D7D60>]}
[0m10:11:48.301206 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m10:11:48.304712 [info ] [MainThread]: 
[0m10:11:48.322713 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m10:11:48.324710 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m10:11:48.328709 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m10:11:48.329706 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m10:11:48.344049 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m10:11:48.346220 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 10:11:48.329933 => 2023-04-19 10:11:48.346220
[0m10:11:48.346220 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m10:11:48.349996 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 10:11:48.347006 => 2023-04-19 10:11:48.349996
[0m10:11:48.354900 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  No materialization 'incremental_stream' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m10:11:48.356036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '318fd8e8-0540-4809-aa9d-3a63fb95befa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024560B8CB80>]}
[0m10:11:48.356930 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.03s]
[0m10:11:48.360930 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m10:11:48.362921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:48.363934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:48.363934 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m10:11:48.363934 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m10:11:48.365937 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m10:11:48.366894 [info ] [MainThread]: 
[0m10:11:48.369923 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m10:11:48.372034 [debug] [MainThread]: Command end result
[0m10:11:48.386896 [info ] [MainThread]: 
[0m10:11:48.387907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:11:48.389894 [info ] [MainThread]: 
[0m10:11:48.390897 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m10:11:48.391930 [error] [MainThread]:   No materialization 'incremental_stream' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m10:11:48.393892 [info ] [MainThread]: 
[0m10:11:48.394893 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:11:48.396896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024560702460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024560BD6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024560BD63D0>]}
[0m10:11:48.396896 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 10:28:11.381147 | 3bbc2293-d3f4-4926-a7c6-0a64efdd8a1c ==============================
[0m10:28:11.381147 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:28:11.383151 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m10:28:11.384152 [debug] [MainThread]: Tracking: tracking
[0m10:28:11.384152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020853067C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020853067F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020853067EB0>]}
[0m10:28:11.533153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:28:11.534344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:28:11.541151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bbc2293-d3f4-4926-a7c6-0a64efdd8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208531940D0>]}
[0m10:28:11.553154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bbc2293-d3f4-4926-a7c6-0a64efdd8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020853161280>]}
[0m10:28:11.554158 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:28:11.555154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bbc2293-d3f4-4926-a7c6-0a64efdd8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208531614C0>]}
[0m10:28:11.556154 [info ] [MainThread]: 
[0m10:28:11.559154 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:28:11.561155 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m10:28:11.582475 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m10:28:11.583215 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m10:28:11.583215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:12.288476 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m10:28:12.289477 [debug] [ThreadPool]: On list_PERSO: Close
[0m10:28:12.389482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m10:28:12.396480 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m10:28:12.397480 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m10:28:12.398092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:12.850161 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0 seconds
[0m10:28:12.851150 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m10:28:12.944139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bbc2293-d3f4-4926-a7c6-0a64efdd8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020853161160>]}
[0m10:28:12.945128 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m10:28:12.946123 [info ] [MainThread]: 
[0m10:28:12.955124 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m10:28:12.956225 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m10:28:12.958126 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m10:28:12.958126 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m10:28:12.965128 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m10:28:12.967128 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 10:28:12.958126 => 2023-04-19 10:28:12.966125
[0m10:28:12.967385 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m10:28:13.030173 [info ] [Thread-1  ]:   => Create if not exits of the target stream in mode create PERSO.ARO_DWH.S_conso_client
[0m10:28:13.032128 [info ] [Thread-1  ]:   => Create if not exits of the target view in mode create PERSO.ARO_DWH.V_conso_client
[0m10:28:13.037266 [info ] [Thread-1  ]:   => Create if not exits of the target table in mode create PERSO.ARO_DWH.conso_client
[0m10:28:13.039129 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m10:28:13.041858 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m10:28:13.041858 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m10:28:13.043069 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:28:13.810044 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m10:28:13.810760 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m10:28:13.811761 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE VIEW IF NOT EXISTS PERSO.ARO_DWH.V_conso_client
        AS (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_PERSO.ARO_DWH.conso_client
);
[0m10:28:14.217562 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbab4-3201-ba28-0001-2d1600361ef6
[0m10:28:14.218321 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:28:14.218321 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 10:28:12.967385 => 2023-04-19 10:28:14.218321
[0m10:28:14.219320 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m10:28:14.359461 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m10:28:14.361465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bbc2293-d3f4-4926-a7c6-0a64efdd8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002085350F940>]}
[0m10:28:14.363466 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.40s]
[0m10:28:14.369072 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m10:28:14.373529 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:28:14.375009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:14.375009 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m10:28:14.376222 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m10:28:14.377006 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m10:28:14.378010 [info ] [MainThread]: 
[0m10:28:14.379004 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m10:28:14.380004 [debug] [MainThread]: Command end result
[0m10:28:14.395007 [info ] [MainThread]: 
[0m10:28:14.396009 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:28:14.398328 [info ] [MainThread]: 
[0m10:28:14.400124 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m10:28:14.402007 [error] [MainThread]:   002043 (02000): SQL compilation error:
[0m10:28:14.403008 [error] [MainThread]:   Object does not exist, or operation cannot be performed.
[0m10:28:14.404006 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m10:28:14.405009 [info ] [MainThread]: 
[0m10:28:14.407010 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:28:14.409830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020853074610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020853161160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020853082CD0>]}
[0m10:28:14.410825 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 12:38:48.016243 | c01b8823-fc76-4ae9-a77a-4e783d805420 ==============================
[0m12:38:48.016243 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:38:48.022202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m12:38:48.023537 [debug] [MainThread]: Tracking: tracking
[0m12:38:48.025198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51977C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51977F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51977E80>]}
[0m12:38:48.258611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:48.258611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:48.271208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c01b8823-fc76-4ae9-a77a-4e783d805420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51AA3FD0>]}
[0m12:38:48.291180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c01b8823-fc76-4ae9-a77a-4e783d805420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51A01250>]}
[0m12:38:48.291180 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:38:48.293183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c01b8823-fc76-4ae9-a77a-4e783d805420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51A01490>]}
[0m12:38:48.296250 [info ] [MainThread]: 
[0m12:38:48.300179 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:48.302209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:38:48.346179 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:38:48.347335 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:38:48.349185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:49.498116 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:38:49.505056 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:38:49.620091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:38:49.650162 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:38:49.653094 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:38:49.654150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:50.513508 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m12:38:50.520436 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:38:50.639402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c01b8823-fc76-4ae9-a77a-4e783d805420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51A01130>]}
[0m12:38:50.641371 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:38:50.644371 [info ] [MainThread]: 
[0m12:38:50.710682 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:38:50.714211 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:38:50.722206 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:38:50.726230 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:38:50.797352 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:38:50.853143 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 12:38:50.728208 => 2023-04-19 12:38:50.853143
[0m12:38:50.857140 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:38:50.931108 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:38:50.931108 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:38:50.932109 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:38:52.062516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m12:38:52.194552 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:38:52.196746 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m12:38:52.531689 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbb36-3201-ba67-0001-2d160037007e
[0m12:38:52.532714 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'PERSO.ARO_DWH.V_CONSO_CLIENT' does not exist or not authorized.
[0m12:38:52.534691 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m12:38:52.534691 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m12:38:52.535690 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 12:38:50.859269 => 2023-04-19 12:38:52.535690
[0m12:38:52.536775 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:38:52.673045 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  'NoneType' object is not iterable
  
  > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
  > called by model conso_client (models\dwh\conso_client.sql)
[0m12:38:52.674288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c01b8823-fc76-4ae9-a77a-4e783d805420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51CD83A0>]}
[0m12:38:52.675046 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.95s]
[0m12:38:52.680049 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:38:52.684046 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:52.686232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:52.687071 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:38:52.688186 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:38:52.689046 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:38:52.690048 [info ] [MainThread]: 
[0m12:38:52.693049 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m12:38:52.695048 [debug] [MainThread]: Command end result
[0m12:38:52.716047 [info ] [MainThread]: 
[0m12:38:52.718049 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:38:52.720046 [info ] [MainThread]: 
[0m12:38:52.722049 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:38:52.725049 [error] [MainThread]:   'NoneType' object is not iterable
[0m12:38:52.727048 [error] [MainThread]:   
[0m12:38:52.729047 [error] [MainThread]:   > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
[0m12:38:52.730096 [error] [MainThread]:   > called by model conso_client (models\dwh\conso_client.sql)
[0m12:38:52.732466 [info ] [MainThread]: 
[0m12:38:52.734047 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:38:52.735135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51992A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51984CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF51A01100>]}
[0m12:38:52.736048 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 12:40:07.585529 | 9b3b78dd-e6cd-4f8c-8424-553fdb096024 ==============================
[0m12:40:07.585529 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:40:07.589767 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m12:40:07.590529 [debug] [MainThread]: Tracking: tracking
[0m12:40:07.591496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137218B2BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137218B2EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137218B2E20>]}
[0m12:40:07.913293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:07.914282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:07.925289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b3b78dd-e6cd-4f8c-8424-553fdb096024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137219E4F40>]}
[0m12:40:07.942311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b3b78dd-e6cd-4f8c-8424-553fdb096024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137219B2220>]}
[0m12:40:07.943285 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:40:07.945288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3b78dd-e6cd-4f8c-8424-553fdb096024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137219B2460>]}
[0m12:40:07.947289 [info ] [MainThread]: 
[0m12:40:07.952285 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:07.955292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:40:07.985555 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:40:07.986555 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:40:07.987555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:09.454109 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:40:09.460462 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:40:09.596367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:40:09.636366 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:40:09.638376 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:40:09.640370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:10.084673 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0 seconds
[0m12:40:10.091489 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:40:10.388176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3b78dd-e6cd-4f8c-8424-553fdb096024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137219B2040>]}
[0m12:40:10.393177 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:40:10.397637 [info ] [MainThread]: 
[0m12:40:10.431180 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:40:10.435184 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:40:10.441307 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:40:10.444252 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:40:10.499253 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:40:10.505913 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 12:40:10.446177 => 2023-04-19 12:40:10.505247
[0m12:40:10.508246 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:40:10.650428 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:40:10.651429 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:40:10.652967 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:40:11.223517 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m12:40:11.242651 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:40:11.243860 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m12:40:11.350712 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbb38-3201-ba10-0001-2d1600366d6a
[0m12:40:11.357157 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'PERSO.ARO_DWH.V_CONSO_CLIENT' does not exist or not authorized.
[0m12:40:11.360189 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m12:40:11.363156 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m12:40:11.367171 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m12:40:11.379154 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:40:11.381154 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m12:40:11.735008 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:40:11.738009 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:40:11.741007 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE VIEW IF NOT EXISTS PERSO.ARO_DWH.V_conso_client
    AS (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_PERSO.ARO_DWH.conso_client
);
[0m12:40:12.898617 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbb38-3201-ba10-0001-2d1600366d6e
[0m12:40:12.899610 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:40:12.902613 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 12:40:10.510248 => 2023-04-19 12:40:12.902613
[0m12:40:12.904612 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:40:13.039443 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m12:40:13.041497 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3b78dd-e6cd-4f8c-8424-553fdb096024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013721D809A0>]}
[0m12:40:13.042733 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 2.60s]
[0m12:40:13.049400 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:40:13.053397 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:13.055509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:13.056398 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:40:13.058398 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:40:13.059398 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:40:13.060572 [info ] [MainThread]: 
[0m12:40:13.062399 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m12:40:13.066520 [debug] [MainThread]: Command end result
[0m12:40:13.096400 [info ] [MainThread]: 
[0m12:40:13.098440 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:40:13.102401 [info ] [MainThread]: 
[0m12:40:13.105400 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:40:13.108641 [error] [MainThread]:   002043 (02000): SQL compilation error:
[0m12:40:13.111401 [error] [MainThread]:   Object does not exist, or operation cannot be performed.
[0m12:40:13.114400 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m12:40:13.117399 [info ] [MainThread]: 
[0m12:40:13.119398 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:40:13.122398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137218D2A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137219D3C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137219A8F40>]}
[0m12:40:13.123841 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 12:42:08.188110 | a6522039-34f1-427b-9e0b-5ef04b66e29a ==============================
[0m12:42:08.188110 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:42:08.194105 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m12:42:08.195101 [debug] [MainThread]: Tracking: tracking
[0m12:42:08.196061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E5B6C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E5B6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E5B6EB0>]}
[0m12:42:08.471350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:08.473345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:08.483344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6522039-34f1-427b-9e0b-5ef04b66e29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E6E50D0>]}
[0m12:42:08.506344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6522039-34f1-427b-9e0b-5ef04b66e29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E6B1280>]}
[0m12:42:08.507609 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:42:08.510348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6522039-34f1-427b-9e0b-5ef04b66e29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E6B14C0>]}
[0m12:42:08.513347 [info ] [MainThread]: 
[0m12:42:08.519347 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:08.522344 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:42:08.548349 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:42:08.550344 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:42:08.551345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:09.542134 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:42:09.546136 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:42:09.659131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:42:09.680192 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:42:09.682173 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:42:09.683141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:10.224341 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m12:42:10.227344 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:42:10.331217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6522039-34f1-427b-9e0b-5ef04b66e29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E6B1160>]}
[0m12:42:10.333226 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:42:10.336218 [info ] [MainThread]: 
[0m12:42:10.353565 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:42:10.355558 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:42:10.359554 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:42:10.360555 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:42:10.374565 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:42:10.376681 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 12:42:10.361554 => 2023-04-19 12:42:10.376681
[0m12:42:10.377567 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:42:10.429764 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:42:10.431560 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:42:10.432564 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:42:11.159882 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m12:42:11.224697 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:42:11.226625 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m12:42:11.351752 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbb3a-3201-ba28-0001-2d1600361fda
[0m12:42:11.353753 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'PERSO.ARO_DWH.V_CONSO_CLIENT' does not exist or not authorized.
[0m12:42:11.356554 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m12:42:11.357763 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m12:42:11.360758 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m12:42:11.370786 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:42:11.372763 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m12:42:11.549450 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:42:11.550848 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:42:11.552503 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE VIEW IF NOT EXISTS PERSO.ARO_DWH.V_conso_client
    AS (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m12:42:11.952023 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:42:11.954014 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:42:11.956021 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m12:42:13.077757 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m12:42:13.078758 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:42:13.079768 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING ( SELECT * FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY ID  ORDER BY  CREATE_TIMESTAMP DESC ) 
    RK1 FROM PERSO.ARO_DWH.V_conso_client ) TAB WHERE RK1 = 1) SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    )
    VALUES
    (
    )
    ;
[0m12:42:13.153739 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbb3a-3201-bb68-0001-2d160036f48a
[0m12:42:13.154742 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 9 unexpected 'NOT'.
syntax error line 11 at position 21 unexpected 'THEN'.
[0m12:42:13.156735 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 12:42:10.377932 => 2023-04-19 12:42:13.156735
[0m12:42:13.157711 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:42:13.259706 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 9 unexpected 'NOT'.
  syntax error line 11 at position 21 unexpected 'THEN'.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m12:42:13.260802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6522039-34f1-427b-9e0b-5ef04b66e29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67EA8B6D0>]}
[0m12:42:13.263129 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 2.90s]
[0m12:42:13.268700 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:42:13.273341 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:13.275248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:13.276281 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:42:13.277246 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:42:13.278253 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:42:13.278464 [info ] [MainThread]: 
[0m12:42:13.280381 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m12:42:13.282244 [debug] [MainThread]: Command end result
[0m12:42:13.302354 [info ] [MainThread]: 
[0m12:42:13.304245 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:42:13.306245 [info ] [MainThread]: 
[0m12:42:13.308248 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:42:13.310246 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:42:13.312244 [error] [MainThread]:   syntax error line 11 at position 9 unexpected 'NOT'.
[0m12:42:13.313273 [error] [MainThread]:   syntax error line 11 at position 21 unexpected 'THEN'.
[0m12:42:13.315246 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m12:42:13.317245 [info ] [MainThread]: 
[0m12:42:13.319245 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:42:13.322247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E5D2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E6D2C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C67E6A8F40>]}
[0m12:42:13.323251 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 12:56:35.750619 | 2e9119e4-5ae5-4f95-bbe0-1df991375ed5 ==============================
[0m12:56:35.750619 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:56:35.753588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m12:56:35.754588 [debug] [MainThread]: Tracking: tracking
[0m12:56:35.754588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076566C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076566F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076566E80>]}
[0m12:56:35.997217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:35.998217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:36.008538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e9119e4-5ae5-4f95-bbe0-1df991375ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076693FD0>]}
[0m12:56:36.027663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e9119e4-5ae5-4f95-bbe0-1df991375ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076603250>]}
[0m12:56:36.029657 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:56:36.030667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e9119e4-5ae5-4f95-bbe0-1df991375ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076603490>]}
[0m12:56:36.032666 [info ] [MainThread]: 
[0m12:56:36.036662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:36.040656 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:56:36.074660 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:56:36.075660 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:56:36.077660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:36.857013 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:56:36.859816 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:56:36.963853 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:56:36.985819 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:56:37.010334 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:56:37.012336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:37.512786 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:56:37.516265 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:56:37.962229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e9119e4-5ae5-4f95-bbe0-1df991375ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076603130>]}
[0m12:56:37.964227 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:56:37.966228 [info ] [MainThread]: 
[0m12:56:37.978273 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:56:37.979367 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:56:37.982230 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:56:37.983397 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:56:38.000235 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:56:38.002233 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 12:56:37.984228 => 2023-04-19 12:56:38.002233
[0m12:56:38.003432 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:56:38.057802 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:56:38.057802 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:56:38.058800 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:56:40.241840 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m12:56:40.249848 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 12:56:38.003432 => 2023-04-19 12:56:40.248849
[0m12:56:40.251844 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:56:40.714203 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  can only concatenate str (not "decimal.Decimal") to str
  
  > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
  > called by model conso_client (models\dwh\conso_client.sql)
[0m12:56:40.718186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e9119e4-5ae5-4f95-bbe0-1df991375ed5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076AC2700>]}
[0m12:56:40.722497 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 2.74s]
[0m12:56:40.738975 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:56:40.750227 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:40.756227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:40.760231 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:56:40.763226 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:56:40.765225 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:56:40.768226 [info ] [MainThread]: 
[0m12:56:40.774305 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m12:56:40.779227 [debug] [MainThread]: Command end result
[0m12:56:40.834230 [info ] [MainThread]: 
[0m12:56:40.839199 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:56:40.844194 [info ] [MainThread]: 
[0m12:56:40.848498 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:56:40.854618 [error] [MainThread]:   can only concatenate str (not "decimal.Decimal") to str
[0m12:56:40.859196 [error] [MainThread]:   
[0m12:56:40.864200 [error] [MainThread]:   > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
[0m12:56:40.869196 [error] [MainThread]:   > called by model conso_client (models\dwh\conso_client.sql)
[0m12:56:40.873198 [info ] [MainThread]: 
[0m12:56:40.877195 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:56:40.881195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076582A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076603130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019076A7BC40>]}
[0m12:56:40.885195 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 12:59:13.739666 | c7251031-4689-4b79-b2a9-92f85ac926b2 ==============================
[0m12:59:13.739666 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:59:13.742710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m12:59:13.743749 [debug] [MainThread]: Tracking: tracking
[0m12:59:13.744983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997775C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997775F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997775EB0>]}
[0m12:59:13.977029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:13.978027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:13.990081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7251031-4689-4b79-b2a9-92f85ac926b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279978A40D0>]}
[0m12:59:14.011001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7251031-4689-4b79-b2a9-92f85ac926b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997871280>]}
[0m12:59:14.011998 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:59:14.014998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7251031-4689-4b79-b2a9-92f85ac926b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279978714C0>]}
[0m12:59:14.016998 [info ] [MainThread]: 
[0m12:59:14.021038 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:14.022998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:59:14.050995 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:59:14.052343 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:59:14.052996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:14.937704 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:59:14.947703 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:59:15.169770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:59:15.203766 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:59:15.206765 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:59:15.208774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:15.780419 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:59:15.784421 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:59:15.896416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7251031-4689-4b79-b2a9-92f85ac926b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997871160>]}
[0m12:59:15.897417 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:59:15.899418 [info ] [MainThread]: 
[0m12:59:15.910419 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:59:15.911420 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:59:15.914781 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:59:15.915416 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:59:15.931419 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:59:15.934417 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 12:59:15.916457 => 2023-04-19 12:59:15.934417
[0m12:59:15.936418 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:59:16.003437 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:59:16.004418 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:59:16.005418 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:59:17.803994 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m12:59:17.812507 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 12:59:15.937418 => 2023-04-19 12:59:17.812507
[0m12:59:17.814624 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:59:18.222285 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  can only concatenate str (not "decimal.Decimal") to str
  
  > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
  > called by model conso_client (models\dwh\conso_client.sql)
[0m12:59:18.223313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7251031-4689-4b79-b2a9-92f85ac926b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997CD26D0>]}
[0m12:59:18.224882 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 2.31s]
[0m12:59:18.228913 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:59:18.232549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:18.233557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:18.234557 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:59:18.235552 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:59:18.235552 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:59:18.236686 [info ] [MainThread]: 
[0m12:59:18.238550 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m12:59:18.239599 [debug] [MainThread]: Command end result
[0m12:59:18.255653 [info ] [MainThread]: 
[0m12:59:18.257549 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:59:18.259917 [info ] [MainThread]: 
[0m12:59:18.262584 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:59:18.265554 [error] [MainThread]:   can only concatenate str (not "decimal.Decimal") to str
[0m12:59:18.266554 [error] [MainThread]:   
[0m12:59:18.268580 [error] [MainThread]:   > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
[0m12:59:18.269547 [error] [MainThread]:   > called by model conso_client (models\dwh\conso_client.sql)
[0m12:59:18.271550 [info ] [MainThread]: 
[0m12:59:18.273547 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:59:18.275551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997792CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997871160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997C8BC10>]}
[0m12:59:18.277549 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 12:59:39.414414 | 05132ec4-6a27-4b97-a09d-4d8382d36810 ==============================
[0m12:59:39.414414 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:59:39.421414 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m12:59:39.422477 [debug] [MainThread]: Tracking: tracking
[0m12:59:39.424414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322C986C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322C986F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322C986EE0>]}
[0m12:59:39.641721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:39.670640 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:39.681630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05132ec4-6a27-4b97-a09d-4d8382d36810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322CAB30D0>]}
[0m12:59:39.698637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05132ec4-6a27-4b97-a09d-4d8382d36810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322CA302B0>]}
[0m12:59:39.699638 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:59:39.701638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05132ec4-6a27-4b97-a09d-4d8382d36810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322CA304F0>]}
[0m12:59:39.703638 [info ] [MainThread]: 
[0m12:59:39.707631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:39.710665 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:59:39.743260 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:59:39.744258 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:59:39.745253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:40.531682 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:59:40.540674 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:59:40.689028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:59:40.720101 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:59:40.723030 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:59:40.725048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:41.302057 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:59:41.305056 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:59:41.414193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05132ec4-6a27-4b97-a09d-4d8382d36810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322CA30190>]}
[0m12:59:41.416412 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:59:41.418429 [info ] [MainThread]: 
[0m12:59:41.431422 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:59:41.434431 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:59:41.437423 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:59:41.438422 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:59:41.456465 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:59:41.459424 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 12:59:41.439421 => 2023-04-19 12:59:41.459424
[0m12:59:41.460421 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:59:41.549608 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:59:41.550423 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:59:41.550423 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:59:42.106792 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m12:59:42.114789 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 12:59:41.461428 => 2023-04-19 12:59:42.114789
[0m12:59:42.116888 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:59:42.260192 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  'str' is undefined
  
  > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
  > called by model conso_client (models\dwh\conso_client.sql)
[0m12:59:42.263194 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05132ec4-6a27-4b97-a09d-4d8382d36810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322CEE26D0>]}
[0m12:59:42.266194 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.83s]
[0m12:59:42.279190 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:59:42.292194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:42.296613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:42.299601 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:59:42.302600 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:59:42.303602 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:59:42.306308 [info ] [MainThread]: 
[0m12:59:42.309661 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m12:59:42.314606 [debug] [MainThread]: Command end result
[0m12:59:42.361603 [info ] [MainThread]: 
[0m12:59:42.365793 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:59:42.370529 [info ] [MainThread]: 
[0m12:59:42.374950 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:59:42.379647 [error] [MainThread]:   'str' is undefined
[0m12:59:42.382486 [error] [MainThread]:   
[0m12:59:42.385892 [error] [MainThread]:   > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
[0m12:59:42.390930 [error] [MainThread]:   > called by model conso_client (models\dwh\conso_client.sql)
[0m12:59:42.393918 [info ] [MainThread]: 
[0m12:59:42.397917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:59:42.402922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322C9949A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322CA30190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322CE9AC10>]}
[0m12:59:42.405913 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 13:00:16.321714 | dfd91b98-1e7e-4747-a03d-5569959dac5f ==============================
[0m13:00:16.321714 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:00:16.325045 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m13:00:16.325045 [debug] [MainThread]: Tracking: tracking
[0m13:00:16.326043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B767D5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B767D5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B767D5EB0>]}
[0m13:00:16.544655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:16.545654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:16.568881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfd91b98-1e7e-4747-a03d-5569959dac5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B769040D0>]}
[0m13:00:16.588673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfd91b98-1e7e-4747-a03d-5569959dac5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B768D1280>]}
[0m13:00:16.589653 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:00:16.591656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfd91b98-1e7e-4747-a03d-5569959dac5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B768D14C0>]}
[0m13:00:16.595657 [info ] [MainThread]: 
[0m13:00:16.601652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:16.605654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m13:00:16.641653 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m13:00:16.641653 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m13:00:16.642654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:17.375710 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:00:17.378747 [debug] [ThreadPool]: On list_PERSO: Close
[0m13:00:19.381595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m13:00:19.407589 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m13:00:19.408589 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m13:00:19.409554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:21.764683 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2 seconds
[0m13:00:21.767686 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m13:00:23.462820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfd91b98-1e7e-4747-a03d-5569959dac5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B768D1160>]}
[0m13:00:23.467789 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m13:00:23.473774 [info ] [MainThread]: 
[0m13:00:23.505904 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m13:00:23.508777 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m13:00:23.515827 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m13:00:23.519776 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m13:00:23.557778 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m13:00:23.566044 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 13:00:23.520775 => 2023-04-19 13:00:23.564774
[0m13:00:23.568831 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m13:00:23.725814 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 13:00:23.571438 => 2023-04-19 13:00:23.725814
[0m13:00:23.737921 [debug] [Thread-1  ]: Compilation Error in macro merge_stream_sql (macros\materializations\incremental_stream.sql)
  No filter named 'str'.
    line 39
      {{ print("  => Merge of new records (" + v_count | str + ") into the target table", info=True) }}
  
  > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
  > called by macro merge_stream_sql (macros\materializations\incremental_stream.sql)
[0m13:00:23.738818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfd91b98-1e7e-4747-a03d-5569959dac5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B76C6AAC0>]}
[0m13:00:23.739947 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.23s]
[0m13:00:23.742846 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m13:00:23.746814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:23.747814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:23.748849 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m13:00:23.748849 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m13:00:23.749872 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m13:00:23.751167 [info ] [MainThread]: 
[0m13:00:23.751815 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m13:00:23.753814 [debug] [MainThread]: Command end result
[0m13:00:23.770095 [info ] [MainThread]: 
[0m13:00:23.771816 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:00:23.772815 [info ] [MainThread]: 
[0m13:00:23.775820 [error] [MainThread]: [33mCompilation Error in macro merge_stream_sql (macros\materializations\incremental_stream.sql)[0m
[0m13:00:23.777996 [error] [MainThread]:   No filter named 'str'.
[0m13:00:23.779815 [error] [MainThread]:     line 39
[0m13:00:23.781817 [error] [MainThread]:       {{ print("  => Merge of new records (" + v_count | str + ") into the target table", info=True) }}
[0m13:00:23.782813 [error] [MainThread]:   
[0m13:00:23.783820 [error] [MainThread]:   > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
[0m13:00:23.784816 [error] [MainThread]:   > called by macro merge_stream_sql (macros\materializations\incremental_stream.sql)
[0m13:00:23.786814 [info ] [MainThread]: 
[0m13:00:23.787814 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:00:23.788865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B767E4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B768D1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B767F2CD0>]}
[0m13:00:23.789813 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 13:01:28.214920 | 5b1134ff-da5c-4622-b9f6-23fbe3defe8d ==============================
[0m13:01:28.214920 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:28.217914 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m13:01:28.218919 [debug] [MainThread]: Tracking: tracking
[0m13:01:28.219915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0595E6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0595E6F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0595E6E80>]}
[0m13:01:28.405915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:28.407228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:28.416911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b1134ff-da5c-4622-b9f6-23fbe3defe8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D059713FD0>]}
[0m13:01:28.430215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b1134ff-da5c-4622-b9f6-23fbe3defe8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D059683250>]}
[0m13:01:28.430916 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:01:28.431942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b1134ff-da5c-4622-b9f6-23fbe3defe8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D059683490>]}
[0m13:01:28.433913 [info ] [MainThread]: 
[0m13:01:28.436945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:28.439945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m13:01:28.464948 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m13:01:28.465945 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m13:01:28.466946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:30.015670 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m13:01:30.022677 [debug] [ThreadPool]: On list_PERSO: Close
[0m13:01:31.555843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m13:01:31.569886 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m13:01:31.570842 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m13:01:31.571843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:32.554215 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m13:01:32.562212 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m13:01:33.580520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b1134ff-da5c-4622-b9f6-23fbe3defe8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D059683130>]}
[0m13:01:33.585512 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m13:01:33.590510 [info ] [MainThread]: 
[0m13:01:33.622510 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m13:01:33.625738 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m13:01:33.632510 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m13:01:33.634510 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m13:01:33.666564 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m13:01:33.671789 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 13:01:33.636510 => 2023-04-19 13:01:33.671789
[0m13:01:33.674510 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m13:01:33.832920 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:01:33.834072 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m13:01:33.834921 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:01:35.233157 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:01:35.271692 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 13:01:33.676524 => 2023-04-19 13:01:35.271692
[0m13:01:35.272492 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m13:01:35.765421 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  print() got an unexpected keyword argument 'info'
  
  > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
  > called by model conso_client (models\dwh\conso_client.sql)
[0m13:01:35.767169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b1134ff-da5c-4622-b9f6-23fbe3defe8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D059B426A0>]}
[0m13:01:35.770183 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 2.14s]
[0m13:01:35.784167 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m13:01:35.797170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:35.802167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:35.804184 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m13:01:35.806319 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m13:01:35.809186 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m13:01:35.811182 [info ] [MainThread]: 
[0m13:01:35.815613 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m13:01:35.821011 [debug] [MainThread]: Command end result
[0m13:01:35.870588 [info ] [MainThread]: 
[0m13:01:35.874578 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:01:35.878683 [info ] [MainThread]: 
[0m13:01:35.883578 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m13:01:35.887683 [error] [MainThread]:   print() got an unexpected keyword argument 'info'
[0m13:01:35.890591 [error] [MainThread]:   
[0m13:01:35.893578 [error] [MainThread]:   > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
[0m13:01:35.898575 [error] [MainThread]:   > called by model conso_client (models\dwh\conso_client.sql)
[0m13:01:35.903584 [info ] [MainThread]: 
[0m13:01:35.907576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:01:35.912578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D059602C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D059683130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D059AFBC40>]}
[0m13:01:35.915575 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 13:01:56.743762 | 01e1859a-b168-4051-9233-a422c12a6bda ==============================
[0m13:01:56.743762 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:56.747727 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m13:01:56.747727 [debug] [MainThread]: Tracking: tracking
[0m13:01:56.748730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20C27C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20C27F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20C27EB0>]}
[0m13:01:56.946104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:56.947104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:56.958144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01e1859a-b168-4051-9233-a422c12a6bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20D550D0>]}
[0m13:01:56.970109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01e1859a-b168-4051-9233-a422c12a6bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20D21280>]}
[0m13:01:56.972116 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:01:56.974139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01e1859a-b168-4051-9233-a422c12a6bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20D214C0>]}
[0m13:01:56.976139 [info ] [MainThread]: 
[0m13:01:56.980138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:56.982480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m13:01:57.014107 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m13:01:57.015105 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m13:01:57.016128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:57.964549 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:01:57.967510 [debug] [ThreadPool]: On list_PERSO: Close
[0m13:01:58.776540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m13:01:58.806589 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m13:01:58.809541 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m13:01:58.811538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:00.813500 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2 seconds
[0m13:02:00.821453 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m13:02:00.959770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01e1859a-b168-4051-9233-a422c12a6bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20D21160>]}
[0m13:02:00.962666 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m13:02:00.966810 [info ] [MainThread]: 
[0m13:02:00.997753 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m13:02:01.000470 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m13:02:01.006832 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m13:02:01.009842 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m13:02:01.042053 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m13:02:01.047045 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 13:02:01.011830 => 2023-04-19 13:02:01.047045
[0m13:02:01.050055 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m13:02:01.139012 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:02:01.140012 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m13:02:01.140305 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:02:01.790650 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:02:01.796898 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m13:02:01.799904 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m13:02:01.803895 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:02:01.803895 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m13:02:01.888895 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:02:01.889894 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:02:01.890894 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE VIEW IF NOT EXISTS PERSO.ARO_DWH.V_conso_client
    AS (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m13:02:01.979094 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:02:01.981099 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:02:01.983109 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m13:02:03.408805 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:02:03.410807 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:02:03.412737 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m13:02:03.498654 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:02:03.504657 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 13:02:01.052996 => 2023-04-19 13:02:03.504657
[0m13:02:03.506675 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m13:02:03.622117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e1859a-b168-4051-9233-a422c12a6bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E210CE700>]}
[0m13:02:03.625663 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.62s]
[0m13:02:03.639053 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m13:02:03.647063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:02:03.652067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:03.654066 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m13:02:03.656066 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m13:02:03.657064 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m13:02:03.659066 [info ] [MainThread]: 
[0m13:02:03.664147 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m13:02:03.669051 [debug] [MainThread]: Command end result
[0m13:02:03.712049 [info ] [MainThread]: 
[0m13:02:03.716060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:03.721067 [info ] [MainThread]: 
[0m13:02:03.724064 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:02:03.730176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20C42CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E20D21160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2113AC10>]}
[0m13:02:03.732061 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 13:03:17.570258 | 47d39975-4494-4b2d-9f8f-d7351fb00600 ==============================
[0m13:03:17.570258 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:03:17.573149 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m13:03:17.574150 [debug] [MainThread]: Tracking: tracking
[0m13:03:17.574150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8AD7C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8AD7F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8AD7EB0>]}
[0m13:03:17.829702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:17.830367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:17.841365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47d39975-4494-4b2d-9f8f-d7351fb00600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8C030D0>]}
[0m13:03:17.858360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47d39975-4494-4b2d-9f8f-d7351fb00600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8B73280>]}
[0m13:03:17.859518 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:03:17.861364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47d39975-4494-4b2d-9f8f-d7351fb00600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8B734C0>]}
[0m13:03:17.864367 [info ] [MainThread]: 
[0m13:03:17.868361 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:17.871367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m13:03:17.898362 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m13:03:17.899367 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m13:03:17.900365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:19.397433 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:03:19.404429 [debug] [ThreadPool]: On list_PERSO: Close
[0m13:03:19.991053 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m13:03:20.020061 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m13:03:20.021996 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m13:03:20.023072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:20.590997 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m13:03:20.600008 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m13:03:20.742196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47d39975-4494-4b2d-9f8f-d7351fb00600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8B73160>]}
[0m13:03:20.748182 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m13:03:20.753136 [info ] [MainThread]: 
[0m13:03:20.783187 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m13:03:20.786132 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m13:03:20.794137 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m13:03:20.796137 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m13:03:20.828196 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m13:03:20.833135 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 13:03:20.798198 => 2023-04-19 13:03:20.833135
[0m13:03:20.835133 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m13:03:20.980456 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:03:20.981466 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m13:03:20.983591 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:03:22.132115 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:03:22.138112 [info ] [Thread-1  ]:   => Merge of new records (0) into the target table
[0m13:03:22.142052 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m13:03:22.148051 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m13:03:22.154996 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:03:22.157051 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m13:03:22.262042 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:03:22.264043 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:03:22.265991 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE VIEW IF NOT EXISTS PERSO.ARO_DWH.V_conso_client
    AS (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m13:03:25.305991 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:03:25.306991 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:03:25.307991 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m13:03:25.386656 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:03:25.389653 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:03:25.391653 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m13:03:25.462970 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:03:25.468707 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 13:03:20.836193 => 2023-04-19 13:03:25.468707
[0m13:03:25.470225 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m13:03:25.583520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47d39975-4494-4b2d-9f8f-d7351fb00600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8FFC580>]}
[0m13:03:25.585198 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 4.79s]
[0m13:03:25.590209 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m13:03:25.593206 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:25.595207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:25.595207 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m13:03:25.596209 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m13:03:25.596209 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m13:03:25.597208 [info ] [MainThread]: 
[0m13:03:25.598206 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m13:03:25.601210 [debug] [MainThread]: Command end result
[0m13:03:25.623211 [info ] [MainThread]: 
[0m13:03:25.624211 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:25.627214 [info ] [MainThread]: 
[0m13:03:25.628373 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:03:25.630208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8AF2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8B73160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB8FEBC10>]}
[0m13:03:25.631208 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 13:04:36.979632 | 7fd4ca8a-7afd-4296-b15f-643e525b3d41 ==============================
[0m13:04:36.979632 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:04:36.983636 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m13:04:36.984633 [debug] [MainThread]: Tracking: tracking
[0m13:04:36.985633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E29286C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E29286F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E29286EB0>]}
[0m13:04:37.231518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:37.232516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:37.254525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fd4ca8a-7afd-4296-b15f-643e525b3d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E293B40D0>]}
[0m13:04:37.270516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fd4ca8a-7afd-4296-b15f-643e525b3d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E29381280>]}
[0m13:04:37.271707 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:04:37.273516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd4ca8a-7afd-4296-b15f-643e525b3d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E293814C0>]}
[0m13:04:37.275518 [info ] [MainThread]: 
[0m13:04:37.280626 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:04:37.283514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m13:04:37.314813 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m13:04:37.315513 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m13:04:37.316515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:38.708286 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:04:38.720290 [debug] [ThreadPool]: On list_PERSO: Close
[0m13:04:38.857779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m13:04:38.877776 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m13:04:38.878775 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m13:04:38.879775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:39.419025 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m13:04:39.428162 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m13:04:39.571419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd4ca8a-7afd-4296-b15f-643e525b3d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E29381160>]}
[0m13:04:39.576440 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m13:04:39.580430 [info ] [MainThread]: 
[0m13:04:39.611434 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m13:04:39.614437 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m13:04:39.620710 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m13:04:39.624428 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m13:04:39.664419 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m13:04:39.670417 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 13:04:39.625419 => 2023-04-19 13:04:39.670417
[0m13:04:39.673426 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m13:04:39.828940 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:04:39.830265 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m13:04:39.830934 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:04:40.399063 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:04:40.405075 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m13:04:40.409071 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m13:04:40.413077 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m13:04:40.423065 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:04:40.425062 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m13:04:40.563736 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:04:40.564712 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:04:40.565709 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE VIEW IF NOT EXISTS PERSO.ARO_DWH.V_conso_client
    AS (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m13:04:40.869777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:04:40.870776 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:04:40.871775 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m13:04:40.965776 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:04:40.966776 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:04:40.967261 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m13:04:41.022773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:04:41.024780 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 13:04:39.675524 => 2023-04-19 13:04:41.024780
[0m13:04:41.025777 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m13:04:41.129441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fd4ca8a-7afd-4296-b15f-643e525b3d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E297ACAF0>]}
[0m13:04:41.131437 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.51s]
[0m13:04:41.136436 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m13:04:41.139435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:04:41.141440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:41.141440 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m13:04:41.143442 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m13:04:41.144474 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m13:04:41.144474 [info ] [MainThread]: 
[0m13:04:41.146465 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m13:04:41.148438 [debug] [MainThread]: Command end result
[0m13:04:41.166437 [info ] [MainThread]: 
[0m13:04:41.168439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:41.171439 [info ] [MainThread]: 
[0m13:04:41.173435 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:04:41.175436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E292A2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E29381160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E2979BC10>]}
[0m13:04:41.176690 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 13:06:37.210974 | 6709399f-6d07-4610-b312-10ea3fe4c6e1 ==============================
[0m13:06:37.210974 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:06:37.216976 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m13:06:37.217979 [debug] [MainThread]: Tracking: tracking
[0m13:06:37.220978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4EC75BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4EC75F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4EC75E50>]}
[0m13:06:37.455685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:06:37.456714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:06:37.466713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6709399f-6d07-4610-b312-10ea3fe4c6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4EDA3FA0>]}
[0m13:06:37.480817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6709399f-6d07-4610-b312-10ea3fe4c6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4ED01250>]}
[0m13:06:37.481828 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:06:37.482706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6709399f-6d07-4610-b312-10ea3fe4c6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4ED01490>]}
[0m13:06:37.484715 [info ] [MainThread]: 
[0m13:06:37.488682 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:06:37.490715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m13:06:37.514720 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m13:06:37.515892 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m13:06:37.516688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:38.546039 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:06:38.553990 [debug] [ThreadPool]: On list_PERSO: Close
[0m13:06:38.689333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m13:06:38.720109 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m13:06:38.722095 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m13:06:38.724164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:39.351936 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m13:06:39.355340 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m13:06:39.475992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6709399f-6d07-4610-b312-10ea3fe4c6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4ED01040>]}
[0m13:06:39.479955 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m13:06:39.483532 [info ] [MainThread]: 
[0m13:06:39.516976 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m13:06:39.521013 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m13:06:39.526986 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m13:06:39.528989 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m13:06:39.567982 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m13:06:39.572980 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 13:06:39.529984 => 2023-04-19 13:06:39.572980
[0m13:06:39.576026 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m13:06:39.755974 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:06:39.758980 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m13:06:39.764975 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:06:41.509630 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:06:41.516622 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m13:06:41.572621 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:06:41.575674 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m13:06:41.682027 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0 seconds
[0m13:06:41.694030 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m13:06:41.713026 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:06:41.716087 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m13:06:41.912729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:06:41.914731 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:06:41.916949 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE VIEW IF NOT EXISTS PERSO.ARO_DWH.V_conso_client
    AS (

select
    *
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m13:06:42.024772 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:06:42.026769 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:06:42.028770 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m13:06:42.104837 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:06:42.107824 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m13:06:42.109834 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING ( SELECT * FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY ID  ORDER BY  CREATE_TIMESTAMP DESC ) 
    RK1 FROM PERSO.ARO_DWH.V_conso_client ) TAB WHERE RK1 = 1) SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE,
    TARGET.METADATA$ACTION = SOURCE.METADATA$ACTION,
    TARGET.METADATA$ISUPDATE = SOURCE.METADATA$ISUPDATE,
    TARGET.METADATA$ROW_ID = SOURCE.METADATA$ROW_ID
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE,
    METADATA$ACTION,
    METADATA$ISUPDATE,
    METADATA$ROW_ID
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE,
    SOURCE.METADATA$ACTION,
    SOURCE.METADATA$ISUPDATE,
    SOURCE.METADATA$ROW_ID
    )
    ;
[0m13:06:42.330773 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbb52-3201-bb68-0001-2d160036f4fa
[0m13:06:42.331771 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 83
invalid identifier 'CREATE_TIMESTAMP'
[0m13:06:42.332774 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 13:06:39.577028 => 2023-04-19 13:06:42.332774
[0m13:06:42.334769 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m13:06:42.778247 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  000904 (42000): SQL compilation error: error line 2 at position 83
  invalid identifier 'CREATE_TIMESTAMP'
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m13:06:42.781181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6709399f-6d07-4610-b312-10ea3fe4c6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4F123250>]}
[0m13:06:42.784183 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 3.26s]
[0m13:06:42.796195 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m13:06:42.804231 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:06:42.807231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:42.809687 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m13:06:42.814178 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m13:06:42.818084 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m13:06:42.820157 [info ] [MainThread]: 
[0m13:06:42.825523 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m13:06:42.830857 [debug] [MainThread]: Command end result
[0m13:06:42.892175 [info ] [MainThread]: 
[0m13:06:42.908174 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:06:42.914178 [info ] [MainThread]: 
[0m13:06:42.919179 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m13:06:42.924171 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 2 at position 83
[0m13:06:42.928177 [error] [MainThread]:   invalid identifier 'CREATE_TIMESTAMP'
[0m13:06:42.933180 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m13:06:42.942170 [info ] [MainThread]: 
[0m13:06:42.945233 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:06:42.948171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4ED928E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4EC83F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE4ED012B0>]}
[0m13:06:42.950175 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 14:52:52.598466 | 234066c2-c545-48b5-904a-a02a006ee8b9 ==============================
[0m14:52:52.598466 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:52:52.601465 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m14:52:52.602468 [debug] [MainThread]: Tracking: tracking
[0m14:52:52.602722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061427CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061427F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061427F10>]}
[0m14:52:52.816507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:52.817507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:52.826509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '234066c2-c545-48b5-904a-a02a006ee8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210615550D0>]}
[0m14:52:52.841516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '234066c2-c545-48b5-904a-a02a006ee8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210614CD2E0>]}
[0m14:52:52.844515 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:52:52.848517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '234066c2-c545-48b5-904a-a02a006ee8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210614CD520>]}
[0m14:52:52.851599 [info ] [MainThread]: 
[0m14:52:52.858514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:52.862517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m14:52:52.884520 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m14:52:52.885521 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m14:52:52.886522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:54.128533 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m14:52:54.131532 [debug] [ThreadPool]: On list_PERSO: Close
[0m14:52:54.237972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m14:52:54.246972 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m14:52:54.247972 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m14:52:54.248402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:54.695915 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m14:52:54.699904 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m14:52:54.796819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '234066c2-c545-48b5-904a-a02a006ee8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210614CD130>]}
[0m14:52:54.797821 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m14:52:54.798819 [info ] [MainThread]: 
[0m14:52:54.815953 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m14:52:54.816829 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m14:52:54.819867 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m14:52:54.820831 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m14:52:54.830827 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m14:52:54.834856 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 14:52:54.820922 => 2023-04-19 14:52:54.834856
[0m14:52:54.835828 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m14:52:54.880835 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:52:54.881866 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m14:52:54.882873 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:52:55.999739 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m14:52:56.007806 [info ] [Thread-1  ]:   => 60 record(s) to merge
[0m14:52:56.025170 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:52:56.025801 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m14:52:56.121822 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbbc-3201-bb68-0001-2d160036f5ea
[0m14:52:56.121822 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'PERSO.ARO_DWH.V_CONSO_CLIENT' does not exist or not authorized.
[0m14:52:56.123400 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m14:52:56.123872 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m14:52:56.125826 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m14:52:56.128823 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:52:56.128823 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m14:52:56.291303 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:52:56.291303 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:52:56.292301 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE VIEW IF NOT EXISTS PERSO.ARO_DWH.V_conso_client
    AS (

select FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m14:52:56.607076 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:52:56.607795 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:52:56.608795 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m14:52:56.678880 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:52:56.680876 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:52:56.682876 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING ( SELECT * FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY ID  ORDER BY  CREATE_TIMESTAMP DESC ) 
    RK1 FROM PERSO.ARO_DWH.V_conso_client ) TAB WHERE RK1 = 1) SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    )
    VALUES
    (
    )
    ;
[0m14:52:56.758594 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbbc-3201-ba10-0001-2d1600366ee6
[0m14:52:56.760595 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 9 unexpected 'NOT'.
syntax error line 11 at position 21 unexpected 'THEN'.
[0m14:52:56.762558 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 14:52:54.836828 => 2023-04-19 14:52:56.762558
[0m14:52:56.763624 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m14:52:56.889256 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 9 unexpected 'NOT'.
  syntax error line 11 at position 21 unexpected 'THEN'.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:52:56.891254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '234066c2-c545-48b5-904a-a02a006ee8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210618CFD90>]}
[0m14:52:56.892402 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 2.07s]
[0m14:52:56.895290 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m14:52:56.898255 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:56.899265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:56.899265 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m14:52:56.900442 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m14:52:56.900442 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m14:52:56.901255 [info ] [MainThread]: 
[0m14:52:56.902255 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m14:52:56.904256 [debug] [MainThread]: Command end result
[0m14:52:56.917473 [info ] [MainThread]: 
[0m14:52:56.918257 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:56.920268 [info ] [MainThread]: 
[0m14:52:56.922269 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m14:52:56.925261 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m14:52:56.926275 [error] [MainThread]:   syntax error line 11 at position 9 unexpected 'NOT'.
[0m14:52:56.927265 [error] [MainThread]:   syntax error line 11 at position 21 unexpected 'THEN'.
[0m14:52:56.929261 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:52:56.931318 [info ] [MainThread]: 
[0m14:52:56.933259 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:52:56.934263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061434130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210614CD130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061544AC0>]}
[0m14:52:56.935263 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 14:54:37.372320 | 3c9abca8-83cf-40e1-82dd-f5ab99efd5cf ==============================
[0m14:54:37.372320 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:54:37.374321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m14:54:37.375322 [debug] [MainThread]: Tracking: tracking
[0m14:54:37.375682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F58E8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F58E8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F58E8F10>]}
[0m14:54:37.535359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:37.535359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:37.546320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c9abca8-83cf-40e1-82dd-f5ab99efd5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F5A160D0>]}
[0m14:54:37.560322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c9abca8-83cf-40e1-82dd-f5ab99efd5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F59902E0>]}
[0m14:54:37.561321 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:54:37.562424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c9abca8-83cf-40e1-82dd-f5ab99efd5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F5990520>]}
[0m14:54:37.564358 [info ] [MainThread]: 
[0m14:54:37.566362 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:54:37.568322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m14:54:37.588330 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m14:54:37.589364 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m14:54:37.589364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:38.530983 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m14:54:38.534019 [debug] [ThreadPool]: On list_PERSO: Close
[0m14:54:38.635022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m14:54:38.645979 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m14:54:38.646980 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m14:54:38.647993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:38.902803 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m14:54:38.909745 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m14:54:39.003043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c9abca8-83cf-40e1-82dd-f5ab99efd5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F5990130>]}
[0m14:54:39.004088 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m14:54:39.006042 [info ] [MainThread]: 
[0m14:54:39.014045 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m14:54:39.015082 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m14:54:39.017030 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m14:54:39.017030 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m14:54:39.026065 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m14:54:39.028189 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 14:54:39.018078 => 2023-04-19 14:54:39.027059
[0m14:54:39.029030 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m14:54:39.067028 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:54:39.069030 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m14:54:39.075033 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:54:39.556772 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:54:39.559787 [info ] [Thread-1  ]:   => 60 record(s) to merge
[0m14:54:39.579767 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:54:39.580767 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m14:54:39.647332 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0 seconds
[0m14:54:39.652336 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m14:54:39.657517 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:54:39.658519 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m14:54:39.755005 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:54:39.756004 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:54:39.757003 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m14:54:39.984371 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:54:39.986071 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:54:39.989072 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m14:54:40.051843 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:54:40.052841 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:54:40.053842 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING ( SELECT * FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY ID  ORDER BY  CREATE_TIMESTAMP DESC ) 
    RK1 FROM PERSO.ARO_DWH.V_conso_client ) TAB WHERE RK1 = 1) SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m14:54:40.240893 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbbe-3201-ba10-0001-2d1600366eea
[0m14:54:40.240893 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 69
invalid identifier 'ID'
[0m14:54:40.242254 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 14:54:39.029030 => 2023-04-19 14:54:40.241894
[0m14:54:40.242254 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m14:54:40.438308 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  000904 (42000): SQL compilation error: error line 2 at position 69
  invalid identifier 'ID'
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:54:40.440299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9abca8-83cf-40e1-82dd-f5ab99efd5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F5D8FE20>]}
[0m14:54:40.442393 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.42s]
[0m14:54:40.448566 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m14:54:40.452535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:54:40.455531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:40.456528 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m14:54:40.457523 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m14:54:40.458522 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m14:54:40.458522 [info ] [MainThread]: 
[0m14:54:40.460634 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m14:54:40.461524 [debug] [MainThread]: Command end result
[0m14:54:40.474541 [info ] [MainThread]: 
[0m14:54:40.476547 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:54:40.477544 [info ] [MainThread]: 
[0m14:54:40.479543 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m14:54:40.480541 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 2 at position 69
[0m14:54:40.481544 [error] [MainThread]:   invalid identifier 'ID'
[0m14:54:40.483543 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:54:40.486548 [info ] [MainThread]: 
[0m14:54:40.487545 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:54:40.488574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F58F3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F5990310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189F5990070>]}
[0m14:54:40.489542 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 14:55:16.176659 | 3197fbef-2684-477f-9bce-1d207e8a181e ==============================
[0m14:55:16.176659 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:55:16.179001 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m14:55:16.179001 [debug] [MainThread]: Tracking: tracking
[0m14:55:16.180003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290064C6C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290064C6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290064C6EB0>]}
[0m14:55:16.361013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:16.364024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:16.377205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3197fbef-2684-477f-9bce-1d207e8a181e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290065F40D0>]}
[0m14:55:16.393003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3197fbef-2684-477f-9bce-1d207e8a181e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290065C1280>]}
[0m14:55:16.394015 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:55:16.394999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3197fbef-2684-477f-9bce-1d207e8a181e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290065C14C0>]}
[0m14:55:16.397000 [info ] [MainThread]: 
[0m14:55:16.401050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:16.406161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m14:55:16.438997 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m14:55:16.440000 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m14:55:16.440000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:17.124290 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m14:55:17.127291 [debug] [ThreadPool]: On list_PERSO: Close
[0m14:55:17.503911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m14:55:17.512902 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m14:55:17.513945 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m14:55:17.514904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:18.299418 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m14:55:18.303528 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m14:55:18.402899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3197fbef-2684-477f-9bce-1d207e8a181e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290065C1160>]}
[0m14:55:18.404923 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m14:55:18.405894 [info ] [MainThread]: 
[0m14:55:18.414932 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m14:55:18.416072 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m14:55:18.418892 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m14:55:18.419892 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m14:55:18.427892 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m14:55:18.429894 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 14:55:18.420237 => 2023-04-19 14:55:18.429894
[0m14:55:18.430236 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m14:55:18.467473 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:18.468465 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m14:55:18.469446 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:55:18.908771 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:55:18.911802 [info ] [Thread-1  ]:   => 60 record(s) to merge
[0m14:55:18.925775 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:18.926772 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m14:55:19.016454 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0 seconds
[0m14:55:19.019450 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m14:55:19.022484 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:19.022484 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m14:55:19.107472 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:55:19.107472 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:19.108809 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m14:55:19.395886 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:55:19.396893 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:19.396893 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m14:55:19.468897 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:55:19.470703 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:19.471714 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING ( SELECT * FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY ID  ORDER BY  CREATE_TIMESTAMP DESC ) 
    RK1 FROM PERSO.ARO_DWH.V_conso_client ) TAB WHERE RK1 = 1) SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m14:55:19.670927 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbbf-3201-bafa-0001-2d160036b812
[0m14:55:19.671692 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 69
invalid identifier 'ID'
[0m14:55:19.672692 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 14:55:18.430892 => 2023-04-19 14:55:19.671692
[0m14:55:19.672800 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m14:55:19.772297 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  000904 (42000): SQL compilation error: error line 2 at position 69
  invalid identifier 'ID'
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:55:19.773013 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3197fbef-2684-477f-9bce-1d207e8a181e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002900699DB20>]}
[0m14:55:19.774018 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.35s]
[0m14:55:19.776099 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m14:55:19.779015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:19.780016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:19.780016 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m14:55:19.781021 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m14:55:19.781021 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m14:55:19.782015 [info ] [MainThread]: 
[0m14:55:19.784017 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m14:55:19.785015 [debug] [MainThread]: Command end result
[0m14:55:19.797012 [info ] [MainThread]: 
[0m14:55:19.800016 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:55:19.803014 [info ] [MainThread]: 
[0m14:55:19.804173 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m14:55:19.806250 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 2 at position 69
[0m14:55:19.807015 [error] [MainThread]:   invalid identifier 'ID'
[0m14:55:19.808015 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:55:19.810015 [info ] [MainThread]: 
[0m14:55:19.811013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:55:19.812117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290064E2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290065B8F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290065E3FA0>]}
[0m14:55:19.812117 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 14:55:26.161691 | fb4a8d96-901c-4d51-8c67-51da78240ff8 ==============================
[0m14:55:26.161691 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:55:26.163687 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m14:55:26.164726 [debug] [MainThread]: Tracking: tracking
[0m14:55:26.164726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D111D6BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D111D6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D111D6E50>]}
[0m14:55:26.329641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:26.329641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:26.337641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb4a8d96-901c-4d51-8c67-51da78240ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D11306FA0>]}
[0m14:55:26.349675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb4a8d96-901c-4d51-8c67-51da78240ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D112D2250>]}
[0m14:55:26.350642 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:55:26.351645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb4a8d96-901c-4d51-8c67-51da78240ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D112D2490>]}
[0m14:55:26.352649 [info ] [MainThread]: 
[0m14:55:26.356792 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:26.360668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m14:55:26.380504 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m14:55:26.380504 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m14:55:26.381511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:27.203812 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m14:55:27.205810 [debug] [ThreadPool]: On list_PERSO: Close
[0m14:55:27.302783 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m14:55:27.315817 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m14:55:27.315817 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m14:55:27.316957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:27.827894 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m14:55:27.831893 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m14:55:27.937889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb4a8d96-901c-4d51-8c67-51da78240ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D112D2040>]}
[0m14:55:27.938889 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m14:55:27.939887 [info ] [MainThread]: 
[0m14:55:27.949890 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m14:55:27.950946 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m14:55:27.952891 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m14:55:27.953888 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m14:55:27.963889 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m14:55:27.965424 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 14:55:27.953888 => 2023-04-19 14:55:27.965424
[0m14:55:27.965887 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m14:55:28.008426 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:28.008890 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m14:55:28.009893 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:55:28.282808 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:55:28.288946 [info ] [Thread-1  ]:   => 60 record(s) to merge
[0m14:55:28.302839 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:28.304415 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m14:55:28.389219 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0 seconds
[0m14:55:28.392219 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m14:55:28.395219 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:28.395219 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m14:55:28.480229 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:55:28.481220 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:28.481220 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m14:55:28.707521 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:55:28.709531 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:28.710478 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m14:55:28.778088 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:55:28.778882 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:55:28.779853 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING ( SELECT * FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY ID  ORDER BY  CREATE_TIMESTAMP DESC ) 
    RK1 FROM PERSO.ARO_DWH.V_conso_client ) TAB WHERE RK1 = 1) SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m14:55:28.938672 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbbf-3201-bb68-0001-2d160036f61e
[0m14:55:28.939668 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 83
invalid identifier 'CREATE_TIMESTAMP'
[0m14:55:28.940747 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 14:55:27.965887 => 2023-04-19 14:55:28.939668
[0m14:55:28.940747 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m14:55:29.036096 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  000904 (42000): SQL compilation error: error line 2 at position 83
  invalid identifier 'CREATE_TIMESTAMP'
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:55:29.037057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb4a8d96-901c-4d51-8c67-51da78240ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D11684250>]}
[0m14:55:29.038063 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.09s]
[0m14:55:29.041089 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m14:55:29.044202 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:29.045058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:29.046058 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m14:55:29.046614 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m14:55:29.047057 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m14:55:29.048056 [info ] [MainThread]: 
[0m14:55:29.049058 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m14:55:29.051062 [debug] [MainThread]: Command end result
[0m14:55:29.063059 [info ] [MainThread]: 
[0m14:55:29.064097 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:55:29.065058 [info ] [MainThread]: 
[0m14:55:29.066056 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m14:55:29.068056 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 2 at position 83
[0m14:55:29.069062 [error] [MainThread]:   invalid identifier 'CREATE_TIMESTAMP'
[0m14:55:29.070061 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:55:29.072057 [info ] [MainThread]: 
[0m14:55:29.073058 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:55:29.075057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D111F2D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D112C9F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D112D2040>]}
[0m14:55:29.075057 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 14:56:39.653551 | bc0273d2-c2ca-460c-bd26-060c2b6eb9d8 ==============================
[0m14:56:39.653551 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:56:39.655514 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m14:56:39.656520 [debug] [MainThread]: Tracking: tracking
[0m14:56:39.656520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8DE5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8DE5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8DE5EB0>]}
[0m14:56:39.844644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:39.845520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:39.861516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc0273d2-c2ca-460c-bd26-060c2b6eb9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8F160D0>]}
[0m14:56:39.881515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc0273d2-c2ca-460c-bd26-060c2b6eb9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8EE2280>]}
[0m14:56:39.881515 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:56:39.883515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0273d2-c2ca-460c-bd26-060c2b6eb9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8EE24C0>]}
[0m14:56:39.885549 [info ] [MainThread]: 
[0m14:56:39.888555 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:56:39.890561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m14:56:39.909555 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m14:56:39.910517 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m14:56:39.911515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:40.561767 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m14:56:40.563768 [debug] [ThreadPool]: On list_PERSO: Close
[0m14:56:40.671770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m14:56:40.685765 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m14:56:40.686766 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m14:56:40.687766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:40.942529 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m14:56:40.945553 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m14:56:41.042947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0273d2-c2ca-460c-bd26-060c2b6eb9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8EE2160>]}
[0m14:56:41.043939 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m14:56:41.044907 [info ] [MainThread]: 
[0m14:56:41.054911 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m14:56:41.055908 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m14:56:41.057907 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m14:56:41.057907 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m14:56:41.065910 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m14:56:41.067914 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 14:56:41.058909 => 2023-04-19 14:56:41.067914
[0m14:56:41.068914 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m14:56:41.103943 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:56:41.104984 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m14:56:41.104984 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:56:41.622998 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m14:56:41.630044 [info ] [Thread-1  ]:   => 60 record(s) to merge
[0m14:56:41.639913 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:56:41.641158 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m14:56:41.713597 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m14:56:41.715596 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m14:56:41.718594 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:56:41.718594 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m14:56:41.802598 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:56:41.803770 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:56:41.804784 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m14:56:42.067541 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:56:42.068537 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:56:42.068537 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m14:56:42.129460 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m14:56:42.132459 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m14:56:42.133458 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING ( SELECT * FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY ID  ORDER BY  CREATE_TIMESTAMP DESC ) 
    RK1 FROM PERSO.ARO_DWH.V_conso_client ) TAB WHERE RK1 = 1) SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m14:56:42.301841 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbc0-3201-ba10-0001-2d1600366f3e
[0m14:56:42.302455 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 83
invalid identifier 'CREATE_TIMESTAMP'
[0m14:56:42.303454 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 14:56:41.068914 => 2023-04-19 14:56:42.302455
[0m14:56:42.303529 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m14:56:42.398193 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  000904 (42000): SQL compilation error: error line 2 at position 83
  invalid identifier 'CREATE_TIMESTAMP'
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:56:42.398193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0273d2-c2ca-460c-bd26-060c2b6eb9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B92BAC10>]}
[0m14:56:42.399474 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.34s]
[0m14:56:42.402191 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m14:56:42.404369 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:56:42.406193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:42.406740 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m14:56:42.407193 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m14:56:42.407193 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m14:56:42.408192 [info ] [MainThread]: 
[0m14:56:42.409190 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m14:56:42.410194 [debug] [MainThread]: Command end result
[0m14:56:42.422194 [info ] [MainThread]: 
[0m14:56:42.424237 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:42.426192 [info ] [MainThread]: 
[0m14:56:42.428193 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m14:56:42.429465 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 2 at position 83
[0m14:56:42.430192 [error] [MainThread]:   invalid identifier 'CREATE_TIMESTAMP'
[0m14:56:42.431192 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m14:56:42.432193 [info ] [MainThread]: 
[0m14:56:42.432193 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:56:42.435194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8E02CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8ED8F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B8F04FA0>]}
[0m14:56:42.436242 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:11:44.787855 | c48f187d-0aa9-4181-843f-1d4fa182ba99 ==============================
[0m15:11:44.787855 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:11:44.790876 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m15:11:44.792024 [debug] [MainThread]: Tracking: tracking
[0m15:11:44.792858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388557C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388557F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388557E80>]}
[0m15:11:45.001897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:45.002899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:45.013899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c48f187d-0aa9-4181-843f-1d4fa182ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388684FD0>]}
[0m15:11:45.029900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c48f187d-0aa9-4181-843f-1d4fa182ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3885E1250>]}
[0m15:11:45.030906 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:11:45.031901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c48f187d-0aa9-4181-843f-1d4fa182ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3885E1490>]}
[0m15:11:45.033897 [info ] [MainThread]: 
[0m15:11:45.036900 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:11:45.038902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:11:45.067897 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:11:45.068898 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:11:45.069634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:45.841217 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:11:45.843470 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:11:46.009289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:11:46.018287 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:11:46.019538 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:11:46.019538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:46.386286 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m15:11:46.389290 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:11:46.495285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c48f187d-0aa9-4181-843f-1d4fa182ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3885E1130>]}
[0m15:11:46.496285 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:11:46.498285 [info ] [MainThread]: 
[0m15:11:46.510287 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:11:46.511284 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:11:46.514286 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:11:46.514286 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:11:46.531290 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:11:46.533724 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:11:46.515285 => 2023-04-19 15:11:46.533724
[0m15:11:46.534372 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:11:46.581422 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:11:46.583288 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:11:46.583288 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:11:47.160500 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:11:47.163529 [info ] [Thread-1  ]:   => 60 record(s) to merge
[0m15:11:47.176500 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:11:47.176636 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m15:11:47.271639 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m15:11:47.274748 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:11:47.277501 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:11:47.279495 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:11:47.403607 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:11:47.404497 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:11:47.405123 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m15:11:47.607556 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:11:47.608265 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:11:47.608558 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:11:47.676595 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:11:47.677559 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:11:47.678557 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m15:11:47.794668 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbcf-3201-bafa-0001-2d160036b89a
[0m15:11:47.795638 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SOURCE' does not exist or not authorized.
[0m15:11:47.795638 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:11:46.535298 => 2023-04-19 15:11:47.795638
[0m15:11:47.796637 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:11:47.901734 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  002003 (42S02): SQL compilation error:
  Object 'SOURCE' does not exist or not authorized.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m15:11:47.902512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48f187d-0aa9-4181-843f-1d4fa182ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388A04250>]}
[0m15:11:47.902733 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.39s]
[0m15:11:47.905775 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:11:47.908734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:11:47.910731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:47.911731 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:11:47.912734 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:11:47.913731 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:11:47.913731 [info ] [MainThread]: 
[0m15:11:47.915732 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m15:11:47.916732 [debug] [MainThread]: Command end result
[0m15:11:47.933740 [info ] [MainThread]: 
[0m15:11:47.935339 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:11:47.937734 [info ] [MainThread]: 
[0m15:11:47.939733 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m15:11:47.941753 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m15:11:47.944732 [error] [MainThread]:   Object 'SOURCE' does not exist or not authorized.
[0m15:11:47.946732 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m15:11:47.947733 [info ] [MainThread]: 
[0m15:11:47.949732 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:11:47.950732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388572A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388648F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3885E1130>]}
[0m15:11:47.951735 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:13:35.972837 | ab934b9e-7b81-4884-acc4-4a702b2e1f30 ==============================
[0m15:13:35.972837 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:13:35.975838 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m15:13:35.976837 [debug] [MainThread]: Tracking: tracking
[0m15:13:35.976837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407726C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407726F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407726EB0>]}
[0m15:13:36.208020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:36.209021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:36.220019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab934b9e-7b81-4884-acc4-4a702b2e1f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4078540D0>]}
[0m15:13:36.239045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab934b9e-7b81-4884-acc4-4a702b2e1f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407821280>]}
[0m15:13:36.240024 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:13:36.243024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab934b9e-7b81-4884-acc4-4a702b2e1f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4078214C0>]}
[0m15:13:36.245022 [info ] [MainThread]: 
[0m15:13:36.248020 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:36.250176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:13:36.276141 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:13:36.277142 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:13:36.277482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:37.018635 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:13:37.021632 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:13:37.126070 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:13:37.136083 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:13:37.137547 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:13:37.138082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:37.388700 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m15:13:37.390699 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:13:37.487700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab934b9e-7b81-4884-acc4-4a702b2e1f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407821160>]}
[0m15:13:37.489700 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:13:37.490699 [info ] [MainThread]: 
[0m15:13:37.499701 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:13:37.500914 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:13:37.502702 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:13:37.503706 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:13:37.511712 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:13:37.514005 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:13:37.503706 => 2023-04-19 15:13:37.514005
[0m15:13:37.514707 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:13:37.566706 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:13:37.566706 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:13:37.567705 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:13:38.059395 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:13:38.061392 [info ] [Thread-1  ]:   => 60 record(s) to merge
[0m15:13:38.073082 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:13:38.074078 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m15:13:38.164357 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m15:13:38.168999 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:13:38.173046 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:13:38.174251 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:13:38.303965 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:13:38.305097 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:13:38.305964 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m15:13:38.542130 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:13:38.542972 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:13:38.544025 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:13:38.606959 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:13:38.607246 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:13:38.608249 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m15:13:39.924423 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 1 seconds
[0m15:13:39.927445 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:13:37.515704 => 2023-04-19 15:13:39.927445
[0m15:13:39.928426 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:13:40.024673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab934b9e-7b81-4884-acc4-4a702b2e1f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407BCED90>]}
[0m15:13:40.025547 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 60[0m in 2.52s]
[0m15:13:40.028849 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:13:40.031547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:40.032886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:40.033668 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:13:40.034548 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:13:40.035551 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:13:40.036580 [info ] [MainThread]: 
[0m15:13:40.038546 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m15:13:40.040546 [debug] [MainThread]: Command end result
[0m15:13:40.055547 [info ] [MainThread]: 
[0m15:13:40.056547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:40.058547 [info ] [MainThread]: 
[0m15:13:40.060545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:13:40.061545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407742CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407818F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F407821160>]}
[0m15:13:40.062547 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:26:16.139059 | fa769534-c45f-4e31-bac9-55ac168c6006 ==============================
[0m15:26:16.139059 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:26:16.143020 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m15:26:16.143020 [debug] [MainThread]: Tracking: tracking
[0m15:26:16.144018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9296E5C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9296E5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9296E5EE0>]}
[0m15:26:16.314018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:16.315023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:16.323022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa769534-c45f-4e31-bac9-55ac168c6006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9298130D0>]}
[0m15:26:16.334021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa769534-c45f-4e31-bac9-55ac168c6006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9297942B0>]}
[0m15:26:16.334021 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:26:16.335018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa769534-c45f-4e31-bac9-55ac168c6006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9297944F0>]}
[0m15:26:16.337019 [info ] [MainThread]: 
[0m15:26:16.340022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:16.342020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:26:16.360020 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:26:16.360020 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:26:16.361023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:17.201034 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:26:17.203032 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:26:17.302034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:26:17.310621 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:26:17.311060 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:26:17.311760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:17.772236 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m15:26:17.775269 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:26:17.885400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa769534-c45f-4e31-bac9-55ac168c6006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B929794190>]}
[0m15:26:17.887397 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:26:17.890357 [info ] [MainThread]: 
[0m15:26:17.906355 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:26:17.907452 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:26:17.909527 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:26:17.910355 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:26:17.918392 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:26:17.919482 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:26:17.910355 => 2023-04-19 15:26:17.919482
[0m15:26:17.920356 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:26:17.952355 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:26:17.952693 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:26:17.953357 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:26:18.839798 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:26:18.848946 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:26:18.849919 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m15:26:18.851915 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:26:18.854913 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:26:18.854913 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:26:19.002915 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:26:19.003951 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:26:19.003951 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    PERSO.ARO_DWH.S_conso_client
);
[0m15:26:19.277466 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:26:19.278422 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:26:19.279424 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:26:19.346423 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:26:19.347422 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:26:19.348421 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m15:26:19.468906 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:26:19.470001 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:26:19.471274 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m15:26:19.609394 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:26:19.611392 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:26:17.920356 => 2023-04-19 15:26:19.611392
[0m15:26:19.611392 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:26:19.722639 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa769534-c45f-4e31-bac9-55ac168c6006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B929C421F0>]}
[0m15:26:19.723640 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.81s]
[0m15:26:19.725679 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:26:19.732641 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:19.733641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:19.733641 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:26:19.734339 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:26:19.734640 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:26:19.734640 [info ] [MainThread]: 
[0m15:26:19.736641 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m15:26:19.737642 [debug] [MainThread]: Command end result
[0m15:26:19.749643 [info ] [MainThread]: 
[0m15:26:19.751652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:19.753642 [info ] [MainThread]: 
[0m15:26:19.754644 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:26:19.755641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9296F39A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B929794190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B929BFBC10>]}
[0m15:26:19.757121 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:31:29.829821 | bcd61d42-f36a-4cff-beb6-03b20374f8c7 ==============================
[0m15:31:29.829821 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:31:29.831796 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m15:31:29.832700 [debug] [MainThread]: Tracking: tracking
[0m15:31:29.833701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0BD5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0BD5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0BD5EB0>]}
[0m15:31:29.982248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:29.983250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:29.990387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcd61d42-f36a-4cff-beb6-03b20374f8c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0D040D0>]}
[0m15:31:30.002347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcd61d42-f36a-4cff-beb6-03b20374f8c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0CD1280>]}
[0m15:31:30.002347 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:31:30.003217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd61d42-f36a-4cff-beb6-03b20374f8c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0CD14C0>]}
[0m15:31:30.005240 [info ] [MainThread]: 
[0m15:31:30.007222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:31:30.010212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:31:30.028216 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:31:30.028216 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:31:30.029216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:30.824507 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:31:30.826507 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:31:30.913503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:31:30.924504 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:31:30.925506 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:31:30.925506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:31.176536 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m15:31:31.178501 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:31:31.293536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd61d42-f36a-4cff-beb6-03b20374f8c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0CD1160>]}
[0m15:31:31.294540 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:31:31.295500 [info ] [MainThread]: 
[0m15:31:31.302504 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:31:31.303503 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:31:31.304504 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:31:31.305792 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:31:31.314502 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:31:31.316501 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:31:31.306828 => 2023-04-19 15:31:31.316501
[0m15:31:31.316501 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:31:31.357505 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:31:31.358506 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:31:31.359503 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:31:31.898991 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:31:31.900991 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:31:31.902992 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m15:31:31.904993 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:31:31.907992 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:31:31.907992 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:31:32.042990 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:31:32.043878 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:31:32.043989 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m15:31:32.235595 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:31:32.236023 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:31:32.237398 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:31:32.295022 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:31:32.295022 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:31:32.296021 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m15:31:32.356020 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:31:32.356020 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:31:32.357019 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m15:31:32.464021 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:31:32.465022 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:31:31.317501 => 2023-04-19 15:31:32.465022
[0m15:31:32.466023 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:31:32.568053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd61d42-f36a-4cff-beb6-03b20374f8c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE10FFBB0>]}
[0m15:31:32.569357 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.26s]
[0m15:31:32.573092 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:31:32.575051 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:31:32.576530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:32.577052 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:31:32.577052 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:31:32.578086 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:31:32.578086 [info ] [MainThread]: 
[0m15:31:32.580252 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m15:31:32.582055 [debug] [MainThread]: Command end result
[0m15:31:32.598048 [info ] [MainThread]: 
[0m15:31:32.600054 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:32.602054 [info ] [MainThread]: 
[0m15:31:32.603207 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:31:32.605398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0BF2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0CC8F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AE0CD1160>]}
[0m15:31:32.607059 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:33:19.751016 | 3bde9ab4-5f71-463f-8332-deac9eff17e8 ==============================
[0m15:33:19.751016 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:33:19.754026 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m15:33:19.755018 [debug] [MainThread]: Tracking: tracking
[0m15:33:19.756017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A5C7C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A5C7F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A5C7E80>]}
[0m15:33:19.947505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:19.948285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:19.957604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bde9ab4-5f71-463f-8332-deac9eff17e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A6F4FD0>]}
[0m15:33:19.973559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bde9ab4-5f71-463f-8332-deac9eff17e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A651250>]}
[0m15:33:19.974029 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:33:19.977036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bde9ab4-5f71-463f-8332-deac9eff17e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A651490>]}
[0m15:33:19.980024 [info ] [MainThread]: 
[0m15:33:19.986897 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:19.989905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:33:20.010410 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:33:20.011615 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:33:20.012623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:20.763108 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:33:20.765096 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:33:20.866372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:33:20.875932 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:33:20.875932 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:33:20.877121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:21.159484 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:21.164261 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:33:21.295495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bde9ab4-5f71-463f-8332-deac9eff17e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A651130>]}
[0m15:33:21.301076 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:33:21.307190 [info ] [MainThread]: 
[0m15:33:21.343057 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:33:21.347968 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:33:21.353192 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:33:21.357712 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:33:21.383197 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:33:21.391110 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:33:21.358713 => 2023-04-19 15:33:21.390571
[0m15:33:21.392245 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:33:21.459266 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:21.460062 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:33:21.462061 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:33:22.026095 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:33:22.028582 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:33:22.030585 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m15:33:22.032667 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:33:22.037582 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:22.038611 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:33:22.194482 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:22.196314 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:22.198314 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m15:33:22.439876 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:22.440877 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:22.442286 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:33:22.515999 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:22.516998 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:22.518014 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m15:33:22.578106 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:22.580068 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:22.581424 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m15:33:22.683205 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:22.687201 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:33:21.393090 => 2023-04-19 15:33:22.687201
[0m15:33:22.688263 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:33:22.803072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bde9ab4-5f71-463f-8332-deac9eff17e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059AA74250>]}
[0m15:33:22.804073 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.45s]
[0m15:33:22.809072 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:33:22.816166 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:22.818166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:22.824139 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:33:22.826190 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:33:22.829134 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:33:22.830685 [info ] [MainThread]: 
[0m15:33:22.832207 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m15:33:22.835207 [debug] [MainThread]: Command end result
[0m15:33:22.863158 [info ] [MainThread]: 
[0m15:33:22.870150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:22.872057 [info ] [MainThread]: 
[0m15:33:22.875188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:33:22.878051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A5E2A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A6B8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059A651130>]}
[0m15:33:22.880065 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:33:47.360227 | 0cb8bf5b-f814-4659-bd39-a9653cfaee67 ==============================
[0m15:33:47.360227 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:33:47.364085 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m15:33:47.365000 [debug] [MainThread]: Tracking: tracking
[0m15:33:47.365000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8D65C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8D65F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8D65EB0>]}
[0m15:33:47.568501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:47.569584 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:47.580297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb8bf5b-f814-4659-bd39-a9653cfaee67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8E950D0>]}
[0m15:33:47.596048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb8bf5b-f814-4659-bd39-a9653cfaee67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8E61280>]}
[0m15:33:47.597123 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:33:47.598044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb8bf5b-f814-4659-bd39-a9653cfaee67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8E614C0>]}
[0m15:33:47.600046 [info ] [MainThread]: 
[0m15:33:47.602048 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:47.604045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:33:47.622044 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:33:47.623045 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:33:47.624044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:48.229891 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:33:48.232887 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:33:48.339708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:33:48.349744 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:33:48.350743 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:33:48.351704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:48.811903 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:48.814902 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:33:48.914276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb8bf5b-f814-4659-bd39-a9653cfaee67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8E61160>]}
[0m15:33:48.916275 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:33:48.918244 [info ] [MainThread]: 
[0m15:33:48.928242 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:33:48.929243 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:33:48.930242 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:33:48.931242 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:33:48.940277 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:33:48.943246 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:33:48.931533 => 2023-04-19 15:33:48.943246
[0m15:33:48.946243 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:33:49.003239 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:49.003239 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:33:49.004237 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:33:49.274777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:49.277808 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:33:49.279776 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m15:33:49.281779 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:33:49.285773 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:49.285773 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m15:33:49.367774 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:49.368126 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:49.368773 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m15:33:49.454144 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:49.454808 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:49.455494 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:33:49.564349 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:49.565350 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:49.565350 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m15:33:49.760117 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:49.762119 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:49.764182 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:33:50.529420 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:33:50.529420 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:50.530422 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m15:33:50.594181 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:50.596145 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:33:50.597147 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m15:33:50.706072 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:33:50.709070 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:33:48.946243 => 2023-04-19 15:33:50.709070
[0m15:33:50.710076 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:33:50.804822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb8bf5b-f814-4659-bd39-a9653cfaee67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C92A7460>]}
[0m15:33:50.805822 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.87s]
[0m15:33:50.811192 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:33:50.814824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:50.816823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:50.818222 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:33:50.818823 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:33:50.818823 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:33:50.820021 [info ] [MainThread]: 
[0m15:33:50.821269 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m15:33:50.822820 [debug] [MainThread]: Command end result
[0m15:33:50.835825 [info ] [MainThread]: 
[0m15:33:50.836826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:50.838827 [info ] [MainThread]: 
[0m15:33:50.839826 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:33:50.841828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8D82CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8E58F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C8E61160>]}
[0m15:33:50.842826 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:37:31.991017 | 9c6f58c7-588b-4af5-80e5-ac32d02a3c9d ==============================
[0m15:37:31.991017 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:37:31.993029 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m15:37:31.993029 [debug] [MainThread]: Tracking: tracking
[0m15:37:31.994065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82D85BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82D85F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82D85E50>]}
[0m15:37:32.149053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:32.149053 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:32.158052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c6f58c7-588b-4af5-80e5-ac32d02a3c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82EB5FA0>]}
[0m15:37:32.169018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c6f58c7-588b-4af5-80e5-ac32d02a3c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82E81250>]}
[0m15:37:32.170018 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:37:32.171018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c6f58c7-588b-4af5-80e5-ac32d02a3c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82E81490>]}
[0m15:37:32.173019 [info ] [MainThread]: 
[0m15:37:32.176019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:32.178018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:37:32.204023 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:37:32.205022 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:37:32.209019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:32.945505 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:37:32.948212 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:37:33.047099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:37:33.057100 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:37:33.058238 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:37:33.058238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:33.505567 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m15:37:33.507565 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:37:33.602968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c6f58c7-588b-4af5-80e5-ac32d02a3c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82E81040>]}
[0m15:37:33.604969 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:37:33.605601 [info ] [MainThread]: 
[0m15:37:33.613534 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:37:33.614532 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:37:33.616534 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:37:33.616534 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:37:33.626559 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:37:33.627561 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:37:33.617531 => 2023-04-19 15:37:33.627561
[0m15:37:33.628954 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:37:33.675532 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:37:33.676530 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:37:33.676530 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:37:34.234092 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:37:34.236094 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:37:34.237099 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m15:37:34.238912 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:37:34.240914 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:37:34.241912 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m15:37:34.355970 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:37:34.355970 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:37:34.357011 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m15:37:34.430033 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:37:34.431245 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:37:34.431998 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:37:34.545767 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:37:34.546768 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:37:34.546768 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    True
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m15:37:34.640990 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbe9-3201-bb68-0001-2d160036f6fe
[0m15:37:34.641533 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 13 unexpected '.'.
[0m15:37:34.642533 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:37:33.629643 => 2023-04-19 15:37:34.642533
[0m15:37:34.642646 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:37:34.770133 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 13 unexpected '.'.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m15:37:34.771130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c6f58c7-588b-4af5-80e5-ac32d02a3c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D8329BE20>]}
[0m15:37:34.771130 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.16s]
[0m15:37:34.775084 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:37:34.778082 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:34.779251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:34.780083 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:37:34.781081 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:37:34.781081 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:37:34.782116 [info ] [MainThread]: 
[0m15:37:34.784086 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m15:37:34.786084 [debug] [MainThread]: Command end result
[0m15:37:34.803128 [info ] [MainThread]: 
[0m15:37:34.804082 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:34.806080 [info ] [MainThread]: 
[0m15:37:34.807082 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m15:37:34.809100 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m15:37:34.811085 [error] [MainThread]:   syntax error line 13 at position 13 unexpected '.'.
[0m15:37:34.812081 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m15:37:34.813081 [info ] [MainThread]: 
[0m15:37:34.815083 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:37:34.817082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82EA48E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82D95B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D82E812B0>]}
[0m15:37:34.817082 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:37:59.094921 | f939bc90-7844-465f-aa2d-e1b186ff344b ==============================
[0m15:37:59.094921 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:37:59.097918 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m15:37:59.097918 [debug] [MainThread]: Tracking: tracking
[0m15:37:59.099003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0577BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0577F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0577E50>]}
[0m15:37:59.300136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:59.300136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:59.307982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f939bc90-7844-465f-aa2d-e1b186ff344b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB06A5FA0>]}
[0m15:37:59.320983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f939bc90-7844-465f-aa2d-e1b186ff344b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0600250>]}
[0m15:37:59.321983 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:37:59.323986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f939bc90-7844-465f-aa2d-e1b186ff344b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0600490>]}
[0m15:37:59.326178 [info ] [MainThread]: 
[0m15:37:59.327996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:59.330037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:37:59.352985 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:37:59.354285 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:37:59.354987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:00.343513 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:38:00.346619 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:38:00.568572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:38:00.586601 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:38:00.588568 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:38:00.589936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:01.136614 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m15:38:01.138614 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:38:01.248980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f939bc90-7844-465f-aa2d-e1b186ff344b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0600040>]}
[0m15:38:01.250166 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:38:01.252135 [info ] [MainThread]: 
[0m15:38:01.264134 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:38:01.265764 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:38:01.268134 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:38:01.268134 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:38:01.284163 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:38:01.286559 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:38:01.269190 => 2023-04-19 15:38:01.286559
[0m15:38:01.287170 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:38:01.323163 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:38:01.324170 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:38:01.325172 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:38:01.884498 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:38:01.886498 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:38:01.888466 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m15:38:01.890469 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:38:01.893466 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:38:01.894260 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m15:38:01.990508 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbea-3201-ba10-0001-2d1600372016
[0m15:38:01.990782 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'PERSO.ARO_DWH.CONSO_CLIENT' does not exist or not authorized.
[0m15:38:01.991470 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:38:01.287170 => 2023-04-19 15:38:01.991470
[0m15:38:01.992467 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:38:02.087469 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  002003 (42S02): SQL compilation error:
  Table 'PERSO.ARO_DWH.CONSO_CLIENT' does not exist or not authorized.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m15:38:02.087469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f939bc90-7844-465f-aa2d-e1b186ff344b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0A86880>]}
[0m15:38:02.089128 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.82s]
[0m15:38:02.091504 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:38:02.094469 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:02.096467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:02.098481 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:38:02.098481 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:38:02.099468 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:38:02.100469 [info ] [MainThread]: 
[0m15:38:02.101469 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m15:38:02.128881 [debug] [MainThread]: Command end result
[0m15:38:02.145497 [info ] [MainThread]: 
[0m15:38:02.147467 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:38:02.148690 [info ] [MainThread]: 
[0m15:38:02.149467 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m15:38:02.151466 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m15:38:02.152466 [error] [MainThread]:   Table 'PERSO.ARO_DWH.CONSO_CLIENT' does not exist or not authorized.
[0m15:38:02.152466 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m15:38:02.153478 [info ] [MainThread]: 
[0m15:38:02.154469 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:38:02.155466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0A47070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB0585B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB06002B0>]}
[0m15:38:02.156468 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:43:14.362048 | 3dd0f701-5a76-4626-86f5-3ff36167abd8 ==============================
[0m15:43:14.362048 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:43:14.365050 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m15:43:14.365050 [debug] [MainThread]: Tracking: tracking
[0m15:43:14.366056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DB15CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DB15F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DB15F10>]}
[0m15:43:14.585187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:43:14.586560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:43:14.594182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dd0f701-5a76-4626-86f5-3ff36167abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DC470D0>]}
[0m15:43:14.607016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dd0f701-5a76-4626-86f5-3ff36167abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DBBA2E0>]}
[0m15:43:14.608016 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:43:14.610022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd0f701-5a76-4626-86f5-3ff36167abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DBBA520>]}
[0m15:43:14.612019 [info ] [MainThread]: 
[0m15:43:14.615017 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:43:14.617450 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:43:14.636017 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:43:14.637390 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:43:14.638102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:15.333066 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:43:15.335070 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:43:15.435919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:43:15.442914 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:43:15.443914 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:43:15.444915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:15.871709 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0 seconds
[0m15:43:15.873742 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:43:16.030710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd0f701-5a76-4626-86f5-3ff36167abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DBBA130>]}
[0m15:43:16.031709 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:43:16.032717 [info ] [MainThread]: 
[0m15:43:16.040710 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:43:16.041713 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:43:16.043709 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:43:16.043709 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:43:16.052735 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:43:16.053707 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:43:16.044747 => 2023-04-19 15:43:16.053707
[0m15:43:16.054743 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:43:16.120957 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:43:16.121860 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:43:16.121860 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:43:16.524247 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:43:16.526244 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:43:16.527281 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m15:43:16.529246 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:43:16.531241 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:43:16.531241 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:43:16.631590 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:43:16.632856 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:43:16.633243 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m15:43:16.844172 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:43:16.844172 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:43:16.845182 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:43:17.522239 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:43:17.523233 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:43:17.523233 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m15:43:17.573062 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:43:17.573845 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:43:17.574813 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m15:43:17.676787 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:43:17.682742 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:43:16.054743 => 2023-04-19 15:43:17.681995
[0m15:43:17.683744 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:43:17.772606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd0f701-5a76-4626-86f5-3ff36167abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DD0C670>]}
[0m15:43:17.773620 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.73s]
[0m15:43:17.778603 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:43:17.781577 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:43:17.782578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:17.783577 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:43:17.783577 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:43:17.784576 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:43:17.784576 [info ] [MainThread]: 
[0m15:43:17.786572 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m15:43:17.788573 [debug] [MainThread]: Command end result
[0m15:43:17.800622 [info ] [MainThread]: 
[0m15:43:17.802570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:17.803623 [info ] [MainThread]: 
[0m15:43:17.805576 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:43:17.806989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DB24130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DC08C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88DBBA070>]}
[0m15:43:17.807879 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:54:37.112539 | 9182cf55-cd22-41ca-808e-bc950a8d266a ==============================
[0m15:54:37.112539 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:54:37.114888 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m15:54:37.115888 [debug] [MainThread]: Tracking: tracking
[0m15:54:37.115888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B48C6C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B48C6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B48C6EE0>]}
[0m15:54:37.310655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:37.313922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:37.329441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9182cf55-cd22-41ca-808e-bc950a8d266a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B49F30D0>]}
[0m15:54:37.357439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9182cf55-cd22-41ca-808e-bc950a8d266a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B49702B0>]}
[0m15:54:37.386587 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:54:37.435496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9182cf55-cd22-41ca-808e-bc950a8d266a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B49704F0>]}
[0m15:54:37.440452 [info ] [MainThread]: 
[0m15:54:37.456450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:54:37.462463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:54:37.501508 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:54:37.502442 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:54:37.503441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:38.754848 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:54:38.758844 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:54:38.946553 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:54:38.955555 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:54:38.956554 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:54:38.957552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:39.459541 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m15:54:39.467512 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:54:39.569550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9182cf55-cd22-41ca-808e-bc950a8d266a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B4970190>]}
[0m15:54:39.571514 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:54:39.574019 [info ] [MainThread]: 
[0m15:54:39.584514 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:54:39.585515 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:54:39.588516 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:54:39.589511 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:54:39.600512 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:54:39.603636 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:54:39.590514 => 2023-04-19 15:54:39.603636
[0m15:54:39.605519 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:54:39.674511 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:54:39.676831 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:54:39.678506 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:54:40.210842 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:54:40.212841 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:54:40.213841 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m15:54:40.215843 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:54:40.218842 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:54:40.218842 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m15:54:40.327846 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:54:40.328883 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:54:40.328883 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m15:54:40.413915 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:54:40.414848 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:54:40.415848 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:54:40.543803 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:54:40.544956 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:54:40.546212 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m15:54:40.749913 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:54:40.750919 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:54:40.751900 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:54:41.807160 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:54:41.808161 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:54:41.809161 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m15:54:41.873474 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:54:41.875028 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:54:41.875410 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m15:54:41.980412 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:54:41.983457 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:54:39.606512 => 2023-04-19 15:54:41.983457
[0m15:54:41.984448 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:54:42.081397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9182cf55-cd22-41ca-808e-bc950a8d266a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B4D6EDC0>]}
[0m15:54:42.081666 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.49s]
[0m15:54:42.085694 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:54:42.088665 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:54:42.090764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:42.091664 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:54:42.092664 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:54:42.092664 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:54:42.094670 [info ] [MainThread]: 
[0m15:54:42.095665 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m15:54:42.096669 [debug] [MainThread]: Command end result
[0m15:54:42.112021 [info ] [MainThread]: 
[0m15:54:42.113013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:54:42.115016 [info ] [MainThread]: 
[0m15:54:42.116016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:54:42.117012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B48D3D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B49B8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2B4970190>]}
[0m15:54:42.118050 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 15:58:17.516473 | a83cc4a9-4842-4b92-a463-eb6d63d081b0 ==============================
[0m15:58:17.516473 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:58:17.519477 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m15:58:17.519477 [debug] [MainThread]: Tracking: tracking
[0m15:58:17.520547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD52D7CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD52D7F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD52D7F10>]}
[0m15:58:17.663236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:17.663236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:17.670279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a83cc4a9-4842-4b92-a463-eb6d63d081b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD54040D0>]}
[0m15:58:17.682507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a83cc4a9-4842-4b92-a463-eb6d63d081b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD53842E0>]}
[0m15:58:17.683282 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:58:17.684242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a83cc4a9-4842-4b92-a463-eb6d63d081b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD5384520>]}
[0m15:58:17.685305 [info ] [MainThread]: 
[0m15:58:17.688274 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:17.689244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m15:58:17.708247 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m15:58:17.709389 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m15:58:17.710246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:18.311674 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m15:58:18.314051 [debug] [ThreadPool]: On list_PERSO: Close
[0m15:58:18.422517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m15:58:18.433507 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m15:58:18.433507 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m15:58:18.434597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:19.146014 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m15:58:19.148014 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m15:58:19.250722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a83cc4a9-4842-4b92-a463-eb6d63d081b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD5384130>]}
[0m15:58:19.252560 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m15:58:19.254558 [info ] [MainThread]: 
[0m15:58:19.261557 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m15:58:19.261557 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m15:58:19.263558 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m15:58:19.264555 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m15:58:19.273589 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m15:58:19.275719 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 15:58:19.264685 => 2023-04-19 15:58:19.275719
[0m15:58:19.276559 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m15:58:19.312717 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:58:19.312717 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m15:58:19.313564 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:58:20.306921 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:58:20.308814 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m15:58:20.319814 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:58:20.319814 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m15:58:20.438215 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbfe-3201-bb68-0001-2d160036f7a2
[0m15:58:20.439216 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'PERSO.ARO_DWH.V_CONSO_CLIENT' does not exist or not authorized.
[0m15:58:20.439773 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m15:58:20.440216 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m15:58:20.441217 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m15:58:20.443219 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:58:20.444215 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m15:58:20.787742 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:58:20.788123 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:58:20.789125 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m15:58:20.980995 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:58:20.981957 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:58:20.982984 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m15:58:21.172427 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:58:21.172427 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:58:21.173316 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m15:58:21.375949 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m15:58:21.376948 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:58:21.377949 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client) WHERE 1=0;
[0m15:58:22.221097 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m15:58:22.222106 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m15:58:22.223268 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    )
    VALUES
    (
    )
    ;
[0m15:58:22.400093 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbbfe-3201-ba10-0001-2d16003720ae
[0m15:58:22.401092 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 9 unexpected 'NOT'.
syntax error line 10 at position 21 unexpected 'THEN'.
[0m15:58:22.402094 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 15:58:19.276559 => 2023-04-19 15:58:22.402094
[0m15:58:22.402094 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m15:58:22.600528 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected 'NOT'.
  syntax error line 10 at position 21 unexpected 'THEN'.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m15:58:22.601111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83cc4a9-4842-4b92-a463-eb6d63d081b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD580A2B0>]}
[0m15:58:22.602291 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 3.34s]
[0m15:58:22.605111 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m15:58:22.607114 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:22.608115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:22.609112 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m15:58:22.609112 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m15:58:22.610112 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m15:58:22.610112 [info ] [MainThread]: 
[0m15:58:22.611110 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m15:58:22.612113 [debug] [MainThread]: Command end result
[0m15:58:22.623140 [info ] [MainThread]: 
[0m15:58:22.625163 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:58:22.626111 [info ] [MainThread]: 
[0m15:58:22.628111 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m15:58:22.629113 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m15:58:22.629113 [error] [MainThread]:   syntax error line 10 at position 9 unexpected 'NOT'.
[0m15:58:22.630202 [error] [MainThread]:   syntax error line 10 at position 21 unexpected 'THEN'.
[0m15:58:22.631112 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m15:58:22.632117 [info ] [MainThread]: 
[0m15:58:22.633111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:58:22.634111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD52E4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD5384400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD5384130>]}
[0m15:58:22.634111 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:00:32.618903 | 867d0e32-6c13-403c-be7c-1af4ead96abf ==============================
[0m16:00:32.618903 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:00:32.620906 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:00:32.621906 [debug] [MainThread]: Tracking: tracking
[0m16:00:32.621906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F155CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F155F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F155F10>]}
[0m16:00:32.792911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:32.794912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:32.808905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '867d0e32-6c13-403c-be7c-1af4ead96abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F2850D0>]}
[0m16:00:32.824906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '867d0e32-6c13-403c-be7c-1af4ead96abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F1FE2E0>]}
[0m16:00:32.825908 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:00:32.826908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867d0e32-6c13-403c-be7c-1af4ead96abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F1FE520>]}
[0m16:00:32.827910 [info ] [MainThread]: 
[0m16:00:32.831153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:32.832907 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:00:32.862909 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:00:32.863915 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:00:32.863915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:33.574711 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:00:33.580709 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:00:34.203638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:00:34.213629 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:00:34.213629 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:00:34.214634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:34.580206 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m16:00:34.583206 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:00:35.160259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867d0e32-6c13-403c-be7c-1af4ead96abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F1FE130>]}
[0m16:00:35.162972 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:00:35.167238 [info ] [MainThread]: 
[0m16:00:35.195214 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:00:35.196651 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:00:35.200248 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:00:35.205977 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:00:35.232403 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:00:35.234518 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:00:35.207221 => 2023-04-19 16:00:35.234518
[0m16:00:35.235925 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:00:35.307664 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:00:35.307664 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:00:35.308662 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:00:36.337810 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:00:36.341961 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:00:36.368231 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:00:36.369016 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m16:00:36.586981 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:00:36.591979 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:00:36.598011 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:00:36.599980 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m16:00:37.996863 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:00:37.997862 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:00:37.998869 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m16:00:38.147416 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:00:38.148255 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:00:38.149300 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:00:38.756031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:00:38.756031 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:00:38.757040 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m16:00:38.951447 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:00:38.951447 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:00:38.952446 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:00:39.671819 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:00:39.672869 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:00:39.674014 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m16:00:40.261239 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbc00-3201-bb68-0001-2d160036f7b6
[0m16:00:40.262236 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m16:00:40.263583 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:00:35.237579 => 2023-04-19 16:00:40.263583
[0m16:00:40.264236 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:00:40.650427 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m16:00:40.651350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867d0e32-6c13-403c-be7c-1af4ead96abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F5FFE20>]}
[0m16:00:40.652856 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 5.45s]
[0m16:00:40.656349 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:00:40.661353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:40.664370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:40.665543 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:00:40.667352 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:00:40.668353 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:00:40.669351 [info ] [MainThread]: 
[0m16:00:40.671035 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m16:00:40.672356 [debug] [MainThread]: Command end result
[0m16:00:40.700531 [info ] [MainThread]: 
[0m16:00:40.702518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:00:40.704515 [info ] [MainThread]: 
[0m16:00:40.707191 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m16:00:40.715554 [error] [MainThread]:   100090 (42P18): Duplicate row detected during DML action
[0m16:00:40.717515 [error] [MainThread]:   Row Values: [redacted]
[0m16:00:40.719519 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m16:00:40.720516 [info ] [MainThread]: 
[0m16:00:40.722516 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:00:40.724898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F165130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F1FE130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F274AC0>]}
[0m16:00:40.730523 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:01:41.708780 | 55ae7923-4704-4576-a81a-d367c38f9693 ==============================
[0m16:01:41.708780 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:01:41.711304 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:01:41.711304 [debug] [MainThread]: Tracking: tracking
[0m16:01:41.712301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E0026CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E0026F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E0026F10>]}
[0m16:01:41.874444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:41.875302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:41.882338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ae7923-4704-4576-a81a-d367c38f9693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E01540D0>]}
[0m16:01:41.893303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ae7923-4704-4576-a81a-d367c38f9693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E00D02E0>]}
[0m16:01:41.894306 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:01:41.895303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ae7923-4704-4576-a81a-d367c38f9693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E00D0520>]}
[0m16:01:41.897302 [info ] [MainThread]: 
[0m16:01:41.899343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:01:41.901307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:01:41.917423 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:01:41.918305 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:01:41.918305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:42.586388 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:01:42.589387 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:01:42.691745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:01:42.699752 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:01:42.700795 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:01:42.700795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:43.123069 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m16:01:43.127899 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:01:43.249412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ae7923-4704-4576-a81a-d367c38f9693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E00D0130>]}
[0m16:01:43.251417 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:01:43.253408 [info ] [MainThread]: 
[0m16:01:43.261407 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:01:43.262407 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:01:43.264411 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:01:43.264411 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:01:43.277409 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:01:43.278741 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:01:43.265448 => 2023-04-19 16:01:43.278741
[0m16:01:43.280179 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:01:43.318755 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:01:43.319755 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:01:43.320756 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:01:44.483223 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:01:44.487222 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:01:44.490770 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:01:44.494276 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:01:44.499272 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:01:44.500276 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m16:01:44.660236 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:01:44.661235 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:01:44.661235 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m16:01:44.760409 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:01:44.761414 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:01:44.761414 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:01:44.883413 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:01:44.884414 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:01:44.885411 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m16:01:45.627675 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:01:45.627675 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:01:45.628665 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:01:47.035111 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:01:47.037110 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:01:47.038110 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:01:47.138626 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:01:47.139670 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:01:47.141633 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:01:47.248305 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:01:47.249278 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:01:43.280756 => 2023-04-19 16:01:47.249278
[0m16:01:47.250423 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:01:47.536607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55ae7923-4704-4576-a81a-d367c38f9693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E054EB50>]}
[0m16:01:47.538602 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 4.27s]
[0m16:01:47.541600 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:01:47.543601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:01:47.544605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:47.545607 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:01:47.545607 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:01:47.546902 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:01:47.546902 [info ] [MainThread]: 
[0m16:01:47.548602 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m16:01:47.549637 [debug] [MainThread]: Command end result
[0m16:01:47.561645 [info ] [MainThread]: 
[0m16:01:47.563603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:47.565604 [info ] [MainThread]: 
[0m16:01:47.566605 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:01:47.567604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E0034130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E00D0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E00D0070>]}
[0m16:01:47.568603 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:07:36.441706 | f0dee05a-460c-4e89-bb09-bfe055d29b70 ==============================
[0m16:07:36.441706 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:07:36.443270 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:07:36.444188 [debug] [MainThread]: Tracking: tracking
[0m16:07:36.445185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D4D6CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D4D6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D4D6F10>]}
[0m16:07:36.607779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:36.608781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:36.616744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0dee05a-460c-4e89-bb09-bfe055d29b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D6050D0>]}
[0m16:07:36.636412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0dee05a-460c-4e89-bb09-bfe055d29b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D57D2E0>]}
[0m16:07:36.637425 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:07:36.640545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0dee05a-460c-4e89-bb09-bfe055d29b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D57D520>]}
[0m16:07:36.642454 [info ] [MainThread]: 
[0m16:07:36.646452 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:36.649788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:07:36.669449 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:07:36.670448 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:07:36.671435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:37.394325 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:07:37.396323 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:07:37.508583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:07:37.516546 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:07:37.517548 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:07:37.517925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:37.959769 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m16:07:37.962774 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:07:38.053773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0dee05a-460c-4e89-bb09-bfe055d29b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D57D130>]}
[0m16:07:38.055776 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:07:38.056787 [info ] [MainThread]: 
[0m16:07:38.065770 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:07:38.066792 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:07:38.069774 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:07:38.070779 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:07:38.080776 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:07:38.083774 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:07:38.070779 => 2023-04-19 16:07:38.083774
[0m16:07:38.084773 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:07:38.126772 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:07:38.126940 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:07:38.127777 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:07:38.695042 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:07:38.697042 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:07:38.698041 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:07:38.700043 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:07:38.703784 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:07:38.704040 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m16:07:38.809075 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:07:38.809075 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:07:38.810073 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m16:07:38.907072 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:07:38.907072 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:07:38.908075 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:07:39.067105 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:07:39.068105 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:07:39.068105 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m16:07:39.309093 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:07:39.310089 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:07:39.310089 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:07:40.041547 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:07:40.042548 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:07:40.042548 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:07:40.124327 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:07:40.125338 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:07:40.126329 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:07:40.241262 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:07:40.243280 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:07:38.084773 => 2023-04-19 16:07:40.243280
[0m16:07:40.244272 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:07:40.343859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0dee05a-460c-4e89-bb09-bfe055d29b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D968B20>]}
[0m16:07:40.344858 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.28s]
[0m16:07:40.351289 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:07:40.360290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:40.362295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:40.363292 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:07:40.363292 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:07:40.364291 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:07:40.364291 [info ] [MainThread]: 
[0m16:07:40.366287 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m16:07:40.368288 [debug] [MainThread]: Command end result
[0m16:07:40.381017 [info ] [MainThread]: 
[0m16:07:40.382485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:40.384291 [info ] [MainThread]: 
[0m16:07:40.386290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:07:40.387292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D4E5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D57D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F5D6A3B20>]}
[0m16:07:40.388291 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:10:35.735816 | bbca5e18-3026-4dad-854c-e0cb33e9f925 ==============================
[0m16:10:35.735816 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:10:35.739816 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m16:10:35.739816 [debug] [MainThread]: Tracking: tracking
[0m16:10:35.740815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23196C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23196F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23196EB0>]}
[0m16:10:35.911717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:35.912718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:35.921715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbca5e18-3026-4dad-854c-e0cb33e9f925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F232C50D0>]}
[0m16:10:35.932730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbca5e18-3026-4dad-854c-e0cb33e9f925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23292280>]}
[0m16:10:35.933716 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:10:35.934717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbca5e18-3026-4dad-854c-e0cb33e9f925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F232924C0>]}
[0m16:10:35.936716 [info ] [MainThread]: 
[0m16:10:35.938716 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:35.940721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:10:35.957715 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:10:35.958716 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:10:35.959715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:36.688193 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:10:36.691192 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:10:36.822394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:10:36.831356 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:10:36.832577 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:10:36.832577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:37.334068 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m16:10:37.337057 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:10:37.470758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbca5e18-3026-4dad-854c-e0cb33e9f925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23292160>]}
[0m16:10:37.473806 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:10:37.475955 [info ] [MainThread]: 
[0m16:10:37.491255 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:10:37.492952 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:10:37.494973 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:10:37.495953 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:10:37.506951 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:10:37.508104 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:10:37.496950 => 2023-04-19 16:10:37.508104
[0m16:10:37.508951 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:10:37.547952 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:10:37.548952 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:10:37.548952 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:10:38.261070 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:10:38.263733 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:10:38.264747 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:10:38.266705 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:10:38.269738 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:10:38.269738 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:10:38.370708 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:10:38.371739 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:10:38.371739 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m16:10:38.621705 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:10:38.621705 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:10:38.622706 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:10:38.692197 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:10:38.695136 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:10:38.698135 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:10:38.765188 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:10:38.766183 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:10:38.767187 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:10:38.923246 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:10:38.925246 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:10:37.508951 => 2023-04-19 16:10:38.924246
[0m16:10:38.925246 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:10:39.013820 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbca5e18-3026-4dad-854c-e0cb33e9f925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F236DEB20>]}
[0m16:10:39.015821 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.52s]
[0m16:10:39.018859 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:10:39.020822 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:39.021903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:39.022830 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:10:39.022830 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:10:39.023822 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:10:39.023822 [info ] [MainThread]: 
[0m16:10:39.024822 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m16:10:39.026822 [debug] [MainThread]: Command end result
[0m16:10:39.039859 [info ] [MainThread]: 
[0m16:10:39.041823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:39.042899 [info ] [MainThread]: 
[0m16:10:39.043872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:10:39.045832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F231B2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23292160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23374730>]}
[0m16:10:39.046821 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:11:38.426893 | 4cd089eb-b013-4d42-bff3-b7bf8af6f018 ==============================
[0m16:11:38.426893 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:11:38.429644 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m16:11:38.429644 [debug] [MainThread]: Tracking: tracking
[0m16:11:38.430643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81D97C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81D97F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81D97EE0>]}
[0m16:11:38.609684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:38.610646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:38.624113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cd089eb-b013-4d42-bff3-b7bf8af6f018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81EC40D0>]}
[0m16:11:38.638647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cd089eb-b013-4d42-bff3-b7bf8af6f018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81E452B0>]}
[0m16:11:38.639716 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:11:38.640649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cd089eb-b013-4d42-bff3-b7bf8af6f018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81E454F0>]}
[0m16:11:38.641649 [info ] [MainThread]: 
[0m16:11:38.644690 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:38.646681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:11:38.665648 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:11:38.666682 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:11:38.666682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:39.466439 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:11:39.469467 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:11:39.596505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:11:39.606469 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:11:39.607471 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:11:39.608153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:39.943166 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m16:11:39.946169 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:11:40.045222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cd089eb-b013-4d42-bff3-b7bf8af6f018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81E45190>]}
[0m16:11:40.046224 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:11:40.048226 [info ] [MainThread]: 
[0m16:11:40.058225 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:11:40.059224 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:11:40.061231 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:11:40.062311 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:11:40.074224 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:11:40.075333 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:11:40.062311 => 2023-04-19 16:11:40.075333
[0m16:11:40.076226 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:11:40.114230 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:11:40.114907 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:11:40.115745 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:11:40.514600 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:11:40.517594 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m16:11:40.529592 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:11:40.530592 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m16:11:40.907287 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbc0b-3201-bb68-0001-2d160036f856
[0m16:11:40.907287 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'PERSO.ARO_DWH.V_CONSO_CLIENT' does not exist or not authorized.
[0m16:11:40.908290 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m16:11:40.909289 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m16:11:40.910734 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:11:40.914287 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:11:40.915953 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:11:41.072608 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:11:41.073605 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:11:41.073605 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m16:11:41.283918 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:11:41.283918 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:11:41.284918 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:11:41.354239 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:11:41.354947 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:11:41.355946 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    )
    VALUES
    (
    )
    ;
[0m16:11:41.424580 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbc0b-3201-bb68-0001-2d160036f85e
[0m16:11:41.425581 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 9 unexpected 'NOT'.
syntax error line 10 at position 21 unexpected 'THEN'.
[0m16:11:41.426581 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:11:40.076226 => 2023-04-19 16:11:41.426581
[0m16:11:41.427581 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:11:41.531513 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected 'NOT'.
  syntax error line 10 at position 21 unexpected 'THEN'.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m16:11:41.533523 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd089eb-b013-4d42-bff3-b7bf8af6f018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A8223EDC0>]}
[0m16:11:41.535519 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.47s]
[0m16:11:41.542526 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:11:41.547511 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:41.549555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:41.551517 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:11:41.552524 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:11:41.552524 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:11:41.553689 [info ] [MainThread]: 
[0m16:11:41.555744 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m16:11:41.557516 [debug] [MainThread]: Command end result
[0m16:11:41.571577 [info ] [MainThread]: 
[0m16:11:41.572509 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:11:41.574509 [info ] [MainThread]: 
[0m16:11:41.575615 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m16:11:41.577508 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m16:11:41.578509 [error] [MainThread]:   syntax error line 10 at position 9 unexpected 'NOT'.
[0m16:11:41.580517 [error] [MainThread]:   syntax error line 10 at position 21 unexpected 'THEN'.
[0m16:11:41.581540 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m16:11:41.582551 [info ] [MainThread]: 
[0m16:11:41.583548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:11:41.584550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81DA3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81E88FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A81E45190>]}
[0m16:11:41.584550 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:12:19.303903 | 095668a7-a00e-4e0c-a6bc-fbe95c4d37dd ==============================
[0m16:12:19.303903 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:12:19.306902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m16:12:19.307955 [debug] [MainThread]: Tracking: tracking
[0m16:12:19.308077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFCF56BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFCF56F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFCF56E50>]}
[0m16:12:19.513051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:19.513904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:19.520904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '095668a7-a00e-4e0c-a6bc-fbe95c4d37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFD086FA0>]}
[0m16:12:19.532063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '095668a7-a00e-4e0c-a6bc-fbe95c4d37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFD051250>]}
[0m16:12:19.532905 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:12:19.533908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095668a7-a00e-4e0c-a6bc-fbe95c4d37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFD051490>]}
[0m16:12:19.534907 [info ] [MainThread]: 
[0m16:12:19.537917 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:12:19.540905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:12:19.557905 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:12:19.557905 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:12:19.558903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:20.205259 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:12:20.207300 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:12:20.330261 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:12:20.339297 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:12:20.340185 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:12:20.340259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:20.791920 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m16:12:20.793959 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:12:20.896048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095668a7-a00e-4e0c-a6bc-fbe95c4d37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFD051040>]}
[0m16:12:20.897050 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:12:20.899049 [info ] [MainThread]: 
[0m16:12:20.907161 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:12:20.908048 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:12:20.910051 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:12:20.911049 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:12:20.925050 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:12:20.928049 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:12:20.911049 => 2023-04-19 16:12:20.928049
[0m16:12:20.928049 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:12:20.964048 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:12:20.965052 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:12:20.965286 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:12:21.594785 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:12:21.597826 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m16:12:21.613781 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:12:21.614780 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m16:12:21.682817 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m16:12:21.684818 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:12:21.687780 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:12:21.688784 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:12:21.785905 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:12:21.786906 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:12:21.788910 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m16:12:22.105512 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:12:22.107512 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:12:22.108514 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:12:22.170400 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:12:22.170682 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:12:22.171601 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m16:12:22.997468 [debug] [Thread-1  ]: SQL status: SUCCESS 30 in 1 seconds
[0m16:12:22.999144 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:12:23.001148 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:12:23.096780 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:12:23.100770 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:12:20.929049 => 2023-04-19 16:12:23.100770
[0m16:12:23.101731 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:12:23.195144 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '095668a7-a00e-4e0c-a6bc-fbe95c4d37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFD404250>]}
[0m16:12:23.196469 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.29s]
[0m16:12:23.199687 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:12:23.201688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:12:23.202687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:23.203828 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:12:23.203936 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:12:23.204715 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:12:23.204715 [info ] [MainThread]: 
[0m16:12:23.206122 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m16:12:23.206686 [debug] [MainThread]: Command end result
[0m16:12:23.219460 [info ] [MainThread]: 
[0m16:12:23.220506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:23.222458 [info ] [MainThread]: 
[0m16:12:23.223458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:12:23.224459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFD0758E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFCF64B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BFD0512B0>]}
[0m16:12:23.225466 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:13:03.915453 | 31551782-4331-49d0-8952-370ff8ab49ba ==============================
[0m16:13:03.915453 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:13:03.917415 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:13:03.918457 [debug] [MainThread]: Tracking: tracking
[0m16:13:03.918457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A8446CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A8446F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A8446F40>]}
[0m16:13:04.104133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:04.104451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:04.117456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31551782-4331-49d0-8952-370ff8ab49ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A85750D0>]}
[0m16:13:04.129452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31551782-4331-49d0-8952-370ff8ab49ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A84F0310>]}
[0m16:13:04.130451 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:13:04.131453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31551782-4331-49d0-8952-370ff8ab49ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A84F0550>]}
[0m16:13:04.132457 [info ] [MainThread]: 
[0m16:13:04.135453 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:04.137454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:13:04.156486 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:13:04.157545 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:13:04.157545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:04.873560 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:13:04.875706 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:13:04.974218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:13:04.983378 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:13:04.984244 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:13:04.984244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:05.548091 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m16:13:05.554091 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:13:05.667831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31551782-4331-49d0-8952-370ff8ab49ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A84F0160>]}
[0m16:13:05.669665 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:13:05.671668 [info ] [MainThread]: 
[0m16:13:05.681667 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:13:05.682664 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:13:05.684667 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:13:05.685665 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:13:05.694701 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:13:05.696666 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:13:05.685665 => 2023-04-19 16:13:05.696666
[0m16:13:05.696666 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:13:05.735702 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:05.736668 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:13:05.736668 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:13:06.120023 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:06.123013 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:13:06.123982 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:13:06.125985 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:13:06.129986 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:06.130981 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m16:13:06.240149 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:06.240149 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:06.241150 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m16:13:06.329861 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:06.329861 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:06.331091 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:13:06.507532 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:06.508104 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:06.509057 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m16:13:06.702124 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:06.703122 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:06.704125 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:13:07.702594 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:13:07.703599 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:07.703599 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:13:07.835599 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:07.835599 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:07.836607 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:13:08.068598 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:08.071599 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:13:05.697702 => 2023-04-19 16:13:08.071599
[0m16:13:08.072597 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:13:08.405825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31551782-4331-49d0-8952-370ff8ab49ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A88D8B50>]}
[0m16:13:08.406708 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.72s]
[0m16:13:08.410461 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:13:08.414457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:08.415458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:08.416461 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:13:08.417504 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:13:08.418499 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:13:08.419558 [info ] [MainThread]: 
[0m16:13:08.420465 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m16:13:08.422460 [debug] [MainThread]: Command end result
[0m16:13:08.441459 [info ] [MainThread]: 
[0m16:13:08.443462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:08.445462 [info ] [MainThread]: 
[0m16:13:08.446462 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:08.448500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A8455AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A84F0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6A895DE80>]}
[0m16:13:08.449565 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:13:16.243711 | 3fb92fb5-0f8a-4652-a4e2-72c240c3dc96 ==============================
[0m16:13:16.243711 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:13:16.246680 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m16:13:16.246680 [debug] [MainThread]: Tracking: tracking
[0m16:13:16.247683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595AF17C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595AF17F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595AF17EE0>]}
[0m16:13:16.406770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:16.407805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:16.417774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fb92fb5-0f8a-4652-a4e2-72c240c3dc96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595B0440D0>]}
[0m16:13:16.433197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fb92fb5-0f8a-4652-a4e2-72c240c3dc96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595AFC02B0>]}
[0m16:13:16.435599 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:13:16.437200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb92fb5-0f8a-4652-a4e2-72c240c3dc96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595AFC04F0>]}
[0m16:13:16.440200 [info ] [MainThread]: 
[0m16:13:16.443197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:16.445198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:13:16.469237 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:13:16.469237 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:13:16.470199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:17.145779 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:13:17.149660 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:13:17.268149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:13:17.293124 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:13:17.294089 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:13:17.294389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:17.737190 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:17.739102 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:13:17.845171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb92fb5-0f8a-4652-a4e2-72c240c3dc96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595AFC0190>]}
[0m16:13:17.847222 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:13:17.850099 [info ] [MainThread]: 
[0m16:13:17.863098 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:13:17.864331 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:13:17.866099 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:13:17.866099 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:13:17.881383 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:13:17.883097 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:13:17.867399 => 2023-04-19 16:13:17.883097
[0m16:13:17.884097 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:13:17.923384 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:17.923384 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:13:17.924418 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:13:18.363284 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:18.365281 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:13:18.366280 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:13:18.368280 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:13:18.372282 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:18.372282 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:13:18.476287 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:18.477284 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:18.478284 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m16:13:18.674283 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:18.675284 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:18.675865 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:13:18.745411 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:18.746256 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:18.747376 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:13:18.797967 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:18.797967 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:18.798941 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:13:18.977565 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:18.979437 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:13:17.884097 => 2023-04-19 16:13:18.979437
[0m16:13:18.980561 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:13:19.115465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb92fb5-0f8a-4652-a4e2-72c240c3dc96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595B3BEDC0>]}
[0m16:13:19.116333 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.25s]
[0m16:13:19.119122 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:13:19.122123 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:19.123120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:19.124543 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:13:19.124543 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:13:19.125055 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:13:19.125055 [info ] [MainThread]: 
[0m16:13:19.126156 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m16:13:19.128067 [debug] [MainThread]: Command end result
[0m16:13:19.144068 [info ] [MainThread]: 
[0m16:13:19.145063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:19.147154 [info ] [MainThread]: 
[0m16:13:19.149066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:19.150065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595AF239A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595B008FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595AFC0190>]}
[0m16:13:19.150065 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:13:40.625885 | 0c7e6273-73dd-414d-addd-da8a59dd5ca5 ==============================
[0m16:13:40.625885 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:13:40.628886 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m16:13:40.629886 [debug] [MainThread]: Tracking: tracking
[0m16:13:40.630893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0407C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0407F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0407E80>]}
[0m16:13:40.828244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:40.829111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:40.841108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c7e6273-73dd-414d-addd-da8a59dd5ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0534FD0>]}
[0m16:13:40.854575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c7e6273-73dd-414d-addd-da8a59dd5ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0492250>]}
[0m16:13:40.855112 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:13:40.856108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7e6273-73dd-414d-addd-da8a59dd5ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0492490>]}
[0m16:13:40.857111 [info ] [MainThread]: 
[0m16:13:40.859111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:40.861113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:13:40.878109 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:13:40.879108 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:13:40.880110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:41.546846 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:13:41.548845 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:13:41.692746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:13:41.717745 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:13:41.719284 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:13:41.719767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:42.258237 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m16:13:42.262193 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:13:42.365562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7e6273-73dd-414d-addd-da8a59dd5ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0492130>]}
[0m16:13:42.368009 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:13:42.370007 [info ] [MainThread]: 
[0m16:13:42.385011 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:13:42.386003 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:13:42.388013 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:13:42.388013 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:13:42.397012 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:13:42.399004 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:13:42.389009 => 2023-04-19 16:13:42.399004
[0m16:13:42.400006 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:13:42.436042 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:42.437045 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:13:42.437045 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:13:42.749518 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:42.751745 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:13:42.752468 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:13:42.754470 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:13:42.757471 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:42.758467 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:13:42.859636 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:42.860503 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:42.861505 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m16:13:43.057509 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:43.057509 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:43.058630 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:13:43.165376 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:43.167002 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:43.167101 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:13:43.226227 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:43.227222 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:43.228178 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:13:43.330743 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:43.333743 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:13:42.400006 => 2023-04-19 16:13:43.333743
[0m16:13:43.334743 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:13:43.430780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7e6273-73dd-414d-addd-da8a59dd5ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F08B4250>]}
[0m16:13:43.431781 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.04s]
[0m16:13:43.436784 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:13:43.438782 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:43.440043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:43.440784 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:13:43.440784 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:13:43.441782 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:13:43.441782 [info ] [MainThread]: 
[0m16:13:43.442782 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m16:13:43.443782 [debug] [MainThread]: Command end result
[0m16:13:43.455811 [info ] [MainThread]: 
[0m16:13:43.456893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:43.458872 [info ] [MainThread]: 
[0m16:13:43.459782 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:43.460783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0422A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F04F8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296F0492130>]}
[0m16:13:43.462061 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:13:50.884337 | ed7c105f-e0fb-4576-8c93-83cf6f9eca64 ==============================
[0m16:13:50.884337 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:13:50.887336 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:13:50.888344 [debug] [MainThread]: Tracking: tracking
[0m16:13:50.888344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1DD5C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1DD5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1DD5EE0>]}
[0m16:13:51.114565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:51.114565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:51.121564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed7c105f-e0fb-4576-8c93-83cf6f9eca64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1F050D0>]}
[0m16:13:51.134565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed7c105f-e0fb-4576-8c93-83cf6f9eca64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1E852B0>]}
[0m16:13:51.135571 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:13:51.136566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed7c105f-e0fb-4576-8c93-83cf6f9eca64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1E854F0>]}
[0m16:13:51.137566 [info ] [MainThread]: 
[0m16:13:51.140570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:51.142565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:13:51.169567 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:13:51.170609 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:13:51.171567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:52.429401 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:13:52.431401 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:13:52.540402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:13:52.547401 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:13:52.548400 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:13:52.549059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:52.954554 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:52.956555 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:13:53.120117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed7c105f-e0fb-4576-8c93-83cf6f9eca64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1E85190>]}
[0m16:13:53.121084 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:13:53.123086 [info ] [MainThread]: 
[0m16:13:53.133086 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:13:53.134087 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:13:53.136124 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:13:53.136124 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:13:53.147085 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:13:53.149086 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:13:53.137087 => 2023-04-19 16:13:53.149086
[0m16:13:53.149086 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:13:53.187091 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:53.188088 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:13:53.188088 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:13:53.904613 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:13:53.906606 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:13:53.907609 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:13:53.909610 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:13:53.913607 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:53.913607 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m16:13:54.250337 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:54.252341 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:54.254306 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m16:13:54.338623 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:54.338623 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:54.339706 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:13:54.501425 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:54.501425 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:54.502424 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m16:13:54.691463 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:54.692468 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:54.692468 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:13:55.313633 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:13:55.314590 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:55.314590 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:13:55.374589 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:55.375589 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:13:55.375589 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:13:55.582601 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:13:55.584838 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:13:53.150086 => 2023-04-19 16:13:55.584838
[0m16:13:55.585593 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:13:55.940946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed7c105f-e0fb-4576-8c93-83cf6f9eca64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD227FDC0>]}
[0m16:13:55.941948 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.81s]
[0m16:13:55.944952 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:13:55.947118 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:55.948124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:55.948952 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:13:55.948952 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:13:55.949970 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:13:55.949970 [info ] [MainThread]: 
[0m16:13:55.951970 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m16:13:55.953948 [debug] [MainThread]: Command end result
[0m16:13:55.968956 [info ] [MainThread]: 
[0m16:13:55.969954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:55.972549 [info ] [MainThread]: 
[0m16:13:55.974119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:55.976068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1DE4D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1EC8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDD1E85190>]}
[0m16:13:55.976948 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:14:04.152112 | 1ac80061-c96a-43ae-8625-36d6c815315d ==============================
[0m16:14:04.152112 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:14:04.154927 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m16:14:04.155927 [debug] [MainThread]: Tracking: tracking
[0m16:14:04.156937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413E47C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413E47F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413E47E80>]}
[0m16:14:04.341612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:04.341612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:04.355601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac80061-c96a-43ae-8625-36d6c815315d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413F75FD0>]}
[0m16:14:04.370600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac80061-c96a-43ae-8625-36d6c815315d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413F42250>]}
[0m16:14:04.371602 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:14:04.372680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac80061-c96a-43ae-8625-36d6c815315d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413F42490>]}
[0m16:14:04.373610 [info ] [MainThread]: 
[0m16:14:04.376668 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:14:04.378633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:14:04.397132 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:14:04.399144 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:14:04.400130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:05.514152 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:14:05.515983 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:14:05.722033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:14:05.732032 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:14:05.733079 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:14:05.733079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:06.218905 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:06.221113 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:14:06.336798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac80061-c96a-43ae-8625-36d6c815315d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413F42130>]}
[0m16:14:06.337839 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:14:06.339798 [info ] [MainThread]: 
[0m16:14:06.349952 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:14:06.350792 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:14:06.353796 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:14:06.353796 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:14:06.369830 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:14:06.371796 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:14:06.354793 => 2023-04-19 16:14:06.371796
[0m16:14:06.371796 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:14:06.405792 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:06.406979 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:14:06.407795 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:14:06.782540 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:06.786537 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m16:14:06.789549 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:14:06.791546 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:14:06.797582 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:06.798584 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:14:06.951547 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:06.951547 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:06.952543 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m16:14:07.308938 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:07.308938 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:07.309937 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:14:07.405663 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:07.406510 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:07.406665 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:14:07.463905 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:07.465875 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:07.466877 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m16:14:07.570309 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:07.573281 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:14:06.372796 => 2023-04-19 16:14:07.573281
[0m16:14:07.574276 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:14:07.752831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac80061-c96a-43ae-8625-36d6c815315d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214142F4250>]}
[0m16:14:07.753802 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.40s]
[0m16:14:07.757831 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:14:07.760801 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:14:07.761801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:07.762811 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:14:07.762811 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:14:07.762811 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:14:07.763804 [info ] [MainThread]: 
[0m16:14:07.764830 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m16:14:07.765803 [debug] [MainThread]: Command end result
[0m16:14:07.777800 [info ] [MainThread]: 
[0m16:14:07.778811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:07.780966 [info ] [MainThread]: 
[0m16:14:07.781800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:14:07.782829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413E62A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413F38F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021413F42130>]}
[0m16:14:07.783802 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:14:43.474300 | 8b6425de-73d3-4fa0-964b-b0ad5008b7b5 ==============================
[0m16:14:43.474300 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:14:43.477292 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m16:14:43.478565 [debug] [MainThread]: Tracking: tracking
[0m16:14:43.478565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F81E7C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F81E7F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F81E7EE0>]}
[0m16:14:43.685352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:43.686357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:43.697377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b6425de-73d3-4fa0-964b-b0ad5008b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F83130D0>]}
[0m16:14:43.709350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b6425de-73d3-4fa0-964b-b0ad5008b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F82902B0>]}
[0m16:14:43.710356 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:14:43.711349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b6425de-73d3-4fa0-964b-b0ad5008b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F82904F0>]}
[0m16:14:43.712392 [info ] [MainThread]: 
[0m16:14:43.714349 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:14:43.716347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:14:43.736238 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:14:43.736348 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:14:43.737655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:44.633357 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:14:44.638311 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:14:44.857477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:14:44.866477 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:14:44.866477 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:14:44.867475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:45.729886 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m16:14:45.733884 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:14:45.923783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b6425de-73d3-4fa0-964b-b0ad5008b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F8290190>]}
[0m16:14:45.924820 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:14:45.927261 [info ] [MainThread]: 
[0m16:14:45.936786 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:14:45.936786 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:14:45.939788 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:14:45.940786 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:14:45.950820 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:14:45.952880 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:14:45.941788 => 2023-04-19 16:14:45.952880
[0m16:14:45.952880 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:14:46.019786 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:46.020819 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:14:46.020819 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:14:46.883161 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:14:46.885159 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m16:14:46.898469 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:46.899158 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m16:14:47.097191 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbc0e-3201-bafa-0001-2d160036baee
[0m16:14:47.098193 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'PERSO.ARO_DWH.V_CONSO_CLIENT' does not exist or not authorized.
[0m16:14:47.100203 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m16:14:47.100203 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
[0m16:14:47.103212 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:14:47.108193 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:47.109192 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m16:14:47.296273 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:47.297338 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:47.298270 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m16:14:47.536289 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:47.537256 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:47.537256 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m16:14:47.701600 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:14:47.702604 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:14:47.702604 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    )
    VALUES
    (
    )
    ;
[0m16:14:47.775634 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abbc0e-3201-bafa-0001-2d160036baf2
[0m16:14:47.776597 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 9 unexpected 'NOT'.
syntax error line 10 at position 21 unexpected 'THEN'.
[0m16:14:47.777599 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:14:45.953783 => 2023-04-19 16:14:47.777599
[0m16:14:47.777599 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:14:47.984777 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected 'NOT'.
  syntax error line 10 at position 21 unexpected 'THEN'.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m16:14:47.985781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b6425de-73d3-4fa0-964b-b0ad5008b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F868EDC0>]}
[0m16:14:47.986992 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 2.05s]
[0m16:14:47.988779 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:14:47.991788 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:14:47.992847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:47.992847 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:14:47.993907 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:14:47.993907 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:14:47.994777 [info ] [MainThread]: 
[0m16:14:47.995792 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m16:14:47.996778 [debug] [MainThread]: Command end result
[0m16:14:48.010031 [info ] [MainThread]: 
[0m16:14:48.010776 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:14:48.012871 [info ] [MainThread]: 
[0m16:14:48.013777 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m16:14:48.015777 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m16:14:48.015777 [error] [MainThread]:   syntax error line 10 at position 9 unexpected 'NOT'.
[0m16:14:48.016777 [error] [MainThread]:   syntax error line 10 at position 21 unexpected 'THEN'.
[0m16:14:48.017777 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m16:14:48.018778 [info ] [MainThread]: 
[0m16:14:48.019778 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:14:48.021895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F81F29A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F82D8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144F8290190>]}
[0m16:14:48.022825 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:27:27.962884 | 59a845a7-ec9a-4532-ae5a-a09e0495de71 ==============================
[0m16:27:27.962884 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:27:27.964885 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:27:27.964885 [debug] [MainThread]: Tracking: tracking
[0m16:27:27.965885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189BF567C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189BF567F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189BF567EE0>]}
[0m16:27:28.114495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:27:28.115734 [debug] [MainThread]: Partial parsing: updated file: incr_stream://macros\materializations\incremental_stream.sql
[0m16:27:28.128519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189BF60D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189BF677D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189BF677DF0>]}
[0m16:27:28.129535 [debug] [MainThread]: Flushing usage events
[0m16:27:28.546768 [error] [MainThread]: Encountered an error:
Compilation Error
  Encountered unknown tag 'endmaterialization'. You probably made a nesting mistake. Jinja is expecting this tag, but currently looking for 'endif'. The innermost block that needs to be closed is 'if'.
    line 77
      {%- endmaterialization %}


============================== 2023-04-19 16:28:28.893063 | f31de132-186b-4793-b40e-e0b80092be33 ==============================
[0m16:28:28.893063 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:28:28.895062 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:28:28.896063 [debug] [MainThread]: Tracking: tracking
[0m16:28:28.897062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023779596C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023779596F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023779596EB0>]}
[0m16:28:29.079065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:29.080074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:29.089064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f31de132-186b-4793-b40e-e0b80092be33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237796C50D0>]}
[0m16:28:29.101111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f31de132-186b-4793-b40e-e0b80092be33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023779691280>]}
[0m16:28:29.102067 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:28:29.103126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31de132-186b-4793-b40e-e0b80092be33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237796914C0>]}
[0m16:28:29.105069 [info ] [MainThread]: 
[0m16:28:29.109067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:28:29.111216 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:28:29.131110 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:28:29.132451 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:28:29.133103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:29.849710 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:28:29.851710 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:28:29.958084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:28:29.968084 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:28:29.969085 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:28:29.970216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:30.641458 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m16:28:30.648497 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:28:30.957291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31de132-186b-4793-b40e-e0b80092be33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023779691040>]}
[0m16:28:30.959303 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:28:30.960296 [info ] [MainThread]: 
[0m16:28:30.969069 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:28:30.969797 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:28:30.971799 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:28:30.971799 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:28:30.980797 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:28:30.982317 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:28:30.972797 => 2023-04-19 16:28:30.982317
[0m16:28:30.982799 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:28:31.039811 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:28:31.040798 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:28:31.041797 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:28:32.506978 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:28:32.509704 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m16:28:32.511669 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:28:32.512702 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:28:32.514670 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:28:32.514670 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:28:32.821308 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:28:32.825300 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:28:30.982799 => 2023-04-19 16:28:32.825300
[0m16:28:32.826332 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:28:33.056215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f31de132-186b-4793-b40e-e0b80092be33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023779AC58E0>]}
[0m16:28:33.058211 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.09s]
[0m16:28:33.063247 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:28:33.066213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:28:33.068215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:33.069250 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:28:33.069608 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:28:33.069608 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:28:33.070676 [info ] [MainThread]: 
[0m16:28:33.071617 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m16:28:33.073650 [debug] [MainThread]: Command end result
[0m16:28:33.085616 [info ] [MainThread]: 
[0m16:28:33.086620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:33.088621 [info ] [MainThread]: 
[0m16:28:33.089617 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:28:33.090618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237795B2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023779691040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023779AA6FD0>]}
[0m16:28:33.091619 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:30:05.432973 | 23d60b57-7913-46c1-8725-513de2ab47bf ==============================
[0m16:30:05.432973 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:30:05.435935 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:30:05.435935 [debug] [MainThread]: Tracking: tracking
[0m16:30:05.436939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F156C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F156F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F156EE0>]}
[0m16:30:05.603185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:05.603185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:05.610190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23d60b57-7913-46c1-8725-513de2ab47bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F2860D0>]}
[0m16:30:05.625217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23d60b57-7913-46c1-8725-513de2ab47bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F2002B0>]}
[0m16:30:05.626311 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:30:05.628187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d60b57-7913-46c1-8725-513de2ab47bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F2004F0>]}
[0m16:30:05.629229 [info ] [MainThread]: 
[0m16:30:05.632670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:30:05.634188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:30:05.668110 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:30:05.668110 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:30:05.669661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:07.222337 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m16:30:07.225336 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:30:07.329565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:30:07.348552 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:30:07.349583 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:30:07.349583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:07.856483 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m16:30:07.858525 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:30:07.957171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d60b57-7913-46c1-8725-513de2ab47bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F200250>]}
[0m16:30:07.958166 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:30:07.959131 [info ] [MainThread]: 
[0m16:30:07.967134 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:30:07.968130 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:30:07.969132 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:30:07.970133 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:30:07.979132 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:30:07.980157 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:30:07.970133 => 2023-04-19 16:30:07.980157
[0m16:30:07.981736 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:30:08.010158 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:30:08.012129 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:30:08.012129 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:30:09.263584 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:30:09.266575 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m16:30:09.267575 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:30:09.269576 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:30:09.271022 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:30:09.271631 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:30:09.480453 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:30:09.482471 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:30:07.982129 => 2023-04-19 16:30:09.482471
[0m16:30:09.482608 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:30:10.206585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23d60b57-7913-46c1-8725-513de2ab47bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F684910>]}
[0m16:30:10.207585 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.24s]
[0m16:30:10.215765 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:30:10.220795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:30:10.222796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:10.223796 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:30:10.224796 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:30:10.225260 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:30:10.225794 [info ] [MainThread]: 
[0m16:30:10.227759 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m16:30:10.230763 [debug] [MainThread]: Command end result
[0m16:30:10.243791 [info ] [MainThread]: 
[0m16:30:10.245758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:10.247755 [info ] [MainThread]: 
[0m16:30:10.250756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:30:10.251754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F1650D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F200190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116F200250>]}
[0m16:30:10.251754 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:31:25.421091 | 981140cf-748d-4b64-8012-e5dd07d438d9 ==============================
[0m16:31:25.421091 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:31:25.423053 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:31:25.424052 [debug] [MainThread]: Tracking: tracking
[0m16:31:25.424273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C106C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C106F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C106E80>]}
[0m16:31:25.579201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:25.579201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:25.587201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '981140cf-748d-4b64-8012-e5dd07d438d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C235FD0>]}
[0m16:31:25.598204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '981140cf-748d-4b64-8012-e5dd07d438d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C192250>]}
[0m16:31:25.599484 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:31:25.600206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '981140cf-748d-4b64-8012-e5dd07d438d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C192490>]}
[0m16:31:25.602251 [info ] [MainThread]: 
[0m16:31:25.605571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:25.607206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:31:25.647392 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:31:25.648484 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:31:25.649383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:26.286915 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:31:26.290922 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:31:26.405060 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:31:26.422053 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:31:26.423107 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:31:26.423107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:26.910971 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m16:31:26.917973 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:31:27.024162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '981140cf-748d-4b64-8012-e5dd07d438d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C2FB190>]}
[0m16:31:27.025176 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:31:27.026155 [info ] [MainThread]: 
[0m16:31:27.033265 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:31:27.034126 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:31:27.036127 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:31:27.036127 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:31:27.046175 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:31:27.047562 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:31:27.037125 => 2023-04-19 16:31:27.047562
[0m16:31:27.048175 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:31:27.077303 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:31:27.078663 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:31:27.079127 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:31:27.380189 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:31:27.386189 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m16:31:27.389190 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:31:27.393189 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:31:27.395185 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:31:27.396373 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:31:27.484189 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:31:27.486199 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:31:27.048175 => 2023-04-19 16:31:27.486199
[0m16:31:27.486928 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:31:27.676265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '981140cf-748d-4b64-8012-e5dd07d438d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C648EE0>]}
[0m16:31:27.677266 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 0.64s]
[0m16:31:27.680303 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:31:27.682265 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:27.683264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:27.683264 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:31:27.683264 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:31:27.684491 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:31:27.685265 [info ] [MainThread]: 
[0m16:31:27.686299 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m16:31:27.687264 [debug] [MainThread]: Command end result
[0m16:31:27.701269 [info ] [MainThread]: 
[0m16:31:27.702267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:27.704268 [info ] [MainThread]: 
[0m16:31:27.705265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:31:27.706267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C601970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C1921C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82C5DAA30>]}
[0m16:31:27.707302 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 16:33:11.809789 | d193cff4-cdbb-4d79-8270-803a7dbdf0c9 ==============================
[0m16:33:11.809789 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:33:11.812753 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m16:33:11.812753 [debug] [MainThread]: Tracking: tracking
[0m16:33:11.813754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B1D7C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B1D7F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B1D7EE0>]}
[0m16:33:11.998755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:11.998755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:12.007757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd193cff4-cdbb-4d79-8270-803a7dbdf0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B3040D0>]}
[0m16:33:12.021758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd193cff4-cdbb-4d79-8270-803a7dbdf0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B2802B0>]}
[0m16:33:12.021758 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:33:12.023765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd193cff4-cdbb-4d79-8270-803a7dbdf0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B2804F0>]}
[0m16:33:12.025790 [info ] [MainThread]: 
[0m16:33:12.028755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:12.030772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m16:33:12.048791 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m16:33:12.049793 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m16:33:12.049793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:13.033409 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m16:33:13.035409 [debug] [ThreadPool]: On list_PERSO: Close
[0m16:33:13.143590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m16:33:13.151630 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m16:33:13.151630 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m16:33:13.152799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:13.413793 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m16:33:13.419737 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m16:33:13.520766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd193cff4-cdbb-4d79-8270-803a7dbdf0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B280070>]}
[0m16:33:13.521769 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m16:33:13.523735 [info ] [MainThread]: 
[0m16:33:13.533773 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m16:33:13.534734 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m16:33:13.536736 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m16:33:13.536736 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m16:33:13.546738 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m16:33:13.547757 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 16:33:13.537737 => 2023-04-19 16:33:13.547757
[0m16:33:13.548735 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m16:33:13.577738 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:33:13.578737 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m16:33:13.578737 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:33:14.238054 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m16:33:14.245079 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m16:33:14.247050 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m16:33:14.248052 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m16:33:14.250317 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m16:33:14.250317 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m16:33:14.323057 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m16:33:14.325051 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 16:33:13.548735 => 2023-04-19 16:33:14.325051
[0m16:33:14.325051 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m16:33:14.434049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd193cff4-cdbb-4d79-8270-803a7dbdf0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B717A60>]}
[0m16:33:14.436057 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 0.90s]
[0m16:33:14.441222 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m16:33:14.464601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:14.466447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:14.466447 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m16:33:14.467449 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m16:33:14.468469 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m16:33:14.469447 [info ] [MainThread]: 
[0m16:33:14.471528 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m16:33:14.473451 [debug] [MainThread]: Command end result
[0m16:33:14.487259 [info ] [MainThread]: 
[0m16:33:14.488221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:14.490217 [info ] [MainThread]: 
[0m16:33:14.492230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:33:14.494221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B1E40D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B280190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885B280070>]}
[0m16:33:14.494221 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 20:34:13.936008 | 85f0815c-9948-4d86-bebd-70240e3194e0 ==============================
[0m20:34:13.936008 [info ] [MainThread]: Running with dbt=1.4.1
[0m20:34:13.938871 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m20:34:13.939905 [debug] [MainThread]: Tracking: tracking
[0m20:34:13.939905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F71767CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F71767F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F71767F10>]}
[0m20:34:14.158050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:34:14.160051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:34:14.181583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85f0815c-9948-4d86-bebd-70240e3194e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F718950D0>]}
[0m20:34:14.201587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85f0815c-9948-4d86-bebd-70240e3194e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F7180D2E0>]}
[0m20:34:14.203588 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:34:14.204585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f0815c-9948-4d86-bebd-70240e3194e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F7180D520>]}
[0m20:34:14.206586 [info ] [MainThread]: 
[0m20:34:14.210167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:34:14.212586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m20:34:14.251591 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m20:34:14.253591 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m20:34:14.255626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:15.353449 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m20:34:15.362439 [debug] [ThreadPool]: On list_PERSO: Close
[0m20:34:15.481369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m20:34:15.506330 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m20:34:15.508396 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m20:34:15.509358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:15.853416 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m20:34:15.856415 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m20:34:15.975805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f0815c-9948-4d86-bebd-70240e3194e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F7180D130>]}
[0m20:34:15.977859 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m20:34:15.979860 [info ] [MainThread]: 
[0m20:34:15.991963 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m20:34:15.993131 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m20:34:15.996335 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m20:34:15.997863 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m20:34:16.010908 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m20:34:16.013906 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 20:34:15.998863 => 2023-04-19 20:34:16.013906
[0m20:34:16.014907 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m20:34:16.059978 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:34:16.060974 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m20:34:16.061169 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:34:16.724078 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:34:16.730376 [info ] [Thread-1  ]:   => 30 record(s) to merge
[0m20:34:16.733374 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m20:34:16.737375 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m20:34:16.746374 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:34:16.748374 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m20:34:16.854383 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:34:16.855837 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:34:16.856383 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m20:34:16.967485 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:34:16.968484 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:34:16.969484 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m20:34:17.183142 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:34:17.184142 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:34:17.185142 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m20:34:17.452061 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:34:17.454061 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:34:17.455062 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m20:34:18.718276 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:34:18.720276 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:34:18.722275 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m20:34:18.786890 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:34:18.787892 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:34:18.789890 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP VIEW PERSO.ARO_DWH.V_conso_client;
[0m20:34:18.892476 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:34:18.898489 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 20:34:16.015809 => 2023-04-19 20:34:18.898489
[0m20:34:18.900479 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m20:34:19.018462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85f0815c-9948-4d86-bebd-70240e3194e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F71C90A90>]}
[0m20:34:19.022459 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 3.02s]
[0m20:34:19.033463 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m20:34:19.044467 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:34:19.049466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:19.052878 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m20:34:19.055953 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m20:34:19.058015 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m20:34:19.061207 [info ] [MainThread]: 
[0m20:34:19.065560 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m20:34:19.072558 [debug] [MainThread]: Command end result
[0m20:34:19.119883 [info ] [MainThread]: 
[0m20:34:19.123891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:34:19.130938 [info ] [MainThread]: 
[0m20:34:19.134889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:34:19.137884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F71774130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F7180D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F7180D070>]}
[0m20:34:19.141086 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 20:39:11.523403 | d7d22224-e60c-4f0b-a7df-c27dccb04ce0 ==============================
[0m20:39:11.523403 [info ] [MainThread]: Running with dbt=1.4.1
[0m20:39:11.525533 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m20:39:11.527528 [debug] [MainThread]: Tracking: tracking
[0m20:39:11.528403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5AE6C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5AE6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5AE6EE0>]}
[0m20:39:11.724607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:11.724607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:11.733606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7d22224-e60c-4f0b-a7df-c27dccb04ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5C140D0>]}
[0m20:39:11.746708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7d22224-e60c-4f0b-a7df-c27dccb04ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5B952B0>]}
[0m20:39:11.747610 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:39:11.748652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7d22224-e60c-4f0b-a7df-c27dccb04ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5B954F0>]}
[0m20:39:11.750752 [info ] [MainThread]: 
[0m20:39:11.753608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:39:11.756608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m20:39:11.780792 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m20:39:11.781612 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m20:39:11.782611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:12.816488 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m20:39:12.825788 [debug] [ThreadPool]: On list_PERSO: Close
[0m20:39:12.945552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m20:39:12.977509 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m20:39:12.980503 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m20:39:12.982662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:13.395888 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0 seconds
[0m20:39:13.402917 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m20:39:13.514368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7d22224-e60c-4f0b-a7df-c27dccb04ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5B95190>]}
[0m20:39:13.518421 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m20:39:13.523406 [info ] [MainThread]: 
[0m20:39:13.551401 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m20:39:13.555406 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m20:39:13.561400 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m20:39:13.564405 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m20:39:13.607599 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m20:39:13.614062 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 20:39:13.566406 => 2023-04-19 20:39:13.613059
[0m20:39:13.616115 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m20:39:13.788088 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:39:13.789994 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m20:39:13.792038 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:39:14.972328 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:39:14.980326 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m20:39:14.984332 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m20:39:14.989342 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m20:39:14.999354 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:39:15.001329 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m20:39:15.156797 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:39:15.159797 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:39:15.162832 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m20:39:15.340421 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:39:15.341421 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:39:15.343381 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m20:39:15.490390 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:39:15.494390 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:39:15.497401 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m20:39:15.825454 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:39:15.825454 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:39:15.826454 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m20:39:16.475777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:39:16.477753 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:39:16.479822 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m20:39:16.634709 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:39:16.642979 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 20:39:13.617092 => 2023-04-19 20:39:16.641696
[0m20:39:16.645060 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m20:39:16.949794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d22224-e60c-4f0b-a7df-c27dccb04ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5F8FDC0>]}
[0m20:39:16.952778 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 3.39s]
[0m20:39:16.966784 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m20:39:16.975779 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:39:16.978972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:16.980783 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m20:39:16.983782 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m20:39:16.985796 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m20:39:16.989996 [info ] [MainThread]: 
[0m20:39:16.993780 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m20:39:16.998782 [debug] [MainThread]: Command end result
[0m20:39:17.058256 [info ] [MainThread]: 
[0m20:39:17.063255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:17.080252 [info ] [MainThread]: 
[0m20:39:17.089075 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:39:17.093278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5AF39A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5BD8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF5B95190>]}
[0m20:39:17.096153 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 20:40:28.985902 | 7baa2e4f-b3c5-4160-90a0-95c8c30024c9 ==============================
[0m20:40:28.985902 [info ] [MainThread]: Running with dbt=1.4.1
[0m20:40:28.987904 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m20:40:28.988904 [debug] [MainThread]: Tracking: tracking
[0m20:40:28.989902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FE67C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FE67F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FE67EB0>]}
[0m20:40:29.231392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:40:29.232393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:40:29.242413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7baa2e4f-b3c5-4160-90a0-95c8c30024c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FF950D0>]}
[0m20:40:29.254414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7baa2e4f-b3c5-4160-90a0-95c8c30024c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FF61280>]}
[0m20:40:29.255415 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:40:29.256412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7baa2e4f-b3c5-4160-90a0-95c8c30024c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FF614C0>]}
[0m20:40:29.258419 [info ] [MainThread]: 
[0m20:40:29.262415 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:40:29.265417 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m20:40:29.289417 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m20:40:29.290417 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m20:40:29.291414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:30.098584 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m20:40:30.106090 [debug] [ThreadPool]: On list_PERSO: Close
[0m20:40:30.225965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m20:40:30.253341 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m20:40:30.255301 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m20:40:30.256361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:30.615982 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m20:40:30.626982 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m20:40:30.750432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7baa2e4f-b3c5-4160-90a0-95c8c30024c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FF61160>]}
[0m20:40:30.752937 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m20:40:30.757946 [info ] [MainThread]: 
[0m20:40:30.787950 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m20:40:30.790942 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m20:40:30.796954 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m20:40:30.798956 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m20:40:30.847926 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m20:40:30.854590 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 20:40:30.801344 => 2023-04-19 20:40:30.853579
[0m20:40:30.857583 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m20:40:30.968769 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:40:30.970631 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m20:40:30.971638 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:40:31.629128 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:40:31.635143 [info ] [Thread-1  ]:   => 60 record(s) to merge
[0m20:40:31.672685 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:40:31.673804 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m20:40:31.763286 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m20:40:31.769290 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m20:40:31.776294 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:40:31.777293 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m20:40:31.932884 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:40:31.934522 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:40:31.936770 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m20:40:32.123113 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:40:32.124107 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:40:32.146973 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m20:40:32.219937 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:40:32.220936 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:40:32.221937 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET 
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m20:40:33.422363 [debug] [Thread-1  ]: SQL status: SUCCESS 60 in 1 seconds
[0m20:40:33.427364 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 20:40:30.859580 => 2023-04-19 20:40:33.426365
[0m20:40:33.428364 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m20:40:33.543142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7baa2e4f-b3c5-4160-90a0-95c8c30024c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB0035FD90>]}
[0m20:40:33.545711 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 60[0m in 2.75s]
[0m20:40:33.553900 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m20:40:33.560758 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:40:33.563753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:33.564750 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m20:40:33.566714 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m20:40:33.567714 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m20:40:33.569711 [info ] [MainThread]: 
[0m20:40:33.573703 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m20:40:33.576710 [debug] [MainThread]: Command end result
[0m20:40:33.610961 [info ] [MainThread]: 
[0m20:40:33.614709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:33.619711 [info ] [MainThread]: 
[0m20:40:33.622928 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:40:33.626714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FE82CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FF58F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7FF61160>]}
[0m20:40:33.628710 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 20:42:54.071771 | 9b89f73e-e5af-497c-92f8-bce9e6b51e09 ==============================
[0m20:42:54.071771 [info ] [MainThread]: Running with dbt=1.4.1
[0m20:42:54.078771 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'which': 'build', 'rpc_method': 'build'}
[0m20:42:54.079770 [debug] [MainThread]: Tracking: tracking
[0m20:42:54.080771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200AC25C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200AC25F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200AC25E80>]}
[0m20:42:54.392650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:42:54.393790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:42:54.407652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b89f73e-e5af-497c-92f8-bce9e6b51e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200AD54FD0>]}
[0m20:42:54.425061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b89f73e-e5af-497c-92f8-bce9e6b51e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200ACB2250>]}
[0m20:42:54.425645 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:42:54.428209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b89f73e-e5af-497c-92f8-bce9e6b51e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200ACB2490>]}
[0m20:42:54.430244 [info ] [MainThread]: 
[0m20:42:54.434344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:42:54.436777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m20:42:54.466412 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m20:42:54.467413 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m20:42:54.468412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:55.689403 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m20:42:55.694404 [debug] [ThreadPool]: On list_PERSO: Close
[0m20:42:55.810026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m20:42:55.832561 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m20:42:55.833531 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m20:42:55.835532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:56.331511 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0 seconds
[0m20:42:56.336846 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m20:42:56.445465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b89f73e-e5af-497c-92f8-bce9e6b51e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200ACB2130>]}
[0m20:42:56.448498 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m20:42:56.450463 [info ] [MainThread]: 
[0m20:42:56.471465 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m20:42:56.473372 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m20:42:56.477465 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m20:42:56.479463 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m20:42:56.506463 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m20:42:56.511463 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-19 20:42:56.480466 => 2023-04-19 20:42:56.510812
[0m20:42:56.513467 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m20:42:56.618586 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:42:56.619539 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m20:42:56.621610 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:42:57.391270 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:42:57.395258 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m20:42:57.397259 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m20:42:57.399391 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m20:42:57.403258 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:42:57.404259 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m20:42:57.511707 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:42:57.513264 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:42:57.514260 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m20:42:57.734259 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:42:57.734830 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:42:57.735955 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m20:42:57.799193 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:42:57.799193 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m20:42:57.800194 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m20:42:57.860736 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:42:57.862736 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-19 20:42:56.515462 => 2023-04-19 20:42:57.862736
[0m20:42:57.863736 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m20:42:57.968245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b89f73e-e5af-497c-92f8-bce9e6b51e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200B0D5250>]}
[0m20:42:57.970249 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.49s]
[0m20:42:57.975249 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m20:42:57.978540 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:42:57.979534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:57.980253 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m20:42:57.981254 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m20:42:57.981493 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m20:42:57.982253 [info ] [MainThread]: 
[0m20:42:57.983254 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m20:42:57.985251 [debug] [MainThread]: Command end result
[0m20:42:58.003460 [info ] [MainThread]: 
[0m20:42:58.006256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:42:58.009250 [info ] [MainThread]: 
[0m20:42:58.011250 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:42:58.013253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200AC42A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200AD18F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200ACB2130>]}
[0m20:42:58.014284 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:27:06.166586 | c279c7a4-7734-4d01-9bcb-5ddfc5d1560b ==============================
[0m08:27:06.166586 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:27:06.168548 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['conso_client'], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m08:27:06.168548 [debug] [MainThread]: Tracking: tracking
[0m08:27:06.169554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8536D3A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8536D3EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8536D3E20>]}
[0m08:27:06.191548 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:27:06.200545 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m08:27:06.202100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c279c7a4-7734-4d01-9bcb-5ddfc5d1560b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8536C92E0>]}
[0m08:27:07.337630 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m08:27:07.359534 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m08:27:07.404560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8537A0B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C853884280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C853884400>]}
[0m08:27:07.404560 [debug] [MainThread]: Flushing usage events
[0m08:27:07.783849 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.incr_stream.gen_clients' (models\stg\gen_clients.py) depends on a node named 'upstream_table' which was not found


============================== 2023-04-20 08:27:24.542476 | adc82d82-5ad1-4180-b9de-f02454e386f0 ==============================
[0m08:27:24.542476 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:27:24.544670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:27:24.544670 [debug] [MainThread]: Tracking: tracking
[0m08:27:24.545476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE924534C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE92453EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE92453DF0>]}
[0m08:27:24.567618 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:27:24.580506 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m08:27:24.581506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'adc82d82-5ad1-4180-b9de-f02454e386f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE92477310>]}
[0m08:27:25.618201 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m08:27:25.640791 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m08:27:25.689303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE92553A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE926332B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE92633430>]}
[0m08:27:25.690304 [debug] [MainThread]: Flushing usage events
[0m08:27:26.328347 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.incr_stream.gen_clients' (models\stg\gen_clients.py) depends on a node named 'upstream_table' which was not found


============================== 2023-04-20 08:36:11.226955 | 730ee1c9-6639-43bd-8934-21bc321da10c ==============================
[0m08:36:11.226955 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:36:11.228910 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:36:11.228910 [debug] [MainThread]: Tracking: tracking
[0m08:36:11.229912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5D21A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5D21EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5D21E50>]}
[0m08:36:11.247953 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:36:11.256991 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m08:36:11.257961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '730ee1c9-6639-43bd-8934-21bc321da10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5D19430>]}
[0m08:36:12.183285 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m08:36:12.204994 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m08:36:12.273363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '730ee1c9-6639-43bd-8934-21bc321da10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5E675B0>]}
[0m08:36:12.285888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '730ee1c9-6639-43bd-8934-21bc321da10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5CC8A60>]}
[0m08:36:12.286888 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:36:12.287888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '730ee1c9-6639-43bd-8934-21bc321da10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5EA8F40>]}
[0m08:36:12.288891 [info ] [MainThread]: 
[0m08:36:12.291891 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:36:12.292889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:36:12.316889 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:36:12.316889 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:36:12.317889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:14.126953 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m08:36:14.131950 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:36:14.283201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:36:14.291201 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:36:14.291590 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:36:14.291590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:15.206050 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:36:15.213051 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:36:15.338641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '730ee1c9-6639-43bd-8934-21bc321da10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5E67970>]}
[0m08:36:15.339670 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:36:15.340644 [info ] [MainThread]: 
[0m08:36:15.350643 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:36:15.351641 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:36:15.354643 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:36:15.355008 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:36:15.360646 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:36:15.363644 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:36:15.355638 => 2023-04-20 08:36:15.363644
[0m08:36:15.364641 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:36:15.412251 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:36:15.412251 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:36:15.413251 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:36:16.111834 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:36:16.116235 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:36:16.116788 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:36:16.118791 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:36:16.120788 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:36:16.121789 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:36:16.224608 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:36:16.225606 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:36:16.225606 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:36:16.311039 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:36:16.312982 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:36:16.314982 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:36:16.507729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:36:16.507729 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:36:16.508725 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m08:36:16.729930 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:36:16.731926 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:36:16.733933 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:36:18.051419 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:36:18.051419 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:36:18.052419 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:36:18.140516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:36:18.145510 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:36:15.364641 => 2023-04-20 08:36:18.145510
[0m08:36:18.146512 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:36:18.256558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '730ee1c9-6639-43bd-8934-21bc321da10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5E6DE50>]}
[0m08:36:18.257559 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.90s]
[0m08:36:18.262569 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:36:18.265557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:36:18.267560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:18.267560 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:36:18.268558 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:36:18.268558 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:36:18.268558 [info ] [MainThread]: 
[0m08:36:18.270595 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m08:36:18.272558 [debug] [MainThread]: Command end result
[0m08:36:18.290875 [info ] [MainThread]: 
[0m08:36:18.292555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:36:18.293559 [info ] [MainThread]: 
[0m08:36:18.294555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:36:18.295558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5EA8F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5E67130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD5E67EE0>]}
[0m08:36:18.295558 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:37:41.012943 | b29d33f3-ca62-40d8-be25-bb77c942f150 ==============================
[0m08:37:41.012943 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:37:41.015080 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:37:41.015947 [debug] [MainThread]: Tracking: tracking
[0m08:37:41.015947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2EA19D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2EA1DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2EA1CA0>]}
[0m08:37:41.034971 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:37:41.124552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:41.124552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:41.132529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29d33f3-ca62-40d8-be25-bb77c942f150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2FF5670>]}
[0m08:37:41.143522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29d33f3-ca62-40d8-be25-bb77c942f150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2F71970>]}
[0m08:37:41.143522 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:37:41.144520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29d33f3-ca62-40d8-be25-bb77c942f150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2F717C0>]}
[0m08:37:41.145521 [info ] [MainThread]: 
[0m08:37:41.147517 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:37:41.149516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:37:41.167695 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:37:41.168561 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:37:41.168561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:42.248356 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:37:42.251358 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:37:42.353348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:37:42.360351 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:37:42.361351 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:37:42.361351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:43.064082 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:37:43.071037 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:37:43.185132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29d33f3-ca62-40d8-be25-bb77c942f150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2F713D0>]}
[0m08:37:43.185205 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:37:43.186155 [info ] [MainThread]: 
[0m08:37:43.195133 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:37:43.196216 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:37:43.198137 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:37:43.199152 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:37:43.214136 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:37:43.216135 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:37:43.199152 => 2023-04-20 08:37:43.215137
[0m08:37:43.216135 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:37:43.264170 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:43.265170 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:37:43.265170 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:37:44.254078 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:37:44.261089 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:37:44.265025 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:37:44.269046 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:37:44.279031 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:44.279031 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:37:44.403104 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:44.403104 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:44.403104 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.ARO_DWH.S_conso_client
    
);
[0m08:37:44.727122 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:44.727122 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:44.728151 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:37:44.790033 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:44.790033 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:44.791031 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:37:44.850684 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:44.852529 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:37:43.217173 => 2023-04-20 08:37:44.852529
[0m08:37:44.853561 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:37:44.957211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29d33f3-ca62-40d8-be25-bb77c942f150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A3377910>]}
[0m08:37:44.958210 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.76s]
[0m08:37:44.963723 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:37:44.967251 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:37:44.969215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:44.970250 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:37:44.971251 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:37:44.971251 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:37:44.972250 [info ] [MainThread]: 
[0m08:37:44.974211 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m08:37:44.976214 [debug] [MainThread]: Command end result
[0m08:37:44.997390 [info ] [MainThread]: 
[0m08:37:44.998208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:37:44.999209 [info ] [MainThread]: 
[0m08:37:45.000209 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:37:45.001209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A336AF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2FD7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2F719D0>]}
[0m08:37:45.002235 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:37:52.500803 | b547437b-286e-45ef-848c-842c2d03ef98 ==============================
[0m08:37:52.500803 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:37:52.502777 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:37:52.502777 [debug] [MainThread]: Tracking: tracking
[0m08:37:52.503764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3D93490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3D93EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3D93DC0>]}
[0m08:37:52.530768 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:37:52.617804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:52.617804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:52.624811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b547437b-286e-45ef-848c-842c2d03ef98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3EC3700>]}
[0m08:37:52.634765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b547437b-286e-45ef-848c-842c2d03ef98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3DE7A00>]}
[0m08:37:52.634765 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:37:52.635782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b547437b-286e-45ef-848c-842c2d03ef98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3DE7850>]}
[0m08:37:52.636767 [info ] [MainThread]: 
[0m08:37:52.639764 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:37:52.640765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:37:52.663966 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:37:52.663966 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:37:52.663966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:53.566073 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:37:53.570065 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:37:53.682260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:37:53.701304 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:37:53.701304 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:37:53.702290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:54.496832 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:37:54.503832 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:37:54.615122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b547437b-286e-45ef-848c-842c2d03ef98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3DE7460>]}
[0m08:37:54.620064 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:37:54.622067 [info ] [MainThread]: 
[0m08:37:54.636063 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:37:54.637062 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:37:54.640379 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:37:54.641066 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:37:54.653100 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:37:54.655242 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:37:54.641066 => 2023-04-20 08:37:54.655099
[0m08:37:54.655242 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:37:54.700098 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:54.701097 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:37:54.701097 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:37:55.351432 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:37:55.354431 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:37:55.356432 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:37:55.358434 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:37:55.362479 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:55.363433 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:37:55.453188 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:55.454181 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:55.454181 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:37:55.535887 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:55.535887 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:55.536886 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:37:55.681265 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:55.682263 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:55.683264 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    
    
    
    
    
        PERSO.TEST_STREAM.CLIENT
    
);
[0m08:37:55.901960 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:55.902961 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:55.903960 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:37:56.608023 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:37:56.608023 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:37:56.609023 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:37:56.662090 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:37:56.663088 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:37:54.655242 => 2023-04-20 08:37:56.663088
[0m08:37:56.663959 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:37:56.754223 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b547437b-286e-45ef-848c-842c2d03ef98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C4240D90>]}
[0m08:37:56.754223 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.12s]
[0m08:37:56.757225 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:37:56.759221 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:37:56.760224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:56.760224 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:37:56.761225 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:37:56.761225 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:37:56.761225 [info ] [MainThread]: 
[0m08:37:56.762225 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m08:37:56.764231 [debug] [MainThread]: Command end result
[0m08:37:56.783226 [info ] [MainThread]: 
[0m08:37:56.784229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:37:56.786227 [info ] [MainThread]: 
[0m08:37:56.787225 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:37:56.791397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3EA7CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3DE7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147C3DE7460>]}
[0m08:37:56.794111 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:40:43.640402 | 5448fc4c-c16c-417e-aeab-4f8f083fa23a ==============================
[0m08:40:43.640402 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:40:43.641481 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:40:43.642403 [debug] [MainThread]: Tracking: tracking
[0m08:40:43.642403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DCF2A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DCF2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DCF2D90>]}
[0m08:40:43.663469 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:40:43.756395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:40:43.757496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:40:43.765397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5448fc4c-c16c-417e-aeab-4f8f083fa23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DE53670>]}
[0m08:40:43.776538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5448fc4c-c16c-417e-aeab-4f8f083fa23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DDD6970>]}
[0m08:40:43.776538 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:40:43.778396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5448fc4c-c16c-417e-aeab-4f8f083fa23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DDD67C0>]}
[0m08:40:43.780438 [info ] [MainThread]: 
[0m08:40:43.783394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:40:43.786396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:40:43.822057 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:40:43.823181 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:40:43.823410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:44.816254 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:40:44.819041 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:40:44.942030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:40:44.951026 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:40:44.951026 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:40:44.952032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:45.499033 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:40:45.502035 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:40:45.600416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5448fc4c-c16c-417e-aeab-4f8f083fa23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DDD63D0>]}
[0m08:40:45.601389 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:40:45.602495 [info ] [MainThread]: 
[0m08:40:45.611379 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:40:45.611379 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:40:45.613383 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:40:45.615384 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:40:45.628383 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:40:45.631380 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:40:45.616384 => 2023-04-20 08:40:45.630583
[0m08:40:45.631903 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:40:45.689490 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:40:45.689490 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:40:45.690498 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:40:46.525784 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:40:46.532827 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:40:46.535789 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:40:46.539781 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:40:46.544889 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:40:46.545779 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:40:46.725978 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:40:46.726977 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:40:46.727975 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:40:46.853249 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:40:46.854247 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:40:46.854247 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:40:46.964186 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:40:46.964186 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:40:46.965184 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from 
    
    PERSO.TEST_STREAM.CLIENT);
[0m08:40:47.181221 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:40:47.182183 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:40:47.183220 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:40:47.877185 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:40:47.878182 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:40:47.878182 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:40:47.944777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:40:47.949775 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:40:45.632381 => 2023-04-20 08:40:47.949775
[0m08:40:47.951779 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:40:48.065535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5448fc4c-c16c-417e-aeab-4f8f083fa23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6E1EED60>]}
[0m08:40:48.067533 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.45s]
[0m08:40:48.073511 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:40:48.077508 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:40:48.078511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:40:48.079506 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:40:48.079506 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:40:48.080684 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:40:48.081466 [info ] [MainThread]: 
[0m08:40:48.082636 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m08:40:48.085191 [debug] [MainThread]: Command end result
[0m08:40:48.102484 [info ] [MainThread]: 
[0m08:40:48.103469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:40:48.104470 [info ] [MainThread]: 
[0m08:40:48.105503 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:40:48.107504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DD17400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DD17F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6DDD63D0>]}
[0m08:40:48.108507 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:41:32.302387 | 7c2d9404-6a24-4aa9-8f04-1aade00d8355 ==============================
[0m08:41:32.302387 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:41:32.304358 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:41:32.304358 [debug] [MainThread]: Tracking: tracking
[0m08:41:32.305386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B3823A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B3823EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B3823E20>]}
[0m08:41:32.327365 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:41:32.414358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:41:32.414358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:41:32.420358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c2d9404-6a24-4aa9-8f04-1aade00d8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B39846D0>]}
[0m08:41:32.431385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c2d9404-6a24-4aa9-8f04-1aade00d8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B38A29D0>]}
[0m08:41:32.431385 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:41:32.432257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2d9404-6a24-4aa9-8f04-1aade00d8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B38A2820>]}
[0m08:41:32.433259 [info ] [MainThread]: 
[0m08:41:32.436257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:41:32.438261 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:41:32.463288 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:41:32.464287 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:41:32.464287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:34.206568 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m08:41:34.209567 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:41:34.386184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:41:34.394947 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:41:34.396086 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:41:34.396086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:35.022950 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:41:35.028947 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:41:35.185941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2d9404-6a24-4aa9-8f04-1aade00d8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B38A2430>]}
[0m08:41:35.187902 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:41:35.190870 [info ] [MainThread]: 
[0m08:41:35.204857 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:41:35.206867 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:41:35.210860 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:41:35.211889 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:41:35.225893 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:41:35.228110 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:41:35.211889 => 2023-04-20 08:41:35.228110
[0m08:41:35.228856 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:41:35.279226 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:41:35.279226 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:41:35.279226 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:41:36.259550 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:41:36.263549 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:41:36.265559 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:41:36.267549 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:41:36.272830 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:41:36.273844 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:41:36.458400 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:41:36.458400 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:41:36.459400 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:41:36.602404 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:41:36.602404 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:41:36.602404 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:41:36.836048 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:41:36.837001 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:41:36.837001 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (

select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.TEST_STREAM.CLIENT);
[0m08:41:37.110326 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:41:37.111331 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:41:37.111331 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:41:38.415139 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:41:38.415261 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:41:38.416307 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:41:38.500433 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:41:38.507497 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:41:35.228856 => 2023-04-20 08:41:38.506494
[0m08:41:38.508494 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:41:38.658900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2d9404-6a24-4aa9-8f04-1aade00d8355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B3D18B80>]}
[0m08:41:38.659901 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 3.45s]
[0m08:41:38.662879 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:41:38.664844 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:41:38.665850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:38.666851 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:41:38.666851 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:41:38.667849 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:41:38.667849 [info ] [MainThread]: 
[0m08:41:38.668966 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m08:41:38.669846 [debug] [MainThread]: Command end result
[0m08:41:38.687440 [info ] [MainThread]: 
[0m08:41:38.688438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:41:38.689764 [info ] [MainThread]: 
[0m08:41:38.690434 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:41:38.692435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B3823850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B3823E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B38A28B0>]}
[0m08:41:38.692435 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:42:08.566328 | 9c126b12-9679-4f6f-aea5-48bf42d0d7eb ==============================
[0m08:42:08.566328 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:42:08.568409 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:42:08.569288 [debug] [MainThread]: Tracking: tracking
[0m08:42:08.569288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0B64AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0B64E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0B64D90>]}
[0m08:42:08.590286 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:42:08.684129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:42:08.684129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:42:08.692128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c126b12-9679-4f6f-aea5-48bf42d0d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0CC4670>]}
[0m08:42:08.703127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c126b12-9679-4f6f-aea5-48bf42d0d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0C32970>]}
[0m08:42:08.703127 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:42:08.704415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c126b12-9679-4f6f-aea5-48bf42d0d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0C327C0>]}
[0m08:42:08.705127 [info ] [MainThread]: 
[0m08:42:08.708128 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:42:08.710127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:42:08.732310 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:42:08.733345 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:42:08.733345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:09.697878 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:42:09.699877 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:42:09.809131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:42:09.818091 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:42:09.818091 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:42:09.819090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:10.594649 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:42:10.599654 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:42:10.724720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c126b12-9679-4f6f-aea5-48bf42d0d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0C323D0>]}
[0m08:42:10.726775 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:42:10.729786 [info ] [MainThread]: 
[0m08:42:10.749665 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:42:10.751654 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:42:10.755658 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:42:10.755658 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:42:10.769651 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:42:10.772181 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:42:10.756657 => 2023-04-20 08:42:10.771653
[0m08:42:10.772654 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:42:10.823658 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:42:10.824653 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:42:10.824653 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:42:11.512288 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:42:11.518283 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:42:11.520285 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:42:11.523308 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:42:11.527313 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:42:11.528313 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:42:11.657314 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:42:11.657314 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:42:11.658310 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:42:11.765192 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:42:11.766191 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:42:11.766825 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:42:11.909160 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:42:11.910160 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:42:11.912180 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.TEST_STREAM.CLIENT);
[0m08:42:12.172606 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:42:12.173604 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:42:12.173604 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:42:12.905301 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:42:12.906269 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:42:12.906269 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:42:12.969121 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:42:12.971153 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:42:10.772654 => 2023-04-20 08:42:12.971153
[0m08:42:12.972146 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:42:13.075784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c126b12-9679-4f6f-aea5-48bf42d0d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E1056D60>]}
[0m08:42:13.076786 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.32s]
[0m08:42:13.081779 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:42:13.084779 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:42:13.086778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:13.087812 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:42:13.087812 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:42:13.087812 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:42:13.088811 [info ] [MainThread]: 
[0m08:42:13.089824 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m08:42:13.092032 [debug] [MainThread]: Command end result
[0m08:42:13.113805 [info ] [MainThread]: 
[0m08:42:13.114779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:42:13.116779 [info ] [MainThread]: 
[0m08:42:13.117785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:42:13.123811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0B87400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0B87F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289E0CA6880>]}
[0m08:42:13.126779 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:46:57.254691 | 0a1a3691-77cd-4c82-8468-51b4180d88a2 ==============================
[0m08:46:57.254691 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:46:57.257690 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:46:57.257690 [debug] [MainThread]: Tracking: tracking
[0m08:46:57.257690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023767603BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023767603EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023767603E20>]}
[0m08:46:57.279742 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:46:57.366846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:46:57.367687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:46:57.373801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a1a3691-77cd-4c82-8468-51b4180d88a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237677346D0>]}
[0m08:46:57.384688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a1a3691-77cd-4c82-8468-51b4180d88a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237676A99D0>]}
[0m08:46:57.385690 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:46:57.386688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a1a3691-77cd-4c82-8468-51b4180d88a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237676A9820>]}
[0m08:46:57.387979 [info ] [MainThread]: 
[0m08:46:57.390195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:46:57.391688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:46:57.416275 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:46:57.416690 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:46:57.417704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:58.302609 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:46:58.307597 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:46:58.477679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:46:58.504616 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:46:58.504961 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:46:58.506203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:59.235506 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:46:59.237587 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:46:59.361995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a1a3691-77cd-4c82-8468-51b4180d88a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237676A9430>]}
[0m08:46:59.365030 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:46:59.366987 [info ] [MainThread]: 
[0m08:46:59.380066 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:46:59.381302 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:46:59.383990 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:46:59.385794 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:46:59.399321 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:46:59.401317 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:46:59.386305 => 2023-04-20 08:46:59.400365
[0m08:46:59.401317 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:46:59.446357 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:46:59.447328 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:46:59.448383 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:47:00.085202 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:47:00.087049 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:47:00.088049 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:47:00.089049 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:47:00.091051 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:00.092049 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:47:00.177408 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:00.179411 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:00.181402 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:47:00.278336 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:00.279336 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:00.279336 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:47:00.423262 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:00.423262 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:00.424264 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.TEST_STREAM.CLIENT);
[0m08:47:00.641972 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:00.642973 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:00.642973 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:47:01.302013 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:47:01.303041 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:01.303041 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:47:01.357567 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:01.360451 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:46:59.401317 => 2023-04-20 08:47:01.360451
[0m08:47:01.361457 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:47:01.462386 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a1a3691-77cd-4c82-8468-51b4180d88a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237679CB1C0>]}
[0m08:47:01.463530 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.08s]
[0m08:47:01.467383 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:47:01.471391 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:47:01.472384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:01.473384 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:47:01.473384 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:47:01.474385 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:47:01.474385 [info ] [MainThread]: 
[0m08:47:01.476342 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m08:47:01.479342 [debug] [MainThread]: Command end result
[0m08:47:01.499337 [info ] [MainThread]: 
[0m08:47:01.500473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:47:01.501337 [info ] [MainThread]: 
[0m08:47:01.503343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:47:01.504361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237677168B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237676A9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237676A9610>]}
[0m08:47:01.505354 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:47:53.859387 | d7379187-3fbf-4dd2-b110-5089bb82b9a4 ==============================
[0m08:47:53.859387 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:47:53.861370 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:47:53.861370 [debug] [MainThread]: Tracking: tracking
[0m08:47:53.862352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF392AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF392E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF392DC0>]}
[0m08:47:53.879740 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:47:53.964354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:47:53.965352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:47:53.972396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7379187-3fbf-4dd2-b110-5089bb82b9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF4F46A0>]}
[0m08:47:53.982387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7379187-3fbf-4dd2-b110-5089bb82b9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF46E9A0>]}
[0m08:47:53.983354 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:47:53.984459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7379187-3fbf-4dd2-b110-5089bb82b9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF46E7F0>]}
[0m08:47:53.985369 [info ] [MainThread]: 
[0m08:47:53.987352 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:47:53.989351 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:47:54.012617 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:47:54.013392 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:47:54.013392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:54.915197 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:47:54.919192 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:47:55.037289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:47:55.056248 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:47:55.056248 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:47:55.057246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:55.569923 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:47:55.576925 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:47:55.695955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7379187-3fbf-4dd2-b110-5089bb82b9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF46E400>]}
[0m08:47:55.698971 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:47:55.702374 [info ] [MainThread]: 
[0m08:47:55.724365 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:47:55.728400 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:47:55.732366 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:47:55.732366 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:47:55.748400 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:47:55.751366 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:47:55.733362 => 2023-04-20 08:47:55.751366
[0m08:47:55.752400 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:47:55.812897 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:55.813943 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:47:55.813943 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:47:56.646108 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:47:56.648074 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:47:56.649077 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:47:56.650076 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:47:56.652075 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:56.652075 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:47:56.775397 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:56.776404 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:56.776404 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:47:56.864427 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:56.865394 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:56.865675 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:47:57.007737 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:57.007737 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:57.008391 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.TEST_STREAM.CLIENT);
[0m08:47:57.190533 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:57.190533 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:57.191767 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:47:57.796999 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:47:57.798008 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:47:57.798008 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:47:57.852003 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:47:57.855033 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:47:55.752400 => 2023-04-20 08:47:57.855033
[0m08:47:57.855033 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:47:58.011221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7379187-3fbf-4dd2-b110-5089bb82b9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF786040>]}
[0m08:47:58.012221 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.28s]
[0m08:47:58.014176 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:47:58.017213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:47:58.018174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:58.018174 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:47:58.018174 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:47:58.019218 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:47:58.019218 [info ] [MainThread]: 
[0m08:47:58.020198 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m08:47:58.022177 [debug] [MainThread]: Command end result
[0m08:47:58.038203 [info ] [MainThread]: 
[0m08:47:58.039178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:47:58.040184 [info ] [MainThread]: 
[0m08:47:58.042216 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:47:58.043306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF3B7BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF3B7F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF4D6C10>]}
[0m08:47:58.044215 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:48:39.919796 | abe36646-2459-4e25-9cfc-fecb4b5be4dd ==============================
[0m08:48:39.919796 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:48:39.921757 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:48:39.922799 [debug] [MainThread]: Tracking: tracking
[0m08:48:39.922799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A786019D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78601DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78601CD0>]}
[0m08:48:39.945760 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:48:40.036793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:48:40.037792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:48:40.044792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abe36646-2459-4e25-9cfc-fecb4b5be4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78754640>]}
[0m08:48:40.054929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abe36646-2459-4e25-9cfc-fecb4b5be4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A786CE940>]}
[0m08:48:40.054929 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:48:40.056312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abe36646-2459-4e25-9cfc-fecb4b5be4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A786CE790>]}
[0m08:48:40.058033 [info ] [MainThread]: 
[0m08:48:40.059757 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:48:40.061759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:48:40.081759 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:48:40.082124 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:48:40.083783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:41.008432 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:48:41.012374 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:48:41.120272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:48:41.128818 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:48:41.128818 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:48:41.129819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:41.944656 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:48:41.948832 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:48:42.098472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abe36646-2459-4e25-9cfc-fecb4b5be4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A786CE3A0>]}
[0m08:48:42.101464 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:48:42.105433 [info ] [MainThread]: 
[0m08:48:42.123414 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:48:42.125412 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:48:42.128486 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:48:42.129413 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:48:42.141412 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:48:42.143742 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:48:42.129413 => 2023-04-20 08:48:42.143742
[0m08:48:42.145660 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:48:42.190169 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:48:42.190169 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:48:42.190169 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:48:42.802368 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:48:42.809369 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:48:42.812395 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:48:42.814744 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:48:42.819353 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:48:42.820358 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:48:42.929368 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:48:42.929368 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:48:42.930366 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:48:43.060347 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:48:43.061341 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:48:43.062344 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:48:43.203544 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:48:43.204971 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:48:43.205452 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.TEST_STREAM.CLIENT);
[0m08:48:43.400157 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:48:43.401206 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:48:43.402202 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:48:44.134544 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:48:44.134544 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:48:44.134544 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:48:44.191771 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:48:44.193794 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:48:42.145660 => 2023-04-20 08:48:44.193794
[0m08:48:44.193794 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:48:44.293766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe36646-2459-4e25-9cfc-fecb4b5be4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A789ED700>]}
[0m08:48:44.293766 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.17s]
[0m08:48:44.296808 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:48:44.298767 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:48:44.299918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:44.299918 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:48:44.300771 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:48:44.300771 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:48:44.300771 [info ] [MainThread]: 
[0m08:48:44.302015 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m08:48:44.303786 [debug] [MainThread]: Command end result
[0m08:48:44.323772 [info ] [MainThread]: 
[0m08:48:44.331996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:48:44.333769 [info ] [MainThread]: 
[0m08:48:44.334773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:48:44.342774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78ACAE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78617670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78617040>]}
[0m08:48:44.343775 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:49:53.319195 | eae8f587-1d6c-472a-b0e4-ce5f29d91e8e ==============================
[0m08:49:53.319195 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:49:53.321159 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:49:53.321159 [debug] [MainThread]: Tracking: tracking
[0m08:49:53.321159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7E42A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7E42EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7E42DC0>]}
[0m08:49:53.340162 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:49:53.432174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:49:53.433413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:49:53.440133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eae8f587-1d6c-472a-b0e4-ce5f29d91e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7FA56A0>]}
[0m08:49:53.449133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eae8f587-1d6c-472a-b0e4-ce5f29d91e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7F089A0>]}
[0m08:49:53.450133 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:49:53.451131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae8f587-1d6c-472a-b0e4-ce5f29d91e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7F087F0>]}
[0m08:49:53.452158 [info ] [MainThread]: 
[0m08:49:53.454127 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:49:53.456123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:49:53.476410 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:49:53.476410 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:49:53.477166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:54.443345 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:49:54.448319 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:49:54.569687 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:49:54.585653 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:49:54.585653 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:49:54.586654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:55.093108 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:49:55.099103 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:49:55.203255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae8f587-1d6c-472a-b0e4-ce5f29d91e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7F08400>]}
[0m08:49:55.204254 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:49:55.205222 [info ] [MainThread]: 
[0m08:49:55.218264 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:49:55.219223 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:49:55.221239 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:49:55.223302 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:49:55.236504 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:49:55.238230 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:49:55.224235 => 2023-04-20 08:49:55.237259
[0m08:49:55.238230 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:49:55.289248 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:49:55.289394 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:49:55.289394 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:49:56.081011 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:49:56.084153 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:49:56.085471 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:49:56.087187 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:49:56.090183 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:49:56.090183 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m08:49:56.207783 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:49:56.208774 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:49:56.208774 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m08:49:56.302588 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:49:56.303688 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:49:56.304586 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:49:56.430922 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:49:56.432919 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:49:56.433649 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.TEST_STREAM.CLIENT);
[0m08:49:56.608346 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:49:56.610344 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:49:56.611341 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:49:57.245796 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:49:57.246375 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:49:57.247374 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:49:57.306830 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:49:57.308828 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:49:55.238230 => 2023-04-20 08:49:57.308828
[0m08:49:57.308828 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:49:57.406872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae8f587-1d6c-472a-b0e4-ce5f29d91e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B8339B50>]}
[0m08:49:57.407871 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.19s]
[0m08:49:57.411864 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:49:57.414896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:49:57.415902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:57.415902 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:49:57.416615 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:49:57.416896 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:49:57.416896 [info ] [MainThread]: 
[0m08:49:57.418122 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m08:49:57.419865 [debug] [MainThread]: Command end result
[0m08:49:57.434679 [info ] [MainThread]: 
[0m08:49:57.435662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:49:57.437670 [info ] [MainThread]: 
[0m08:49:57.438645 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:49:57.440947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7E68F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7F08A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B7F08340>]}
[0m08:49:57.441627 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 08:50:12.905948 | 0406888e-1e36-448b-8338-73daabd03855 ==============================
[0m08:50:12.905948 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:50:12.908950 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['conso_client'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:50:12.908950 [debug] [MainThread]: Tracking: tracking
[0m08:50:12.909948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AF43AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AF43EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AF43E80>]}
[0m08:50:12.938999 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:50:13.056997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:13.057997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:13.067997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0406888e-1e36-448b-8338-73daabd03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2B075700>]}
[0m08:50:13.080999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0406888e-1e36-448b-8338-73daabd03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AFE8A00>]}
[0m08:50:13.080999 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:50:13.082058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0406888e-1e36-448b-8338-73daabd03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AFE8850>]}
[0m08:50:13.082998 [info ] [MainThread]: 
[0m08:50:13.086998 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:50:13.088998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m08:50:13.116887 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m08:50:13.117898 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m08:50:13.118898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:14.133526 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m08:50:14.135526 [debug] [ThreadPool]: On list_PERSO: Close
[0m08:50:14.258414 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m08:50:14.265835 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m08:50:14.266411 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m08:50:14.266918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:14.998293 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m08:50:15.005479 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m08:50:15.127684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0406888e-1e36-448b-8338-73daabd03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AFE8460>]}
[0m08:50:15.130689 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m08:50:15.133625 [info ] [MainThread]: 
[0m08:50:15.148622 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m08:50:15.149622 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m08:50:15.151628 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m08:50:15.153625 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m08:50:15.166619 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m08:50:15.168617 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 08:50:15.154669 => 2023-04-20 08:50:15.168617
[0m08:50:15.168970 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m08:50:15.215617 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:50:15.216617 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m08:50:15.216617 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:50:15.889694 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:50:15.897327 [info ] [Thread-1  ]:   => 0 record(s) to merge
[0m08:50:15.900665 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m08:50:15.904654 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m08:50:15.909958 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:50:15.910651 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.TEST_STREAM.CLIENT APPEND_ONLY=TRUE;
[0m08:50:16.057463 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:50:16.057925 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:50:16.057925 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO_DWH.S_conso_client);
[0m08:50:16.317309 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:50:16.318505 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:50:16.319254 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m08:50:16.393125 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:50:16.394174 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m08:50:16.395176 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m08:50:16.449957 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:50:16.451953 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 08:50:15.169617 => 2023-04-20 08:50:16.451953
[0m08:50:16.452952 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m08:50:16.551540 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0406888e-1e36-448b-8338-73daabd03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2B2E9970>]}
[0m08:50:16.553636 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.40s]
[0m08:50:16.558518 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m08:50:16.561519 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:50:16.562501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:16.563500 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m08:50:16.563500 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m08:50:16.564501 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m08:50:16.564501 [info ] [MainThread]: 
[0m08:50:16.565877 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m08:50:16.567760 [debug] [MainThread]: Command end result
[0m08:50:16.579735 [info ] [MainThread]: 
[0m08:50:16.582729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:50:16.583826 [info ] [MainThread]: 
[0m08:50:16.584730 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:50:16.585726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2B0568E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AFE8A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2AFE83A0>]}
[0m08:50:16.585726 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 09:22:57.614720 | e4523722-471f-4d7a-8954-67e069c73202 ==============================
[0m09:22:57.614720 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:22:57.617730 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['add_clients'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:22:57.617730 [debug] [MainThread]: Tracking: tracking
[0m09:22:57.617730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201856C2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201856C2F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201856C2EB0>]}
[0m09:22:57.641686 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:22:57.755722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:22:57.756722 [debug] [MainThread]: Partial parsing: added file: incr_stream://models\stg\add_clients.py
[0m09:22:57.811685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4523722-471f-4d7a-8954-67e069c73202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201858AF8E0>]}
[0m09:22:57.822037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4523722-471f-4d7a-8954-67e069c73202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020185848790>]}
[0m09:22:57.822687 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:22:57.822687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4523722-471f-4d7a-8954-67e069c73202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020185848610>]}
[0m09:22:57.824687 [info ] [MainThread]: 
[0m09:22:57.826689 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:22:57.828691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m09:22:57.851920 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m09:22:57.852687 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m09:22:57.852687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:58.871436 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m09:22:58.876081 [debug] [ThreadPool]: On list_PERSO: Close
[0m09:22:58.980743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m09:22:58.981744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m09:22:58.996745 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m09:22:58.997788 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m09:22:58.998193 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m09:22:58.998193 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m09:22:58.998791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:58.998791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:00.033663 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m09:23:00.035632 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m09:23:00.039664 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m09:23:00.042677 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m09:23:00.258062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4523722-471f-4d7a-8954-67e069c73202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020185840730>]}
[0m09:23:00.262281 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m09:23:00.264134 [info ] [MainThread]: 
[0m09:23:00.283082 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m09:23:00.284098 [info ] [Thread-1  ]: 1 of 1 START python table model ARO.add_clients ................................ [RUN]
[0m09:23:00.290006 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m09:23:00.290292 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m09:23:00.330080 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m09:23:00.333085 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 09:23:00.290292 => 2023-04-20 09:23:00.333085
[0m09:23:00.334218 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m09:23:00.378959 [debug] [Thread-1  ]: Writing runtime python for node "model.incr_stream.add_clients"
[0m09:23:00.383920 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m09:23:00.383920 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(materialized = "table")
    return add_clients(session, 30)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients", create_temp_table=False)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m09:23:00.384921 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:23:25.341096 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc013-3201-ba10-0001-2d16003728ee
[0m09:23:25.341096 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 10, in <module>
ModuleNotFoundError: No module named 'faker'
 in function ADD_CLIENTS__DBT_SP with handler main
[0m09:23:25.342095 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 09:23:00.335111 => 2023-04-20 09:23:25.342095
[0m09:23:25.342095 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m09:23:25.445343 [debug] [Thread-1  ]: Database Error in model add_clients (models\stg\add_clients.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 10, in <module>
  ModuleNotFoundError: No module named 'faker'
   in function ADD_CLIENTS__DBT_SP with handler main
  compiled Code at target\run\incr_stream\models\stg\add_clients.py
[0m09:23:25.446096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4523722-471f-4d7a-8954-67e069c73202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020185BF3DF0>]}
[0m09:23:25.447097 [error] [Thread-1  ]: 1 of 1 ERROR creating python table model ARO.add_clients ....................... [[31mERROR[0m in 25.16s]
[0m09:23:25.449096 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m09:23:25.451102 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:23:25.452097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:25.453097 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m09:23:25.453097 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m09:23:25.454344 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m09:23:25.454344 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m09:23:25.455097 [info ] [MainThread]: 
[0m09:23:25.456131 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 27.63 seconds (27.63s).
[0m09:23:25.458095 [debug] [MainThread]: Command end result
[0m09:23:25.472098 [info ] [MainThread]: 
[0m09:23:25.476865 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:23:25.479149 [info ] [MainThread]: 
[0m09:23:25.480878 [error] [MainThread]: [33mDatabase Error in model add_clients (models\stg\add_clients.py)[0m
[0m09:23:25.482102 [error] [MainThread]:   100357 (P0000): Python Interpreter Error:
[0m09:23:25.483102 [error] [MainThread]:   Traceback (most recent call last):
[0m09:23:25.485098 [error] [MainThread]:     File "_udf_code.py", line 10, in <module>
[0m09:23:25.486101 [error] [MainThread]:   ModuleNotFoundError: No module named 'faker'
[0m09:23:25.487097 [error] [MainThread]:    in function ADD_CLIENTS__DBT_SP with handler main
[0m09:23:25.489103 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\stg\add_clients.py
[0m09:23:25.490176 [info ] [MainThread]: 
[0m09:23:25.495304 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:23:25.500102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020185807D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020185BE4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020185840820>]}
[0m09:23:25.502096 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 09:24:35.003520 | 7caca08c-4074-4626-9633-50256b2ba422 ==============================
[0m09:24:35.003520 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:24:35.005619 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['add_clients'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:24:35.006522 [debug] [MainThread]: Tracking: tracking
[0m09:24:35.006522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B114001610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B114001C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B114001EB0>]}
[0m09:24:35.032523 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:24:35.120592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:35.121589 [debug] [MainThread]: Partial parsing: updated file: incr_stream://models\stg\add_clients.py
[0m09:24:35.186636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7caca08c-4074-4626-9633-50256b2ba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1141EEC70>]}
[0m09:24:35.199955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7caca08c-4074-4626-9633-50256b2ba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11419AAC0>]}
[0m09:24:35.200636 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:24:35.203637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7caca08c-4074-4626-9633-50256b2ba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11419AE80>]}
[0m09:24:35.205635 [info ] [MainThread]: 
[0m09:24:35.208634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:24:35.211654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m09:24:35.235637 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m09:24:35.236635 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m09:24:35.236635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:36.280767 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m09:24:36.283770 [debug] [ThreadPool]: On list_PERSO: Close
[0m09:24:36.388512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m09:24:36.397633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m09:24:36.398513 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m09:24:36.400510 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m09:24:36.401595 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m09:24:36.402184 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m09:24:36.402184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:36.402184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:37.052085 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m09:24:37.055087 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m09:24:37.068315 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m09:24:37.071314 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m09:24:37.200341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7caca08c-4074-4626-9633-50256b2ba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1143E8E20>]}
[0m09:24:37.200341 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m09:24:37.201376 [info ] [MainThread]: 
[0m09:24:37.209340 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m09:24:37.210341 [info ] [Thread-1  ]: 1 of 1 START python table model ARO.add_clients ................................ [RUN]
[0m09:24:37.211346 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m09:24:37.212339 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m09:24:37.247338 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m09:24:37.251347 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 09:24:37.213343 => 2023-04-20 09:24:37.251347
[0m09:24:37.252340 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m09:24:37.301337 [debug] [Thread-1  ]: Writing runtime python for node "model.incr_stream.add_clients"
[0m09:24:37.305462 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m09:24:37.306354 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "table")
    return add_clients(session, 30)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients", create_temp_table=False)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m09:24:37.306354 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:24:53.660056 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 16 seconds
[0m09:24:53.687053 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 09:24:37.252340 => 2023-04-20 09:24:53.687053
[0m09:24:53.688054 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m09:24:53.794613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caca08c-4074-4626-9633-50256b2ba422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B114179FA0>]}
[0m09:24:53.795569 [info ] [Thread-1  ]: 1 of 1 OK created python table model ARO.add_clients ........................... [[32mSUCCESS 1[0m in 16.58s]
[0m09:24:53.798600 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m09:24:53.800569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:24:53.801602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:53.802603 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m09:24:53.802603 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m09:24:53.802603 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m09:24:53.803734 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m09:24:53.804568 [info ] [MainThread]: 
[0m09:24:53.805716 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 18.60 seconds (18.60s).
[0m09:24:53.807567 [debug] [MainThread]: Command end result
[0m09:24:53.825580 [info ] [MainThread]: 
[0m09:24:53.829591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:53.830570 [info ] [MainThread]: 
[0m09:24:53.831756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:24:53.832567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11419AE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B114192460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1141EEEB0>]}
[0m09:24:53.833574 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 09:51:41.807593 | d41fde5f-5324-45f2-86f6-b5a98ad40f5b ==============================
[0m09:51:41.807593 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:51:41.810592 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['add_clients'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:51:41.811592 [debug] [MainThread]: Tracking: tracking
[0m09:51:41.811592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2EF93B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2EF93F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2EF93EB0>]}
[0m09:51:41.835592 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:51:41.942591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:51:41.943634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:51:41.951592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd41fde5f-5324-45f2-86f6-b5a98ad40f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2F0F7AF0>]}
[0m09:51:41.963365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd41fde5f-5324-45f2-86f6-b5a98ad40f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2F01BDF0>]}
[0m09:51:41.963593 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:51:41.964594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd41fde5f-5324-45f2-86f6-b5a98ad40f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2F01BC40>]}
[0m09:51:41.965619 [info ] [MainThread]: 
[0m09:51:41.967593 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:51:41.969597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m09:51:41.993870 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m09:51:41.994886 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m09:51:41.994886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:44.021636 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m09:51:44.027633 [debug] [ThreadPool]: On list_PERSO: Close
[0m09:51:44.172793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m09:51:44.185777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m09:51:44.192802 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m09:51:44.196760 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m09:51:44.198310 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m09:51:44.198310 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m09:51:44.199080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:44.200216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:44.941656 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m09:51:44.947995 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m09:51:45.104623 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m09:51:45.106609 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m09:51:45.224774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd41fde5f-5324-45f2-86f6-b5a98ad40f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2EF93F70>]}
[0m09:51:45.227718 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m09:51:45.231655 [info ] [MainThread]: 
[0m09:51:45.259657 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m09:51:45.261652 [info ] [Thread-1  ]: 1 of 1 START python table model ARO.add_clients ................................ [RUN]
[0m09:51:45.266652 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m09:51:45.267683 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m09:51:45.305744 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m09:51:45.309722 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 09:51:45.267683 => 2023-04-20 09:51:45.309722
[0m09:51:45.310973 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m09:51:45.355756 [debug] [Thread-1  ]: Writing runtime python for node "model.incr_stream.add_clients"
[0m09:51:45.358757 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m09:51:45.359759 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "table")
    return add_clients(session, 30)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients", create_temp_table=False)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m09:51:45.359759 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:52:11.781566 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 26 seconds
[0m09:52:11.860123 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 09:51:45.310973 => 2023-04-20 09:52:11.860123
[0m09:52:11.860123 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m09:52:11.955375 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd41fde5f-5324-45f2-86f6-b5a98ad40f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2F46FD60>]}
[0m09:52:11.956381 [info ] [Thread-1  ]: 1 of 1 OK created python table model ARO.add_clients ........................... [[32mSUCCESS 1[0m in 26.69s]
[0m09:52:11.958384 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m09:52:11.960346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:52:11.961346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:11.962383 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m09:52:11.962383 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m09:52:11.963347 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m09:52:11.963347 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m09:52:11.964390 [info ] [MainThread]: 
[0m09:52:11.966354 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 30.00 seconds (30.00s).
[0m09:52:11.967351 [debug] [MainThread]: Command end result
[0m09:52:11.978350 [info ] [MainThread]: 
[0m09:52:11.979364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:11.980484 [info ] [MainThread]: 
[0m09:52:11.981348 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:52:11.982350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2EFCF8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2F354EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2F365E50>]}
[0m09:52:11.983350 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:12:28.678372 | 7dec383c-a11c-43e2-8e1f-e6b0b543fe1b ==============================
[0m11:12:28.678372 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:12:28.680475 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['add_clients'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:12:28.680475 [debug] [MainThread]: Tracking: tracking
[0m11:12:28.681414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF2225B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF222B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF222940>]}
[0m11:12:28.707127 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:12:28.815357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:12:28.815788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:12:28.822934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dec383c-a11c-43e2-8e1f-e6b0b543fe1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF387B50>]}
[0m11:12:28.834135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dec383c-a11c-43e2-8e1f-e6b0b543fe1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF2E6E50>]}
[0m11:12:28.835126 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:12:28.835714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dec383c-a11c-43e2-8e1f-e6b0b543fe1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF2E6CA0>]}
[0m11:12:28.837128 [info ] [MainThread]: 
[0m11:12:28.840433 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:12:28.842220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:12:28.868781 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:12:28.870787 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:12:28.871787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:30.115281 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:12:30.117329 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:12:30.223196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:12:30.224196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:12:30.233302 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:12:30.236299 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:12:30.237351 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:12:30.237351 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:12:30.237351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:30.238341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:31.147096 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:12:31.149175 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:12:31.194108 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:12:31.195996 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:12:31.321346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dec383c-a11c-43e2-8e1f-e6b0b543fe1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF2E62B0>]}
[0m11:12:31.322395 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:12:31.324348 [info ] [MainThread]: 
[0m11:12:31.337347 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:12:31.340550 [info ] [Thread-1  ]: 1 of 1 START python table model ARO.add_clients ................................ [RUN]
[0m11:12:31.344469 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:12:31.346350 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:12:31.421483 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:12:31.424481 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:12:31.347671 => 2023-04-20 11:12:31.424481
[0m11:12:31.425865 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:12:31.503106 [debug] [Thread-1  ]: Writing runtime python for node "model.incr_stream.add_clients"
[0m11:12:31.508099 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:12:31.509114 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "table")
    return add_clients(session, 30)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients", create_temp_table=False)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:12:31.509114 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:12:57.059756 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 26 seconds
[0m11:12:57.107487 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:12:31.426479 => 2023-04-20 11:12:57.107487
[0m11:12:57.108495 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:12:57.211510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dec383c-a11c-43e2-8e1f-e6b0b543fe1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF61DD60>]}
[0m11:12:57.212510 [info ] [Thread-1  ]: 1 of 1 OK created python table model ARO.add_clients ........................... [[32mSUCCESS 1[0m in 25.87s]
[0m11:12:57.216566 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:12:57.219516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:12:57.220704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:57.220704 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:12:57.221517 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:12:57.222114 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:12:57.222516 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:12:57.222516 [info ] [MainThread]: 
[0m11:12:57.224517 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 28.38 seconds (28.38s).
[0m11:12:57.226510 [debug] [MainThread]: Command end result
[0m11:12:57.242769 [info ] [MainThread]: 
[0m11:12:57.244808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:57.245768 [info ] [MainThread]: 
[0m11:12:57.248867 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:12:57.250767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF25CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF5E2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF5E2FD0>]}
[0m11:12:57.250767 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:14:32.578793 | 086f15a6-3985-47cc-971b-c7ef80053bb6 ==============================
[0m11:14:32.578793 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:14:32.580753 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['add_clients'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:14:32.580753 [debug] [MainThread]: Tracking: tracking
[0m11:14:32.581795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276BFE2AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276BFE2EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276BFE27F0>]}
[0m11:14:32.602398 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:14:32.699591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:14:32.699591 [debug] [MainThread]: Partial parsing: updated file: incr_stream://models\stg\add_clients.py
[0m11:14:32.752180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '086f15a6-3985-47cc-971b-c7ef80053bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276C1CEC40>]}
[0m11:14:32.763151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '086f15a6-3985-47cc-971b-c7ef80053bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276C178C70>]}
[0m11:14:32.764145 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:14:32.765145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '086f15a6-3985-47cc-971b-c7ef80053bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276C178550>]}
[0m11:14:32.766199 [info ] [MainThread]: 
[0m11:14:32.768384 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:32.770383 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:14:32.794161 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:14:32.794161 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:14:32.795159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:33.705710 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:14:33.707711 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:14:33.809269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:14:33.811266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:14:33.823237 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:14:33.827235 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:14:33.828441 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:14:33.828441 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:14:33.829264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:33.830233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:34.564430 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:14:34.567307 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:14:34.579302 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:14:34.582302 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:14:34.690127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '086f15a6-3985-47cc-971b-c7ef80053bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276C3C9E20>]}
[0m11:14:34.691124 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:14:34.692125 [info ] [MainThread]: 
[0m11:14:34.706127 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:14:34.708335 [info ] [Thread-1  ]: 1 of 1 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:14:34.713156 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:14:34.715126 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:14:34.780280 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:14:34.782280 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:14:34.716205 => 2023-04-20 11:14:34.782280
[0m11:14:34.783312 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:14:34.894401 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:14:34.894401 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    return add_clients(session, 30)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:14:34.895304 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:14:46.643435 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 12 seconds
[0m11:14:46.660102 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:14:46.661274 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:14:46.758851 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:14:46.765848 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:14:46.765848 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:14:46.817522 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:14:46.829515 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:14:46.829515 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:14:46.895787 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:14:46.928297 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:14:46.930305 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:14:46.930305 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:14:47.010312 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:14:47.010312 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:14:47.011311 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:14:47.496062 [debug] [Thread-1  ]: SQL status: SUCCESS 30 in 0 seconds
[0m11:14:47.497099 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:14:47.497099 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:14:47.753359 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:14:47.765968 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:14:47.766952 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:14:47.844276 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:14:47.876460 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:14:34.786375 => 2023-04-20 11:14:47.876460
[0m11:14:47.877485 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:14:47.969607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '086f15a6-3985-47cc-971b-c7ef80053bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276C3EBBE0>]}
[0m11:14:47.970609 [info ] [Thread-1  ]: 1 of 1 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 30[0m in 13.26s]
[0m11:14:47.974611 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:14:47.976609 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:47.978382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:47.978643 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:14:47.978643 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:14:47.979608 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:14:47.979608 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:14:47.979608 [info ] [MainThread]: 
[0m11:14:47.980968 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.21 seconds (15.21s).
[0m11:14:47.981609 [debug] [MainThread]: Command end result
[0m11:14:47.993156 [info ] [MainThread]: 
[0m11:14:47.995144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:47.996293 [info ] [MainThread]: 
[0m11:14:47.998141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:47.999142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276BF9C400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276C128EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276C59C070>]}
[0m11:14:48.001197 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:20:20.126082 | 5595fe64-cdfb-4bed-ab22-115c58ba5579 ==============================
[0m11:20:20.126082 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:20:20.128018 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['add_clients'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:20:20.129012 [debug] [MainThread]: Tracking: tracking
[0m11:20:20.129012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C1F62B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C1F6C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C1F6EB0>]}
[0m11:20:20.170138 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:20:20.185751 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:20:20.189076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5595fe64-cdfb-4bed-ab22-115c58ba5579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C21B490>]}
[0m11:20:21.138455 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m11:20:21.159716 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m11:20:21.234148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5595fe64-cdfb-4bed-ab22-115c58ba5579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C31F0A0>]}
[0m11:20:21.244111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5595fe64-cdfb-4bed-ab22-115c58ba5579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C21B790>]}
[0m11:20:21.244111 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:20:21.245113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5595fe64-cdfb-4bed-ab22-115c58ba5579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C3AFF10>]}
[0m11:20:21.247114 [info ] [MainThread]: 
[0m11:20:21.249115 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:20:21.252117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:20:21.274212 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:20:21.275200 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:20:21.275200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:22.211707 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:20:22.214707 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:20:22.314500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:20:22.316498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:20:22.323450 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:20:22.328234 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:20:22.329241 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:20:22.329241 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:20:22.329241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:22.330568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:23.089482 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:20:23.092484 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:20:23.151231 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:20:23.154185 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:20:23.254763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5595fe64-cdfb-4bed-ab22-115c58ba5579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49A9E6850>]}
[0m11:20:23.255763 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:20:23.256762 [info ] [MainThread]: 
[0m11:20:23.265764 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:20:23.268128 [info ] [Thread-1  ]: 1 of 1 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:20:23.270105 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:20:23.271207 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:20:23.317203 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:20:23.320063 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:20:23.272635 => 2023-04-20 11:20:23.320063
[0m11:20:23.320063 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:20:23.412476 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:20:23.413443 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    delta = dbt.var("delta_clients")
    print(delta)
    return add_clients(session, 30)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:20:23.413737 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:20:32.537115 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc088-3201-ba10-0001-2d1600372a62
[0m11:20:32.537115 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 116, in main
  File "_udf_code.py", line 37, in model
AttributeError: 'dbtObj' object has no attribute 'var'
 in function ADD_CLIENTS__DBT_SP with handler main
[0m11:20:32.538195 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:20:23.320063 => 2023-04-20 11:20:32.537115
[0m11:20:32.538195 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:20:32.632513 [debug] [Thread-1  ]: Database Error in model add_clients (models\stg\add_clients.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 116, in main
    File "_udf_code.py", line 37, in model
  AttributeError: 'dbtObj' object has no attribute 'var'
   in function ADD_CLIENTS__DBT_SP with handler main
[0m11:20:32.633511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5595fe64-cdfb-4bed-ab22-115c58ba5579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49A9E6850>]}
[0m11:20:32.634194 [error] [Thread-1  ]: 1 of 1 ERROR creating python incremental model ARO.add_clients ................. [[31mERROR[0m in 9.36s]
[0m11:20:32.636504 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:20:32.638505 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:20:32.639505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:32.639505 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:20:32.639505 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:20:32.639505 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:20:32.640718 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:20:32.640718 [info ] [MainThread]: 
[0m11:20:32.641506 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.39 seconds (11.39s).
[0m11:20:32.643803 [debug] [MainThread]: Command end result
[0m11:20:32.657508 [info ] [MainThread]: 
[0m11:20:32.659505 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:20:32.660539 [info ] [MainThread]: 
[0m11:20:32.661516 [error] [MainThread]: [33mDatabase Error in model add_clients (models\stg\add_clients.py)[0m
[0m11:20:32.662508 [error] [MainThread]:   100357 (P0000): Python Interpreter Error:
[0m11:20:32.663508 [error] [MainThread]:   Traceback (most recent call last):
[0m11:20:32.665510 [error] [MainThread]:     File "_udf_code.py", line 116, in main
[0m11:20:32.666525 [error] [MainThread]:     File "_udf_code.py", line 37, in model
[0m11:20:32.668505 [error] [MainThread]:   AttributeError: 'dbtObj' object has no attribute 'var'
[0m11:20:32.670591 [error] [MainThread]:    in function ADD_CLIENTS__DBT_SP with handler main
[0m11:20:32.671511 [info ] [MainThread]: 
[0m11:20:32.673508 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:20:32.675619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C314490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C22FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C7454C0>]}
[0m11:20:32.676504 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:26:18.238610 | c65c14fd-323b-4bae-b6ae-8aa3a843d490 ==============================
[0m11:26:18.238610 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:26:18.240650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['add_clients'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:26:18.240650 [debug] [MainThread]: Tracking: tracking
[0m11:26:18.241652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A021F3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A021F3EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A021F3E80>]}
[0m11:26:18.267730 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:26:18.276769 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:26:18.277984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c65c14fd-323b-4bae-b6ae-8aa3a843d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0221B490>]}
[0m11:26:19.418848 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m11:26:19.439881 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m11:26:19.529559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c65c14fd-323b-4bae-b6ae-8aa3a843d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0233F2E0>]}
[0m11:26:19.539175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c65c14fd-323b-4bae-b6ae-8aa3a843d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A021F3880>]}
[0m11:26:19.539175 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:26:19.541090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65c14fd-323b-4bae-b6ae-8aa3a843d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A023B1FD0>]}
[0m11:26:19.542131 [info ] [MainThread]: 
[0m11:26:19.545087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:26:19.546088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:26:19.563958 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:26:19.564960 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:26:19.565436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:20.416722 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:26:20.419718 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:26:20.518804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:26:20.531831 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:26:20.534847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:26:20.535172 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:26:20.537834 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:26:20.537834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:20.538933 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:26:20.542384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:21.185911 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:26:21.188067 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:26:21.318160 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:26:21.320152 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:26:21.420709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65c14fd-323b-4bae-b6ae-8aa3a843d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A023C1A30>]}
[0m11:26:21.421750 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:26:21.422709 [info ] [MainThread]: 
[0m11:26:21.430806 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:26:21.431712 [info ] [Thread-1  ]: 1 of 1 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:26:21.435764 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:26:21.436811 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:26:21.489961 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:26:21.493852 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:26:21.437712 => 2023-04-20 11:26:21.493852
[0m11:26:21.495858 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:26:21.582394 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:21.583401 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 30}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:26:21.583401 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:26:32.981386 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 11 seconds
[0m11:26:32.996385 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:32.997386 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:26:33.078978 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:26:33.084047 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:33.084980 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:26:33.165148 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:26:33.183148 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:33.183490 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:26:33.239569 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:26:33.272994 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:26:33.275009 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:33.275994 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:26:33.397288 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:26:33.397288 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:33.398311 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:26:33.994036 [debug] [Thread-1  ]: SQL status: SUCCESS 30 in 1 seconds
[0m11:26:33.994036 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:33.994967 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:26:34.222193 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:26:34.235242 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:34.236188 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:26:34.324118 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:26:34.358293 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:26:34.359297 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:26:34.464229 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:26:34.474373 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:26:21.496466 => 2023-04-20 11:26:34.474373
[0m11:26:34.475231 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:26:34.579966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c65c14fd-323b-4bae-b6ae-8aa3a843d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A02422DC0>]}
[0m11:26:34.580959 [info ] [Thread-1  ]: 1 of 1 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 30[0m in 13.15s]
[0m11:26:34.583958 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:26:34.586960 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:26:34.587956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:34.587956 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:26:34.587956 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:26:34.588959 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:26:34.588959 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:26:34.588959 [info ] [MainThread]: 
[0m11:26:34.590325 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.05 seconds (15.05s).
[0m11:26:34.591961 [debug] [MainThread]: Command end result
[0m11:26:34.605014 [info ] [MainThread]: 
[0m11:26:34.607014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:34.610017 [info ] [MainThread]: 
[0m11:26:34.612010 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:26:34.613008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A023C1A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0263D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0263D8B0>]}
[0m11:26:34.614009 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:28:00.795920 | adcdcb6a-3e8e-4cf7-b2cf-944d6544ca86 ==============================
[0m11:28:00.795920 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:28:00.797956 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 100', 'select': ['add_clients'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:28:00.797956 [debug] [MainThread]: Tracking: tracking
[0m11:28:00.798918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F73E5BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F73E5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F73E5F40>]}
[0m11:28:00.818703 [debug] [MainThread]: checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd, vars: {'nb_clients': 100}, profile: None, target: None, version: 1.4.6
[0m11:28:00.827746 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:28:00.829040 [debug] [MainThread]: previous checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, current checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd
[0m11:28:00.831003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'adcdcb6a-3e8e-4cf7-b2cf-944d6544ca86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F73D9490>]}
[0m11:28:01.784126 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m11:28:01.805766 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m11:28:01.889028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adcdcb6a-3e8e-4cf7-b2cf-944d6544ca86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F72F8A00>]}
[0m11:28:01.897979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adcdcb6a-3e8e-4cf7-b2cf-944d6544ca86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F7503250>]}
[0m11:28:01.899013 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 309 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:28:01.900012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adcdcb6a-3e8e-4cf7-b2cf-944d6544ca86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F73D9BB0>]}
[0m11:28:01.901013 [info ] [MainThread]: 
[0m11:28:01.903012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:28:01.905016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:28:01.924994 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:28:01.924994 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:28:01.925998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:08.656953 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 7 seconds
[0m11:28:08.659949 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:28:08.769133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:28:08.770692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:28:08.779764 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:28:08.782738 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:28:08.783738 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:28:08.784266 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:28:08.784266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:08.784692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:09.680035 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:28:09.682078 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:28:09.730127 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:28:09.731812 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:28:09.833047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adcdcb6a-3e8e-4cf7-b2cf-944d6544ca86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F72F8DF0>]}
[0m11:28:09.834050 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:28:09.835047 [info ] [MainThread]: 
[0m11:28:09.844442 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:28:09.846461 [info ] [Thread-1  ]: 1 of 1 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:28:09.848440 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:28:09.850506 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:28:09.888102 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:28:09.891111 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:28:09.852520 => 2023-04-20 11:28:09.891111
[0m11:28:09.892099 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:28:09.990075 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:09.991119 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 100}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:28:09.991119 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:28:25.877727 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 16 seconds
[0m11:28:25.893755 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:25.894559 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:28:25.982172 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:28:25.993112 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:25.994112 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:28:26.067548 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:28:26.086196 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:26.087228 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:28:26.145677 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:28:26.174585 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:28:26.177589 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:26.177589 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:28:26.272605 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:28:26.273586 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:26.273586 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:28:26.816547 [debug] [Thread-1  ]: SQL status: SUCCESS 100 in 1 seconds
[0m11:28:26.817545 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:26.817545 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:28:27.054813 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:28:27.068237 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:27.068789 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:28:27.156555 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:28:27.189592 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:28:27.190547 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:28:27.260970 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:28:27.269722 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:28:09.892099 => 2023-04-20 11:28:27.269722
[0m11:28:27.270675 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:28:27.366715 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcdcb6a-3e8e-4cf7-b2cf-944d6544ca86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F775C040>]}
[0m11:28:27.367832 [info ] [Thread-1  ]: 1 of 1 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 100[0m in 17.52s]
[0m11:28:27.371975 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:28:27.375885 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:28:27.377714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:27.378775 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:28:27.379846 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:28:27.380696 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:28:27.380696 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:28:27.381725 [info ] [MainThread]: 
[0m11:28:27.382762 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 25.48 seconds (25.48s).
[0m11:28:27.385708 [debug] [MainThread]: Command end result
[0m11:28:27.406700 [info ] [MainThread]: 
[0m11:28:27.407692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:28:27.409437 [info ] [MainThread]: 
[0m11:28:27.411341 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:28:27.413365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F74F3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F791B640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F791B040>]}
[0m11:28:27.415662 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:34:02.486587 | a707362a-204c-485c-8bfb-372cafa33d2f ==============================
[0m11:34:02.486587 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:34:02.489393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 100', 'select': ['add_clients+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:34:02.489393 [debug] [MainThread]: Tracking: tracking
[0m11:34:02.489393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251149DAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251149DAEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251149DAE50>]}
[0m11:34:02.512257 [debug] [MainThread]: checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd, vars: {'nb_clients': 100}, profile: None, target: None, version: 1.4.6
[0m11:34:02.614428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:34:02.615530 [debug] [MainThread]: Partial parsing: updated file: incr_stream://macros\stream_source.sql
[0m11:34:02.616400 [debug] [MainThread]: Partial parsing: updated file: incr_stream://models\dwh\conso_client.sql
[0m11:34:02.657006 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m11:34:02.678116 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m11:34:02.691005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a707362a-204c-485c-8bfb-372cafa33d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025114AE3BB0>]}
[0m11:34:02.700007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a707362a-204c-485c-8bfb-372cafa33d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025114A8BF70>]}
[0m11:34:02.700007 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:34:02.701032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a707362a-204c-485c-8bfb-372cafa33d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025114A8BDC0>]}
[0m11:34:02.703012 [info ] [MainThread]: 
[0m11:34:02.706010 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:34:02.708019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:34:02.719010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:34:02.731276 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:34:02.736041 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:34:02.736544 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:34:02.736544 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:34:02.737009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:02.737009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:04.050020 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:34:04.053115 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:34:04.055015 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:34:04.060016 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:34:04.230280 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:34:04.233254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:34:04.243948 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:34:04.241434 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:34:04.245532 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:34:04.245947 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:34:04.245947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:04.246947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:05.337713 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:34:05.339714 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:34:05.375201 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:34:05.377201 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:34:05.472216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a707362a-204c-485c-8bfb-372cafa33d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025113136820>]}
[0m11:34:05.473307 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:34:05.474206 [info ] [MainThread]: 
[0m11:34:05.483201 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:34:05.483201 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:34:05.485206 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:34:05.486206 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:34:05.565641 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:34:05.568641 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:34:05.486206 => 2023-04-20 11:34:05.568641
[0m11:34:05.569643 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:34:05.665739 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:05.666502 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 100}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:34:05.666502 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:34:20.991294 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 15 seconds
[0m11:34:21.003980 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:21.004997 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:34:21.082537 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:34:21.086536 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:21.087536 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:34:21.140987 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:34:21.152988 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:21.152988 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:34:21.209977 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:34:21.239042 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:34:21.240931 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:21.241931 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:34:21.333932 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:34:21.334966 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:21.334966 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:34:21.876993 [debug] [Thread-1  ]: SQL status: SUCCESS 100 in 1 seconds
[0m11:34:21.876993 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:21.876993 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:34:22.136958 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:34:22.149647 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:22.149955 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:34:22.234439 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:34:22.268285 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:34:22.268285 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:34:22.361281 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:34:22.371197 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:34:05.569643 => 2023-04-20 11:34:22.371197
[0m11:34:22.371197 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:34:22.467407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a707362a-204c-485c-8bfb-372cafa33d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025114EA7F10>]}
[0m11:34:22.468386 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 100[0m in 16.98s]
[0m11:34:22.471413 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:34:22.472384 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:34:22.473313 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:34:22.475305 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:34:22.475865 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:34:22.484384 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:34:22.488581 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:34:22.476304 => 2023-04-20 11:34:22.488243
[0m11:34:22.489381 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:34:22.545047 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:34:22.545482 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:34:22.546057 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:34:23.425103 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:34:23.442591 [info ] [Thread-3  ]:   => 0 record(s) to merge
[0m11:34:23.444609 [info ] [Thread-3  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m11:34:23.445567 [debug] [Thread-3  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m11:34:23.449565 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:34:23.450570 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m11:34:23.848255 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:34:23.849293 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:34:23.849293 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO_DWH.S_conso_client);
[0m11:34:24.113481 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:34:24.115360 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:34:24.117465 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m11:34:24.216825 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:34:24.217214 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:34:24.221152 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m11:34:24.274237 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:34:24.276452 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:34:22.489855 => 2023-04-20 11:34:24.276452
[0m11:34:24.277235 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:34:24.387822 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a707362a-204c-485c-8bfb-372cafa33d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025114EA79D0>]}
[0m11:34:24.388934 [info ] [Thread-3  ]: 2 of 2 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.91s]
[0m11:34:24.392233 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:34:24.397211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:34:24.400209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:24.401208 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:34:24.402209 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:34:24.403206 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:34:24.403206 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:34:24.404207 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:34:24.405207 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:34:24.406207 [info ] [MainThread]: 
[0m11:34:24.432570 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 21.70 seconds (21.70s).
[0m11:34:24.435588 [debug] [MainThread]: Command end result
[0m11:34:24.455308 [info ] [MainThread]: 
[0m11:34:24.456507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:24.458303 [info ] [MainThread]: 
[0m11:34:24.460470 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:34:24.462087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025114D66BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025114EC7E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025114D7A430>]}
[0m11:34:24.464109 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:35:03.141843 | b158c14e-fc2b-431f-b7eb-d7de288053d6 ==============================
[0m11:35:03.141843 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:35:03.144217 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 100', 'select': ['add_clients+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:35:03.144217 [debug] [MainThread]: Tracking: tracking
[0m11:35:03.145218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDDD76580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDDD76CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDDD76EE0>]}
[0m11:35:03.165225 [debug] [MainThread]: checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd, vars: {'nb_clients': 100}, profile: None, target: None, version: 1.4.6
[0m11:35:03.262260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:03.262260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:03.269355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b158c14e-fc2b-431f-b7eb-d7de288053d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDDE5DDC0>]}
[0m11:35:03.278777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b158c14e-fc2b-431f-b7eb-d7de288053d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDDE3CEE0>]}
[0m11:35:03.278777 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:35:03.279965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b158c14e-fc2b-431f-b7eb-d7de288053d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDDE4A0A0>]}
[0m11:35:03.280776 [info ] [MainThread]: 
[0m11:35:03.283785 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:35:03.284868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:35:03.298460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:35:03.308460 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:35:03.311459 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:35:03.312889 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:35:03.314919 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:35:03.315991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:03.315991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:04.349380 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:35:04.353966 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:35:04.356002 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:35:04.361943 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:35:04.487005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:35:04.489353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:35:04.499004 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:35:04.502240 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:35:04.502819 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:35:04.503305 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:35:04.503800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:04.503800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:05.152343 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:35:05.154338 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:35:05.179349 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:35:05.182341 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:35:05.282541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b158c14e-fc2b-431f-b7eb-d7de288053d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDDCDADC0>]}
[0m11:35:05.283548 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:35:05.284552 [info ] [MainThread]: 
[0m11:35:05.293552 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:35:05.294663 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:35:05.299115 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:35:05.299549 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:35:05.355434 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:35:05.357435 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:35:05.299549 => 2023-04-20 11:35:05.357435
[0m11:35:05.359437 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:35:05.459925 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:05.460415 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 100}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:35:05.460415 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:35:20.905267 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 15 seconds
[0m11:35:20.916847 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:20.916847 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:35:20.996763 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:35:21.002911 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:21.003874 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:35:21.084559 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:35:21.103648 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:21.105097 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:35:21.160290 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:35:21.189709 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:35:21.192754 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:21.192754 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:35:21.297951 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:35:21.298903 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:21.300505 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:35:21.838846 [debug] [Thread-1  ]: SQL status: SUCCESS 100 in 1 seconds
[0m11:35:21.840849 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:21.842059 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:35:22.124829 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:35:22.133829 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:22.133829 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:35:22.222734 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:35:22.250710 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:35:22.250710 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:35:22.353648 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:35:22.362643 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:35:05.359437 => 2023-04-20 11:35:22.362643
[0m11:35:22.363644 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:35:22.469857 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b158c14e-fc2b-431f-b7eb-d7de288053d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDE0F64F0>]}
[0m11:35:22.470858 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 100[0m in 17.17s]
[0m11:35:22.472894 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:35:22.474858 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:35:22.475977 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:35:22.477896 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:35:22.478856 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:35:22.496860 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:35:22.497892 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:35:22.478856 => 2023-04-20 11:35:22.497892
[0m11:35:22.498856 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:35:22.541697 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:35:22.542498 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:35:22.542498 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:35:23.341467 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:35:23.344508 [info ] [Thread-3  ]:   => 0 record(s) to merge
[0m11:35:23.346497 [info ] [Thread-3  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m11:35:23.348595 [debug] [Thread-3  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m11:35:23.353700 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:35:23.354465 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m11:35:23.450025 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:35:23.450025 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:35:23.450983 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO_DWH.S_conso_client);
[0m11:35:23.690928 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:35:23.692552 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:35:23.692577 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m11:35:23.765507 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:35:23.766521 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:35:23.767121 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m11:35:23.832645 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:35:23.834734 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:35:22.499894 => 2023-04-20 11:35:23.834734
[0m11:35:23.835748 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:35:23.952667 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b158c14e-fc2b-431f-b7eb-d7de288053d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDE242370>]}
[0m11:35:23.954116 [info ] [Thread-3  ]: 2 of 2 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 1.48s]
[0m11:35:23.955675 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:35:23.957669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:35:23.959663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:23.960673 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:35:23.960673 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:35:23.961660 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:35:23.961726 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:35:23.961726 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:35:23.962661 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:35:23.962661 [info ] [MainThread]: 
[0m11:35:23.964661 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 20.68 seconds (20.68s).
[0m11:35:23.965925 [debug] [MainThread]: Command end result
[0m11:35:23.980967 [info ] [MainThread]: 
[0m11:35:23.981964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:23.982963 [info ] [MainThread]: 
[0m11:35:23.985952 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:35:23.989977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDE2BBC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDE2457C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDE112220>]}
[0m11:35:23.990884 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:37:01.539811 | cabadced-6440-4220-bc02-a36117baca80 ==============================
[0m11:37:01.539811 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:37:01.542413 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 100', 'select': ['add_clients+'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:37:01.542413 [debug] [MainThread]: Tracking: tracking
[0m11:37:01.543455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C633C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C633FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C633EB0>]}
[0m11:37:01.570337 [debug] [MainThread]: checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd, vars: {'nb_clients': 100}, profile: None, target: None, version: 1.4.6
[0m11:37:01.667146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:01.667428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:01.675431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cabadced-6440-4220-bc02-a36117baca80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C70DE50>]}
[0m11:37:01.686429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cabadced-6440-4220-bc02-a36117baca80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C6F9040>]}
[0m11:37:01.686429 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:37:01.688432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cabadced-6440-4220-bc02-a36117baca80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C6F9130>]}
[0m11:37:01.689432 [info ] [MainThread]: 
[0m11:37:01.692431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:01.694548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:37:01.711498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:37:01.722846 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:37:01.728760 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:37:01.729864 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:37:01.729864 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:37:01.730762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:01.730762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:02.815266 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:37:02.817271 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:37:02.846423 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:37:02.848520 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:37:02.948561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:37:02.951535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:37:02.964333 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:37:02.967374 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:37:02.968364 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:37:02.968931 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:37:02.969336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:02.969336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:03.624959 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:37:03.631299 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:37:03.784573 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:37:03.787571 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:37:03.883593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cabadced-6440-4220-bc02-a36117baca80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C65CC10>]}
[0m11:37:03.884507 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:37:03.885596 [info ] [MainThread]: 
[0m11:37:03.894507 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:37:03.895509 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:37:03.898559 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:37:03.898559 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:37:03.947382 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:37:03.950281 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:37:03.899802 => 2023-04-20 11:37:03.950281
[0m11:37:03.951392 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:37:04.036483 [debug] [Thread-1  ]: Writing runtime python for node "model.incr_stream.add_clients"
[0m11:37:04.040249 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:04.041288 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 100}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients", create_temp_table=False)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:37:04.041288 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:37:19.464505 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 15 seconds
[0m11:37:19.479416 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:19.479502 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:37:19.543081 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:19.574513 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:19.574617 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:37:19.653788 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:19.661938 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:37:03.952276 => 2023-04-20 11:37:19.661938
[0m11:37:19.662787 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:37:19.753424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cabadced-6440-4220-bc02-a36117baca80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C9A4550>]}
[0m11:37:19.754604 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 1[0m in 15.86s]
[0m11:37:19.757421 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:37:19.758446 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:37:19.759421 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:37:19.760415 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:37:19.761419 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:37:19.772454 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:37:19.773712 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:37:19.761419 => 2023-04-20 11:37:19.773712
[0m11:37:19.773712 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:37:19.810955 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:19.811703 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:37:19.811703 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:37:20.766924 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:37:20.771439 [info ] [Thread-3  ]:   => 0 record(s) to merge
[0m11:37:20.774473 [info ] [Thread-3  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m11:37:20.776309 [debug] [Thread-3  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m11:37:20.781314 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:20.782470 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m11:37:20.892307 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:20.893244 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:20.893244 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m11:37:20.991912 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:20.993765 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:20.995634 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m11:37:21.466265 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:21.467309 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:21.467309 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO.add_clients);
[0m11:37:21.666584 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:21.667629 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:21.667629 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m11:37:22.362676 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:37:22.363605 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:22.364568 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m11:37:22.430636 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:22.433685 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:37:19.774685 => 2023-04-20 11:37:22.433685
[0m11:37:22.434496 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:37:22.537859 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cabadced-6440-4220-bc02-a36117baca80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50CB14A30>]}
[0m11:37:22.539427 [info ] [Thread-3  ]: 2 of 2 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.78s]
[0m11:37:22.541806 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:37:22.545169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:22.545864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:22.546813 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:37:22.546813 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:37:22.547844 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:37:22.547844 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:37:22.548837 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:37:22.548837 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:37:22.549809 [info ] [MainThread]: 
[0m11:37:22.551810 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 20.86 seconds (20.86s).
[0m11:37:22.552808 [debug] [MainThread]: Command end result
[0m11:37:22.575808 [info ] [MainThread]: 
[0m11:37:22.579810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:22.584837 [info ] [MainThread]: 
[0m11:37:22.586782 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:37:22.591779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50C633C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50CACCC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50CACC910>]}
[0m11:37:22.592779 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:37:38.468735 | 8a9720cd-8cf0-421d-a8dd-104b67a3661f ==============================
[0m11:37:38.468735 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:37:38.470783 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 100', 'select': ['add_clients+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:37:38.471703 [debug] [MainThread]: Tracking: tracking
[0m11:37:38.471703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2A43BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2A43FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2A43E80>]}
[0m11:37:38.498256 [debug] [MainThread]: checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd, vars: {'nb_clients': 100}, profile: None, target: None, version: 1.4.6
[0m11:37:38.595265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:38.595265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:38.603265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a9720cd-8cf0-421d-a8dd-104b67a3661f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2B1DE20>]}
[0m11:37:38.615793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a9720cd-8cf0-421d-a8dd-104b67a3661f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2B09070>]}
[0m11:37:38.615793 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:37:38.617657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a9720cd-8cf0-421d-a8dd-104b67a3661f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2B09100>]}
[0m11:37:38.618696 [info ] [MainThread]: 
[0m11:37:38.620675 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:38.622657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:37:38.641546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:37:38.647958 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:37:38.651844 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:37:38.652408 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:37:38.652408 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:37:38.652826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:38.652826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:39.650028 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:37:39.652024 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:37:39.667705 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:37:39.669701 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:37:39.840662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:37:39.843151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:37:39.851772 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:37:39.854660 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:37:39.855933 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:37:39.855933 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:37:39.856735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:39.856735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:40.472677 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:37:40.475749 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:37:40.552700 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:37:40.556570 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:37:40.663613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a9720cd-8cf0-421d-a8dd-104b67a3661f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2A6CBE0>]}
[0m11:37:40.665642 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:37:40.666612 [info ] [MainThread]: 
[0m11:37:40.676611 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:37:40.676611 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:37:40.683799 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:37:40.684769 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:37:40.733606 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:37:40.735612 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:37:40.685769 => 2023-04-20 11:37:40.735612
[0m11:37:40.735612 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:37:40.827729 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:40.827729 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 100}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:37:40.828730 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:37:56.707725 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 16 seconds
[0m11:37:56.721748 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:56.722748 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:37:56.798576 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:37:56.805532 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:56.806526 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:37:56.927901 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:37:56.941424 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:56.941424 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:37:57.016513 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:37:57.041751 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:37:57.044399 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:57.044399 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:37:57.146420 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:57.146420 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:57.147118 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:37:57.753218 [debug] [Thread-1  ]: SQL status: SUCCESS 100 in 1 seconds
[0m11:37:57.754720 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:57.755217 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:37:58.011554 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:58.022575 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:58.022575 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:37:58.121818 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:58.149398 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:37:58.150192 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:37:58.237918 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:58.246536 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:37:40.735612 => 2023-04-20 11:37:58.246536
[0m11:37:58.247618 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:37:58.347205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a9720cd-8cf0-421d-a8dd-104b67a3661f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2DD12B0>]}
[0m11:37:58.347833 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 100[0m in 17.67s]
[0m11:37:58.350830 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:37:58.351833 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:37:58.352830 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:37:58.354528 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:37:58.354941 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:37:58.369100 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:37:58.371965 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:37:58.354941 => 2023-04-20 11:37:58.371965
[0m11:37:58.372905 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:37:58.415522 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:58.415522 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:37:58.415522 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:37:59.328146 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:37:59.330109 [info ] [Thread-3  ]:   => 100 record(s) to merge
[0m11:37:59.335636 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:59.335636 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m11:37:59.417798 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:37:59.421085 [debug] [Thread-3  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m11:37:59.423799 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:59.424793 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m11:37:59.516791 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:59.517822 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:59.518267 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO_DWH.S_conso_client);
[0m11:37:59.759383 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:59.760600 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:59.760600 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m11:37:59.838479 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:37:59.838479 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:37:59.838479 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SETTARGET.ID = SOURCE.ID,TARGET.FIRST_NAME = SOURCE.FIRST_NAME,TARGET.LAST_NAME = SOURCE.LAST_NAME,TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m11:37:59.911379 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01abc099-3201-bafa-0001-2d16003743b2
[0m11:37:59.912379 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 4 unexpected 'SETTARGET'.
[0m11:37:59.912379 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:37:58.372905 => 2023-04-20 11:37:59.912379
[0m11:37:59.913379 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:38:00.004636 [debug] [Thread-3  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 4 unexpected 'SETTARGET'.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m11:38:00.004636 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a9720cd-8cf0-421d-a8dd-104b67a3661f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2D8EFD0>]}
[0m11:38:00.005457 [error] [Thread-3  ]: 2 of 2 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.65s]
[0m11:38:00.006457 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:38:00.008459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:00.009462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:00.010458 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:38:00.010458 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:38:00.011535 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:38:00.011535 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:38:00.012603 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:38:00.013473 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:38:00.014507 [info ] [MainThread]: 
[0m11:38:00.016928 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 21.39 seconds (21.39s).
[0m11:38:00.018460 [debug] [MainThread]: Command end result
[0m11:38:00.043710 [info ] [MainThread]: 
[0m11:38:00.045672 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:38:00.046855 [info ] [MainThread]: 
[0m11:38:00.050476 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m11:38:00.051753 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:38:00.054678 [error] [MainThread]:   syntax error line 8 at position 4 unexpected 'SETTARGET'.
[0m11:38:00.056673 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m11:38:00.057724 [info ] [MainThread]: 
[0m11:38:00.058677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:38:00.060821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2A43880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2F52D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D2F52B20>]}
[0m11:38:00.061674 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:41:31.339444 | 64147a01-7689-45ee-9a29-f3aeef930e0e ==============================
[0m11:41:31.339444 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:41:31.341409 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 100', 'select': ['add_clients+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:41:31.342411 [debug] [MainThread]: Tracking: tracking
[0m11:41:31.342411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C4B90580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C4B90F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C4B90E20>]}
[0m11:41:31.363415 [debug] [MainThread]: checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd, vars: {'nb_clients': 100}, profile: None, target: None, version: 1.4.6
[0m11:41:31.456680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:31.457716 [debug] [MainThread]: Partial parsing: updated file: incr_stream://macros\materializations\incremental_stream.sql
[0m11:41:31.493713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64147a01-7689-45ee-9a29-f3aeef930e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C4C9CE50>]}
[0m11:41:31.503638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64147a01-7689-45ee-9a29-f3aeef930e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C4C5B3D0>]}
[0m11:41:31.504638 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:41:31.505638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64147a01-7689-45ee-9a29-f3aeef930e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C4C5B4C0>]}
[0m11:41:31.506637 [info ] [MainThread]: 
[0m11:41:31.508639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:31.510638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:41:31.526531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:41:31.534523 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:41:31.537906 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:41:31.538529 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:41:31.538529 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:41:31.539590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:31.539590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:32.705977 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:41:32.707971 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:41:33.149936 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m11:41:33.151950 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:41:33.266498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:41:33.270432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:41:33.279218 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:41:33.282207 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:41:33.283373 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:41:33.283373 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:41:33.284157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:33.284157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:33.936559 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:41:33.939521 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:41:34.059928 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:41:34.061998 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:41:34.316439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64147a01-7689-45ee-9a29-f3aeef930e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C4C99A30>]}
[0m11:41:34.318460 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:41:34.319472 [info ] [MainThread]: 
[0m11:41:34.329453 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:41:34.330440 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:41:34.332439 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:41:34.332439 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:41:34.370439 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:41:34.373441 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:41:34.332439 => 2023-04-20 11:41:34.373441
[0m11:41:34.373441 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:41:34.459678 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:34.459678 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 100}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:41:34.460675 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:41:51.069887 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 17 seconds
[0m11:41:51.092903 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:51.093789 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:41:51.175128 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:41:51.180089 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:51.181063 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:41:51.343861 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:41:51.356955 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:51.356955 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:41:51.418005 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:41:51.443864 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:41:51.446180 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:51.446180 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:41:51.536092 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:41:51.537134 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:51.537889 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:41:52.084029 [debug] [Thread-1  ]: SQL status: SUCCESS 100 in 1 seconds
[0m11:41:52.085208 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:52.086223 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:41:52.344400 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:41:52.361177 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:52.361412 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:41:52.446984 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:41:52.474310 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:41:52.474310 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:41:52.589896 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:41:52.598889 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:41:34.375460 => 2023-04-20 11:41:52.598889
[0m11:41:52.598889 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:41:53.326847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64147a01-7689-45ee-9a29-f3aeef930e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C4F3ED60>]}
[0m11:41:53.327879 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 100[0m in 19.00s]
[0m11:41:53.330845 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:41:53.332848 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:41:53.333850 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:41:53.335897 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:41:53.335897 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:41:53.352900 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:41:53.355002 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:41:53.336928 => 2023-04-20 11:41:53.355002
[0m11:41:53.355002 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:41:53.391759 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:41:53.392776 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:41:53.394838 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:41:54.450707 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:41:54.452698 [info ] [Thread-3  ]:   => 200 record(s) to merge
[0m11:41:54.458003 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:41:54.458003 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m11:41:54.541336 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:41:54.544369 [debug] [Thread-3  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m11:41:54.549196 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:41:54.550197 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m11:41:54.651168 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:41:54.651168 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:41:54.652169 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO_DWH.S_conso_client);
[0m11:41:54.934442 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:41:54.935443 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:41:54.936442 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m11:41:55.013312 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:41:55.014129 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:41:55.014129 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SETTARGET.ID = SOURCE.ID,TARGET.FIRST_NAME = SOURCE.FIRST_NAME,TARGET.LAST_NAME = SOURCE.LAST_NAME,TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m11:41:55.590852 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01abc09d-3201-bafa-0001-2d16003743c6
[0m11:41:55.591675 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 4 unexpected 'SETTARGET'.
[0m11:41:55.592676 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:41:53.355978 => 2023-04-20 11:41:55.592676
[0m11:41:55.592676 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:41:55.689764 [debug] [Thread-3  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 4 unexpected 'SETTARGET'.
  compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m11:41:55.690761 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64147a01-7689-45ee-9a29-f3aeef930e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C5034730>]}
[0m11:41:55.691767 [error] [Thread-3  ]: 2 of 2 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 2.36s]
[0m11:41:55.692772 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:41:55.694764 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:55.695878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:55.695878 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:41:55.696764 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:41:55.696764 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:41:55.696764 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:41:55.696764 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:41:55.697764 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:41:55.697764 [info ] [MainThread]: 
[0m11:41:55.699237 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 24.19 seconds (24.19s).
[0m11:41:55.699761 [debug] [MainThread]: Command end result
[0m11:41:55.710978 [info ] [MainThread]: 
[0m11:41:55.712116 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:55.712975 [info ] [MainThread]: 
[0m11:41:55.713978 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m11:41:55.714978 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:41:55.716698 [error] [MainThread]:   syntax error line 8 at position 4 unexpected 'SETTARGET'.
[0m11:41:55.716975 [error] [MainThread]:   compiled Code at target\run\incr_stream\models\dwh\conso_client.sql
[0m11:41:55.719980 [info ] [MainThread]: 
[0m11:41:55.722137 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:41:55.722976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C501E970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C501E6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C501E880>]}
[0m11:41:55.724377 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:42:27.272926 | 978a101f-e510-461a-a4d7-8bf9b6132684 ==============================
[0m11:42:27.272926 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:42:27.274795 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 100', 'select': ['add_clients+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:42:27.275713 [debug] [MainThread]: Tracking: tracking
[0m11:42:27.275713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59025C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59025FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59025EB0>]}
[0m11:42:27.295712 [debug] [MainThread]: checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd, vars: {'nb_clients': 100}, profile: None, target: None, version: 1.4.6
[0m11:42:27.398199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:42:27.399231 [debug] [MainThread]: Partial parsing: updated file: incr_stream://macros\materializations\incremental_stream.sql
[0m11:42:27.435930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '978a101f-e510-461a-a4d7-8bf9b6132684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59110EE0>]}
[0m11:42:27.447703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '978a101f-e510-461a-a4d7-8bf9b6132684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB590A6250>]}
[0m11:42:27.448703 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:42:27.449702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '978a101f-e510-461a-a4d7-8bf9b6132684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB590A6220>]}
[0m11:42:27.450702 [info ] [MainThread]: 
[0m11:42:27.452742 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:42:27.454744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:42:27.471705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:42:27.479741 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:42:27.484686 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:42:27.487692 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:42:27.488701 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:42:27.489061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:27.490170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:28.562584 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:42:28.566201 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:42:28.570352 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:42:28.573391 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:42:28.709182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:42:28.712205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:42:28.725154 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:42:28.729339 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:42:28.730148 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:42:28.731150 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:42:28.731150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:28.732151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:29.527659 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:42:29.534663 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:42:29.729594 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:42:29.733021 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:42:29.853931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '978a101f-e510-461a-a4d7-8bf9b6132684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB590C5D30>]}
[0m11:42:29.855977 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:42:29.857341 [info ] [MainThread]: 
[0m11:42:29.867923 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:42:29.868924 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:42:29.871943 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:42:29.873083 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:42:29.923631 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:42:29.925481 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:42:29.873947 => 2023-04-20 11:42:29.925481
[0m11:42:29.926471 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:42:30.014981 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:30.014981 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 100}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:42:30.015879 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:42:46.362473 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 16 seconds
[0m11:42:46.376485 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:46.377485 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:42:46.446995 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:42:46.453986 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:46.453986 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:42:46.557159 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:42:46.578241 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:46.578241 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:42:46.643204 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:42:46.672085 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:42:46.674040 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:46.675039 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:42:46.764313 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:42:46.765311 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:46.765311 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:42:47.253895 [debug] [Thread-1  ]: SQL status: SUCCESS 100 in 0 seconds
[0m11:42:47.254891 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:47.254891 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:42:47.491055 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:42:47.517081 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:47.518601 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:42:47.610045 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:42:47.636063 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:42:47.636063 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:42:47.713908 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:42:47.728287 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:42:29.926471 => 2023-04-20 11:42:47.728287
[0m11:42:47.729091 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:42:47.829010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '978a101f-e510-461a-a4d7-8bf9b6132684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5910D2E0>]}
[0m11:42:47.829010 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 100[0m in 17.96s]
[0m11:42:47.832010 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:42:47.834009 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:42:47.834009 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:42:47.836012 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:42:47.836012 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:42:47.861356 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:42:47.865343 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:42:47.837013 => 2023-04-20 11:42:47.864348
[0m11:42:47.865343 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:42:47.920187 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:42:47.920187 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:42:47.921186 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:42:48.939953 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:42:48.942884 [info ] [Thread-3  ]:   => 300 record(s) to merge
[0m11:42:48.946886 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:42:48.946886 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m11:42:49.027805 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:42:49.030804 [debug] [Thread-3  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m11:42:49.036110 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:42:49.036808 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m11:42:49.159255 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:42:49.160255 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:42:49.161023 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO_DWH.S_conso_client);
[0m11:42:49.413973 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:42:49.415003 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:42:49.415744 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m11:42:49.480047 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:42:49.481016 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:42:49.481016 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m11:42:50.203895 [debug] [Thread-3  ]: SQL status: SUCCESS 300 in 1 seconds
[0m11:42:50.206869 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:42:47.865343 => 2023-04-20 11:42:50.206869
[0m11:42:50.207868 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:42:50.314428 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '978a101f-e510-461a-a4d7-8bf9b6132684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59538FA0>]}
[0m11:42:50.314428 [info ] [Thread-3  ]: 2 of 2 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 300[0m in 2.48s]
[0m11:42:50.315427 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:42:50.317430 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:42:50.318429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:50.319432 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:42:50.319432 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:42:50.319432 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:42:50.320433 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:42:50.321056 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:42:50.321480 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:42:50.323473 [info ] [MainThread]: 
[0m11:42:50.326430 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 22.87 seconds (22.87s).
[0m11:42:50.327578 [debug] [MainThread]: Command end result
[0m11:42:50.344715 [info ] [MainThread]: 
[0m11:42:50.345270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:50.347310 [info ] [MainThread]: 
[0m11:42:50.348271 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:42:50.349818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59386550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB590BBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5910D220>]}
[0m11:42:50.350266 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:45:09.964340 | 1c8cc5a0-3648-4670-90e6-210b1285f2e1 ==============================
[0m11:45:09.964340 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:45:09.966587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 55', 'select': ['add_clients+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:45:09.967412 [debug] [MainThread]: Tracking: tracking
[0m11:45:09.967412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A23156D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A2315BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A2315FA0>]}
[0m11:45:09.991612 [debug] [MainThread]: checksum: 3a2285e687e4e1e5b8afd4454e343c8ec66f000fbc20d920c3c86982c3aa4354, vars: {'nb_clients': 55}, profile: None, target: None, version: 1.4.6
[0m11:45:10.001247 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:45:10.005477 [debug] [MainThread]: previous checksum: 9666b9990fc52873d5f4593f74015f9acde9ba47bdfdc8240488104448ff52dd, current checksum: 3a2285e687e4e1e5b8afd4454e343c8ec66f000fbc20d920c3c86982c3aa4354
[0m11:45:10.006943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c8cc5a0-3648-4670-90e6-210b1285f2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A2309430>]}
[0m11:45:11.112309 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m11:45:11.136548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m11:45:11.250989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8cc5a0-3648-4670-90e6-210b1285f2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A2383070>]}
[0m11:45:11.262993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8cc5a0-3648-4670-90e6-210b1285f2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A24328E0>]}
[0m11:45:11.263988 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:45:11.264991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8cc5a0-3648-4670-90e6-210b1285f2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A23097F0>]}
[0m11:45:11.266028 [info ] [MainThread]: 
[0m11:45:11.268533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:45:11.271529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:45:11.287528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:45:11.299567 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:45:11.304532 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:45:11.304532 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:45:11.305565 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:45:11.305565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:11.306638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:12.368927 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:45:12.370924 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:45:12.378879 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:45:12.380911 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:45:12.511623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:45:12.512622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:45:12.522623 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:45:12.525610 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:45:12.526266 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:45:12.526587 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:45:12.526587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:12.526587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:13.435928 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:45:13.437867 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:45:13.495403 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:45:13.498370 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:45:13.645111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8cc5a0-3648-4670-90e6-210b1285f2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A26149D0>]}
[0m11:45:13.646645 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:45:13.647638 [info ] [MainThread]: 
[0m11:45:13.658755 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:45:13.659753 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:45:13.665680 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:45:13.667563 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:45:13.718783 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:45:13.721560 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:45:13.667935 => 2023-04-20 11:45:13.721560
[0m11:45:13.722796 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:45:13.812943 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:13.812943 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 55}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:45:13.812943 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:45:27.680115 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 14 seconds
[0m11:45:27.691569 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:27.692557 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:45:27.766308 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:45:27.773234 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:27.773234 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:45:27.898638 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:45:27.909565 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:27.910566 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:45:27.979701 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:45:28.007649 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:45:28.009649 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:28.009649 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:45:28.119826 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:45:28.120823 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:28.120823 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:45:28.811669 [debug] [Thread-1  ]: SQL status: SUCCESS 55 in 1 seconds
[0m11:45:28.811753 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:28.811753 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:45:29.130616 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:45:29.148584 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:29.149585 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:45:29.238881 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:45:29.264573 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:45:29.265630 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:45:29.340016 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:45:29.351232 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:45:13.722796 => 2023-04-20 11:45:29.351232
[0m11:45:29.352012 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:45:29.451609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8cc5a0-3648-4670-90e6-210b1285f2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A26F5D30>]}
[0m11:45:29.452635 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 55[0m in 15.79s]
[0m11:45:29.456828 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:45:29.458576 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:45:29.459579 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:45:29.462579 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:45:29.463579 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:45:29.471563 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:45:29.474564 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:45:29.464577 => 2023-04-20 11:45:29.474564
[0m11:45:29.475564 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:45:29.515580 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:45:29.515580 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:45:29.515580 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:45:30.486646 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:45:30.488645 [info ] [Thread-3  ]:   => 55 record(s) to merge
[0m11:45:30.492642 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:45:30.492642 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m11:45:30.666871 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:45:30.670919 [debug] [Thread-3  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m11:45:30.675990 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:45:30.675990 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m11:45:30.775656 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:45:30.776714 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:45:30.776714 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO_DWH.S_conso_client);
[0m11:45:31.228637 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:45:31.229546 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:45:31.229546 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m11:45:31.314727 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:45:31.314727 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:45:31.315808 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m11:45:32.028845 [debug] [Thread-3  ]: SQL status: SUCCESS 55 in 1 seconds
[0m11:45:32.030573 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:45:29.475564 => 2023-04-20 11:45:32.030573
[0m11:45:32.030573 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:45:32.134049 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8cc5a0-3648-4670-90e6-210b1285f2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A26FBC70>]}
[0m11:45:32.134692 [info ] [Thread-3  ]: 2 of 2 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 55[0m in 2.67s]
[0m11:45:32.135697 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:45:32.136691 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:45:32.137693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:32.138696 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:45:32.138696 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:45:32.138696 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:45:32.138696 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:45:32.138696 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:45:32.139822 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:45:32.139822 [info ] [MainThread]: 
[0m11:45:32.140692 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 20.87 seconds (20.87s).
[0m11:45:32.142881 [debug] [MainThread]: Command end result
[0m11:45:32.155824 [info ] [MainThread]: 
[0m11:45:32.156822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:32.159838 [info ] [MainThread]: 
[0m11:45:32.162825 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:45:32.164828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A26B0EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A285D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143A2741370>]}
[0m11:45:32.164828 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:56:56.327070 | d0af22cf-f479-4d09-b937-e0e08324cce5 ==============================
[0m11:56:56.327070 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:56:56.329051 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['add_clients+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:56:56.330038 [debug] [MainThread]: Tracking: tracking
[0m11:56:56.330038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BAFD3C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BAFD3B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BAFD32E0>]}
[0m11:56:56.350037 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m11:56:56.367083 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:56:56.369528 [debug] [MainThread]: previous checksum: 3a2285e687e4e1e5b8afd4454e343c8ec66f000fbc20d920c3c86982c3aa4354, current checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151
[0m11:56:56.370278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0af22cf-f479-4d09-b937-e0e08324cce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BAFE9400>]}
[0m11:56:57.449704 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m11:56:57.475547 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m11:56:57.578959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0af22cf-f479-4d09-b937-e0e08324cce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB05DBE0>]}
[0m11:56:57.590966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0af22cf-f479-4d09-b937-e0e08324cce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB1118E0>]}
[0m11:56:57.590966 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:56:57.592966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0af22cf-f479-4d09-b937-e0e08324cce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BAFE9910>]}
[0m11:56:57.593970 [info ] [MainThread]: 
[0m11:56:57.600086 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:57.604973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:56:57.628005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:56:57.654318 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:56:57.657456 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:56:57.658492 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:56:57.659464 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:56:57.660470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:57.661465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:58.914469 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:56:58.918649 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:56:58.919832 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:56:58.925514 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:56:59.077673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:56:59.085686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:56:59.115449 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:56:59.119528 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:56:59.120548 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:56:59.121759 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:56:59.121759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:59.122530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:00.084011 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:57:00.088417 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:57:00.222034 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:57:00.225035 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:57:00.341508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0af22cf-f479-4d09-b937-e0e08324cce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB175A90>]}
[0m11:57:00.342506 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:57:00.344508 [info ] [MainThread]: 
[0m11:57:00.361104 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:57:00.362106 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:57:00.368551 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:57:00.369554 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:57:00.475019 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:57:00.483004 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:57:00.370556 => 2023-04-20 11:57:00.482417
[0m11:57:00.484046 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:57:00.644485 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:00.645074 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 70}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = True

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients__dbt_tmp", create_temp_table=True)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:57:00.646073 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:57:28.190330 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 28 seconds
[0m11:57:28.207154 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:28.208361 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients__dbt_tmp
[0m11:57:28.280409 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:57:28.288463 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:28.289409 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table PERSO.ARO.add_clients
[0m11:57:28.351266 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:57:28.364244 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:28.364244 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
describe table "PERSO"."ARO"."ADD_CLIENTS"
[0m11:57:28.418611 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:57:28.443358 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.add_clients"
[0m11:57:28.447430 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:28.447430 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
-- back compat for old kwarg name
  
  begin;
[0m11:57:28.539567 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:57:28.540571 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:28.541571 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
insert into PERSO.ARO.add_clients ("ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE")
        (
            select "ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"
            from PERSO.ARO.add_clients__dbt_tmp
        );
[0m11:57:29.753333 [debug] [Thread-1  ]: SQL status: SUCCESS 70 in 1 seconds
[0m11:57:29.754330 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:29.755330 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
COMMIT
[0m11:57:30.006096 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:57:30.018196 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:30.019194 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:57:30.109217 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:57:30.138240 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:57:30.139246 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:57:30.207543 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:57:30.216472 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:57:00.485003 => 2023-04-20 11:57:30.216001
[0m11:57:30.217543 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:57:30.328289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0af22cf-f479-4d09-b937-e0e08324cce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB175BB0>]}
[0m11:57:30.329050 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 70[0m in 29.96s]
[0m11:57:30.331267 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:57:30.333283 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:57:30.334654 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:57:30.340870 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:57:30.341268 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:57:30.353498 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:57:30.360021 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:57:30.342267 => 2023-04-20 11:57:30.360021
[0m11:57:30.360021 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:57:30.428271 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:57:30.429135 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:57:30.429135 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:57:31.642012 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:57:31.644991 [info ] [Thread-3  ]:   => 70 record(s) to merge
[0m11:57:31.650964 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:57:31.651963 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
describe table PERSO.ARO_DWH.V_conso_client
[0m11:57:31.733941 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0 seconds
[0m11:57:31.736033 [debug] [Thread-3  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m11:57:31.739939 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:57:31.739939 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m11:57:31.831162 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:57:31.832162 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:57:31.832162 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO_DWH.S_conso_client);
[0m11:57:32.059156 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:57:32.059156 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:57:32.060155 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m11:57:32.163498 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:57:32.165257 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:57:32.165499 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
MERGE INTO  PERSO.ARO_DWH.conso_client TARGET
    USING PERSO.ARO_DWH.V_conso_client SOURCE
    ON (
    TARGET.ID = SOURCE.ID
    )
    -- Mode UPDATE
    WHEN MATCHED THEN UPDATE
    SET
    TARGET.ID = SOURCE.ID,
    TARGET.FIRST_NAME = SOURCE.FIRST_NAME,
    TARGET.LAST_NAME = SOURCE.LAST_NAME,
    TARGET.BIRTHDATE = SOURCE.BIRTHDATE
    -- Mode INSERT
    WHEN NOT MATCHED THEN INSERT
    ( 
    ID,
    FIRST_NAME,
    LAST_NAME,
    BIRTHDATE
    )
    VALUES
    (
    SOURCE.ID,
    SOURCE.FIRST_NAME,
    SOURCE.LAST_NAME,
    SOURCE.BIRTHDATE
    )
    ;
[0m11:57:33.198104 [debug] [Thread-3  ]: SQL status: SUCCESS 70 in 1 seconds
[0m11:57:33.200050 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:57:30.361026 => 2023-04-20 11:57:33.200050
[0m11:57:33.201048 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:57:33.309194 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0af22cf-f479-4d09-b937-e0e08324cce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB4CB790>]}
[0m11:57:33.310190 [info ] [Thread-3  ]: 2 of 2 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 70[0m in 2.97s]
[0m11:57:33.311191 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:57:33.314190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:57:33.315188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:33.316190 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:57:33.316190 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:57:33.316190 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:57:33.317187 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:57:33.317187 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:57:33.317187 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:57:33.318190 [info ] [MainThread]: 
[0m11:57:33.319187 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 35.72 seconds (35.72s).
[0m11:57:33.320189 [debug] [MainThread]: Command end result
[0m11:57:33.333207 [info ] [MainThread]: 
[0m11:57:33.334201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:33.336240 [info ] [MainThread]: 
[0m11:57:33.338250 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:57:33.339251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB4E3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB53E880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB420370>]}
[0m11:57:33.340331 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 11:59:08.175408 | b313635b-b66a-4dc3-941f-9fa058029e93 ==============================
[0m11:59:08.175408 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:59:08.177352 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['add_clients+'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:59:08.178466 [debug] [MainThread]: Tracking: tracking
[0m11:59:08.178466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1DA5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1DA5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1DA59A0>]}
[0m11:59:08.209507 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m11:59:08.324158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:59:08.324158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:59:08.331155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b313635b-b66a-4dc3-941f-9fa058029e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1E5DDC0>]}
[0m11:59:08.341304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b313635b-b66a-4dc3-941f-9fa058029e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1E3CFA0>]}
[0m11:59:08.341715 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:59:08.342304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b313635b-b66a-4dc3-941f-9fa058029e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1E4A0A0>]}
[0m11:59:08.344305 [info ] [MainThread]: 
[0m11:59:08.347331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:59:08.349341 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:59:08.361442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m11:59:08.403199 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:59:08.415546 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m11:59:08.415546 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:59:08.416607 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m11:59:08.416607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:08.417540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:09.481321 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:59:09.484232 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:59:09.520842 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:59:09.522874 [debug] [ThreadPool]: On list_PERSO: Close
[0m11:59:09.654508 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m11:59:09.656478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m11:59:09.664512 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m11:59:09.667244 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m11:59:09.668146 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m11:59:09.669150 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m11:59:09.670448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:09.671535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:10.346387 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:59:10.348357 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m11:59:10.565617 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:59:10.571112 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m11:59:10.683104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b313635b-b66a-4dc3-941f-9fa058029e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1EC4520>]}
[0m11:59:10.684138 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m11:59:10.686107 [info ] [MainThread]: 
[0m11:59:10.698099 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m11:59:10.699401 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m11:59:10.702102 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m11:59:10.704125 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m11:59:10.746595 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m11:59:10.749173 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 11:59:10.705152 => 2023-04-20 11:59:10.749173
[0m11:59:10.750168 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m11:59:10.845210 [debug] [Thread-1  ]: Writing runtime python for node "model.incr_stream.add_clients"
[0m11:59:10.849226 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:59:10.849446 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 70}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients", create_temp_table=False)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m11:59:10.850228 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:59:27.073419 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 16 seconds
[0m11:59:27.102573 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:59:27.103567 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m11:59:27.156450 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:59:27.194611 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m11:59:27.194611 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m11:59:27.282205 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:59:27.294202 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 11:59:10.750168 => 2023-04-20 11:59:27.294202
[0m11:59:27.294677 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m11:59:27.510361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b313635b-b66a-4dc3-941f-9fa058029e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1EAC8B0>]}
[0m11:59:27.511361 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 1[0m in 16.81s]
[0m11:59:27.515354 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m11:59:27.517038 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m11:59:27.518569 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m11:59:27.521572 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m11:59:27.522608 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m11:59:27.541636 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m11:59:27.543257 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 11:59:27.522608 => 2023-04-20 11:59:27.542639
[0m11:59:27.543644 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m11:59:27.587350 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m11:59:27.588613 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m11:59:27.589309 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:59:28.329652 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01abc0af-3201-ba10-0001-2d1600372b8a
[0m11:59:28.330651 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m11:59:28.331649 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 11:59:27.543644 => 2023-04-20 11:59:28.331649
[0m11:59:28.331649 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m11:59:28.496659 [debug] [Thread-3  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m11:59:28.498670 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b313635b-b66a-4dc3-941f-9fa058029e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C22781F0>]}
[0m11:59:28.499851 [error] [Thread-3  ]: 2 of 2 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.98s]
[0m11:59:28.501722 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m11:59:28.504670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:59:28.505665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:28.505665 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:59:28.506663 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m11:59:28.506663 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m11:59:28.506663 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m11:59:28.507665 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m11:59:28.507665 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m11:59:28.508664 [info ] [MainThread]: 
[0m11:59:28.509667 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 20.16 seconds (20.16s).
[0m11:59:28.510665 [debug] [MainThread]: Command end result
[0m11:59:28.528220 [info ] [MainThread]: 
[0m11:59:28.530359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:59:28.533454 [info ] [MainThread]: 
[0m11:59:28.536232 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m11:59:28.540301 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m11:59:28.542298 [info ] [MainThread]: 
[0m11:59:28.544625 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:59:28.546293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1EA4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C1E642B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C222A910>]}
[0m11:59:28.550250 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:04:59.108862 | 9148d8a4-4ca9-47f4-aaac-1eb36134cd73 ==============================
[0m12:04:59.108862 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:04:59.110825 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['add_clients+'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:04:59.110825 [debug] [MainThread]: Tracking: tracking
[0m12:04:59.111828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002491743A640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002491743AFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002491743AF10>]}
[0m12:04:59.136063 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:04:59.223342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:59.223342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:59.230343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9148d8a4-4ca9-47f4-aaac-1eb36134cd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002491750DDF0>]}
[0m12:04:59.239970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9148d8a4-4ca9-47f4-aaac-1eb36134cd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249174FA040>]}
[0m12:04:59.239970 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:04:59.241164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9148d8a4-4ca9-47f4-aaac-1eb36134cd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249174FA0D0>]}
[0m12:04:59.242977 [info ] [MainThread]: 
[0m12:04:59.245498 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:04:59.246970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:04:59.269712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:04:59.272662 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:04:59.275658 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:04:59.277011 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:04:59.277011 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:04:59.277011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:59.277843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:00.467786 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:05:00.469777 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:05:00.529781 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:05:00.531780 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:05:00.746777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:05:00.748775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:05:00.754776 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:05:00.756777 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:05:00.757976 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:05:00.757976 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:05:00.757976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:00.758776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:01.666315 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:05:01.668314 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:05:01.699314 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:05:01.702351 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:05:01.811899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9148d8a4-4ca9-47f4-aaac-1eb36134cd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024917549F10>]}
[0m12:05:01.812899 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:05:01.813901 [info ] [MainThread]: 
[0m12:05:01.821906 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m12:05:01.822905 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m12:05:01.828913 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m12:05:01.829904 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m12:05:01.870902 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m12:05:01.872912 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 12:05:01.830904 => 2023-04-20 12:05:01.872912
[0m12:05:01.872912 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m12:05:01.969422 [debug] [Thread-1  ]: Writing runtime python for node "model.incr_stream.add_clients"
[0m12:05:01.974422 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m12:05:01.975424 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 70}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients", create_temp_table=False)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m12:05:01.975424 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:05:17.406238 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 15 seconds
[0m12:05:17.416238 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m12:05:17.417239 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m12:05:17.709268 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:05:17.750246 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m12:05:17.751332 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m12:05:17.849574 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:05:17.861579 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 12:05:01.873900 => 2023-04-20 12:05:17.861579
[0m12:05:17.861579 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m12:05:18.220801 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9148d8a4-4ca9-47f4-aaac-1eb36134cd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249177A11C0>]}
[0m12:05:18.221805 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 1[0m in 16.40s]
[0m12:05:18.223820 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m12:05:18.224806 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m12:05:18.225803 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:05:18.227800 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:05:18.228807 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m12:05:18.247510 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:05:18.249801 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:05:18.228807 => 2023-04-20 12:05:18.249416
[0m12:05:18.249801 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m12:05:18.295802 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:05:18.296804 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:05:18.296804 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:05:19.226735 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01abc0b5-3201-ba10-0001-2d1600372b9e
[0m12:05:19.227509 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:05:19.228474 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:05:18.251021 => 2023-04-20 12:05:19.228474
[0m12:05:19.228474 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m12:05:19.337478 [debug] [Thread-3  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:05:19.338494 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9148d8a4-4ca9-47f4-aaac-1eb36134cd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249178BC970>]}
[0m12:05:19.339609 [error] [Thread-3  ]: 2 of 2 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.11s]
[0m12:05:19.341476 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m12:05:19.344476 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:05:19.345477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:19.346476 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:05:19.347476 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:05:19.347771 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:05:19.348989 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:05:19.349502 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m12:05:19.349502 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:05:19.350477 [info ] [MainThread]: 
[0m12:05:19.352477 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 20.11 seconds (20.11s).
[0m12:05:19.353478 [debug] [MainThread]: Command end result
[0m12:05:19.381104 [info ] [MainThread]: 
[0m12:05:19.383786 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:05:19.385532 [info ] [MainThread]: 
[0m12:05:19.386478 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:05:19.389660 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:05:19.392630 [info ] [MainThread]: 
[0m12:05:19.402529 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:05:19.405839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249178CF940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249174EAFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249174FA070>]}
[0m12:05:19.408742 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:12:40.841599 | 08ec97b5-95d1-40f3-94e0-47eb7096174a ==============================
[0m12:12:40.841599 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:12:40.843589 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['add_clients+'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:12:40.843589 [debug] [MainThread]: Tracking: tracking
[0m12:12:40.844593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E73945CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E73945670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E73945F70>]}
[0m12:12:40.876588 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:12:40.976753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:40.976753 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:40.986786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08ec97b5-95d1-40f3-94e0-47eb7096174a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E739FDDC0>]}
[0m12:12:40.997753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08ec97b5-95d1-40f3-94e0-47eb7096174a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E739DCFA0>]}
[0m12:12:40.998754 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:12:40.999764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08ec97b5-95d1-40f3-94e0-47eb7096174a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E739EA0A0>]}
[0m12:12:41.000751 [info ] [MainThread]: 
[0m12:12:41.002753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:41.004752 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:12:41.025756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:12:41.030752 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:12:41.035169 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:12:41.035754 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:12:41.035754 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:12:41.036755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:41.036755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:42.066409 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:12:42.067927 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:12:42.471274 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:12:42.473193 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:12:42.585289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:12:42.589493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:12:42.601281 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:12:42.604328 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:12:42.605480 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:12:42.605480 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:12:42.606282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:42.607282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:43.437406 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:12:43.440439 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:12:43.517711 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:12:43.519708 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:12:43.631169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08ec97b5-95d1-40f3-94e0-47eb7096174a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E73A4AE80>]}
[0m12:12:43.632167 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:12:43.633203 [info ] [MainThread]: 
[0m12:12:43.640169 [debug] [Thread-1  ]: Began running node model.incr_stream.add_clients
[0m12:12:43.641178 [info ] [Thread-1  ]: 1 of 2 START python incremental model ARO.add_clients .......................... [RUN]
[0m12:12:43.644176 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.add_clients'
[0m12:12:43.644176 [debug] [Thread-1  ]: Began compiling node model.incr_stream.add_clients
[0m12:12:43.687204 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.add_clients"
[0m12:12:43.689172 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (compile): 2023-04-20 12:12:43.645172 => 2023-04-20 12:12:43.689172
[0m12:12:43.690514 [debug] [Thread-1  ]: Began executing node model.incr_stream.add_clients
[0m12:12:43.776770 [debug] [Thread-1  ]: Writing runtime python for node "model.incr_stream.add_clients"
[0m12:12:43.781734 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m12:12:43.782729 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
WITH add_clients__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('Faker', 'snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F
from faker import Faker


def add_clients(session, nb):
    clients = []
    for _ in range(nb):
        clients.append([fake('id'), fake('first_name'), fake('last_name'), fake('birthdate')])
    df = session.create_dataframe(clients, schema=["ID", "FIRST_NAME", "LAST_NAME", "BIRTHDATE"])
    return df
def fake(a):
    fake = Faker()
    if a=='first_name':
        return fake.first_name()
    if a=='last_name':
        return fake.last_name()
    if a=='birthdate':
        return fake.date_of_birth(minimum_age=18, maximum_age=90)
    if a=='id':
        return fake.pyint()
    else:
        return 'other'

def model(dbt, session):
    dbt.config(
        packages = ["Faker"]
    )
    dbt.config(materialized = "incremental")
    nb_clients = dbt.config.get("nb_clients")
    return add_clients(session, nb_clients)


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args,dbt_load_df_function):
    refs = {}
    key = '.'.join(args)
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {'nb_clients': 70}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "PERSO"
    schema = "ARO"
    identifier = "add_clients"
    
    def __repr__(self):
        return 'PERSO.ARO.add_clients'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    df.write.mode("overwrite").save_as_table("PERSO.ARO.add_clients", create_temp_table=False)

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL add_clients__dbt_sp();
[0m12:12:43.782729 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:12:59.115512 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 15 seconds
[0m12:12:59.125508 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m12:12:59.125508 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
drop table if exists PERSO.ARO.add_clients__dbt_tmp cascade
[0m12:12:59.273393 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:12:59.308356 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.add_clients"
[0m12:12:59.308356 [debug] [Thread-1  ]: On model.incr_stream.add_clients: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.add_clients"} */
comment on table PERSO.ARO.add_clients IS $$Add random clients to ADD_CLIENTS table$$;
[0m12:12:59.374631 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:12:59.385661 [debug] [Thread-1  ]: Timing info for model.incr_stream.add_clients (execute): 2023-04-20 12:12:43.690514 => 2023-04-20 12:12:59.385661
[0m12:12:59.386629 [debug] [Thread-1  ]: On model.incr_stream.add_clients: Close
[0m12:12:59.508234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ec97b5-95d1-40f3-94e0-47eb7096174a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E73CB53A0>]}
[0m12:12:59.510338 [info ] [Thread-1  ]: 1 of 2 OK created python incremental model ARO.add_clients ..................... [[32mSUCCESS 1[0m in 15.86s]
[0m12:12:59.514285 [debug] [Thread-1  ]: Finished running node model.incr_stream.add_clients
[0m12:12:59.516763 [debug] [Thread-3  ]: Began running node model.incr_stream.conso_client
[0m12:12:59.518239 [info ] [Thread-3  ]: 2 of 2 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:12:59.520234 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:12:59.521272 [debug] [Thread-3  ]: Began compiling node model.incr_stream.conso_client
[0m12:12:59.547262 [debug] [Thread-3  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:12:59.549319 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:12:59.522272 => 2023-04-20 12:12:59.549319
[0m12:12:59.550232 [debug] [Thread-3  ]: Began executing node model.incr_stream.conso_client
[0m12:12:59.586267 [debug] [Thread-3  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:12:59.586267 [debug] [Thread-3  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:12:59.586267 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:13:00.320675 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01abc0bd-3201-bafa-0001-2d1600374482
[0m12:13:00.321735 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:13:00.321735 [debug] [Thread-3  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:12:59.550232 => 2023-04-20 12:13:00.321735
[0m12:13:00.322629 [debug] [Thread-3  ]: On model.incr_stream.conso_client: Close
[0m12:13:00.440583 [debug] [Thread-3  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:13:00.441342 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ec97b5-95d1-40f3-94e0-47eb7096174a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E73DE9190>]}
[0m12:13:00.441342 [error] [Thread-3  ]: 2 of 2 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.92s]
[0m12:13:00.443307 [debug] [Thread-3  ]: Finished running node model.incr_stream.conso_client
[0m12:13:00.445352 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:00.446306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:00.447304 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:13:00.447304 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:13:00.448306 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:13:00.448306 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:13:00.448306 [debug] [MainThread]: Connection 'model.incr_stream.add_clients' was properly closed.
[0m12:13:00.449307 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:13:00.449307 [info ] [MainThread]: 
[0m12:13:00.450941 [info ] [MainThread]: Finished running 1 incremental model, 1 incremental_stream model in 0 hours 0 minutes and 19.45 seconds (19.45s).
[0m12:13:00.452307 [debug] [MainThread]: Command end result
[0m12:13:00.464308 [info ] [MainThread]: 
[0m12:13:00.465310 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:13:00.466474 [info ] [MainThread]: 
[0m12:13:00.467310 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:13:00.468309 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:13:00.469308 [info ] [MainThread]: 
[0m12:13:00.471310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:13:00.472328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E73DFFE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E739DCEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E739EA070>]}
[0m12:13:00.473312 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:14:25.118705 | fa12e891-fe97-43ef-9005-1af520552dbf ==============================
[0m12:14:25.118705 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:14:25.120170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:14:25.120706 [debug] [MainThread]: Tracking: tracking
[0m12:14:25.120706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6A7A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6A7AF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6A7AE50>]}
[0m12:14:25.139738 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:14:25.233616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:25.233616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:25.241619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa12e891-fe97-43ef-9005-1af520552dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6B4DDF0>]}
[0m12:14:25.251646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa12e891-fe97-43ef-9005-1af520552dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6B3A040>]}
[0m12:14:25.252619 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:14:25.253621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa12e891-fe97-43ef-9005-1af520552dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6B3A0D0>]}
[0m12:14:25.254653 [info ] [MainThread]: 
[0m12:14:25.256645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:25.258617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:14:25.277665 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:14:25.278652 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:14:25.278652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:26.212129 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:14:26.213957 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:14:26.340348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:14:26.352357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:14:26.364350 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:14:26.370350 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:14:26.370350 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:14:26.371376 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:14:26.372020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:26.372376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:27.143940 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:14:27.150467 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:14:27.164883 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:14:27.169888 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:14:27.284145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa12e891-fe97-43ef-9005-1af520552dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6B2CE50>]}
[0m12:14:27.285662 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:14:27.286623 [info ] [MainThread]: 
[0m12:14:27.296619 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:14:27.298626 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:14:27.301623 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:14:27.302938 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:14:27.312620 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:14:27.316623 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:14:27.303621 => 2023-04-20 12:14:27.316623
[0m12:14:27.316623 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:14:27.366625 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:14:27.367123 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:14:27.367620 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:14:27.872415 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc0be-3201-bb68-0001-2d1600375212
[0m12:14:27.873414 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:14:27.873414 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:14:27.317661 => 2023-04-20 12:14:27.873414
[0m12:14:27.874444 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:14:27.980006 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:14:27.981008 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa12e891-fe97-43ef-9005-1af520552dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6B2CE50>]}
[0m12:14:27.982008 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.68s]
[0m12:14:27.986408 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:14:27.989012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:27.990355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:27.990355 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:14:27.991013 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:14:27.991013 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:14:27.992012 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:14:27.992012 [info ] [MainThread]: 
[0m12:14:27.993156 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m12:14:27.994458 [debug] [MainThread]: Command end result
[0m12:14:28.008012 [info ] [MainThread]: 
[0m12:14:28.009005 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:14:28.010008 [info ] [MainThread]: 
[0m12:14:28.012010 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:14:28.014009 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:14:28.016018 [info ] [MainThread]: 
[0m12:14:28.017046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:14:28.018006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F51D6880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6A7AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F6B3A190>]}
[0m12:14:28.018006 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:16:27.630621 | 37dca51a-81d5-45cc-897a-bcf397d71def ==============================
[0m12:16:27.630621 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:16:27.632628 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:16:27.632628 [debug] [MainThread]: Tracking: tracking
[0m12:16:27.633584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75B77BC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75B77B670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75B77BF40>]}
[0m12:16:27.659586 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:16:27.754883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:27.755621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:27.762618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37dca51a-81d5-45cc-897a-bcf397d71def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75B84CDC0>]}
[0m12:16:27.772583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37dca51a-81d5-45cc-897a-bcf397d71def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75B82CFA0>]}
[0m12:16:27.773582 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:16:27.774583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37dca51a-81d5-45cc-897a-bcf397d71def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75B8390A0>]}
[0m12:16:27.775674 [info ] [MainThread]: 
[0m12:16:27.778681 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:27.779683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:16:27.799681 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:16:27.799681 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:16:27.800681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:28.837462 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:16:28.839460 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:16:28.936465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:16:28.938465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:16:28.945460 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:16:28.948460 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:16:28.949013 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:16:28.949013 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:16:28.949460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:28.949460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:29.774632 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:16:29.775632 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:16:29.917097 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:16:29.919057 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:16:30.200829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37dca51a-81d5-45cc-897a-bcf397d71def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75B896370>]}
[0m12:16:30.201832 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:16:30.203825 [info ] [MainThread]: 
[0m12:16:30.218827 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:16:30.220826 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:16:30.223835 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:16:30.224831 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:16:30.239827 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:16:30.241829 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:16:30.224831 => 2023-04-20 12:16:30.241829
[0m12:16:30.242828 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:16:30.290407 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:16:30.290407 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:16:30.291238 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:16:30.827081 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc0c0-3201-ba10-0001-2d1600372bbe
[0m12:16:30.828082 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:16:30.829080 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:16:30.243823 => 2023-04-20 12:16:30.829080
[0m12:16:30.829080 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:16:30.941683 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:16:30.943690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37dca51a-81d5-45cc-897a-bcf397d71def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75B82CD90>]}
[0m12:16:30.945688 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.72s]
[0m12:16:30.951628 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:16:30.954623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:30.955624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:30.955886 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:16:30.955886 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:16:30.956624 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:16:30.956624 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:16:30.956624 [info ] [MainThread]: 
[0m12:16:30.957984 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m12:16:30.959626 [debug] [MainThread]: Command end result
[0m12:16:30.977587 [info ] [MainThread]: 
[0m12:16:30.978588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:30.979952 [info ] [MainThread]: 
[0m12:16:30.981786 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:16:30.982593 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:16:30.984592 [info ] [MainThread]: 
[0m12:16:30.987589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:16:30.990714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75BBAA2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75BAAE7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A75BAAEF70>]}
[0m12:16:30.990714 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:17:45.973863 | 044a29fe-43e3-43c2-a190-1862cc306700 ==============================
[0m12:17:45.973863 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:17:45.975930 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:17:45.976825 [debug] [MainThread]: Tracking: tracking
[0m12:17:45.976825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CAE5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CAE5E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CAE5FA0>]}
[0m12:17:45.992868 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:17:46.089797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:46.089797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:46.098537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '044a29fe-43e3-43c2-a190-1862cc306700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CB9DDF0>]}
[0m12:17:46.108971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '044a29fe-43e3-43c2-a190-1862cc306700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CB89040>]}
[0m12:17:46.109799 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:17:46.110800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '044a29fe-43e3-43c2-a190-1862cc306700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CB890D0>]}
[0m12:17:46.111806 [info ] [MainThread]: 
[0m12:17:46.113799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:46.114927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:17:46.137834 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:17:46.138834 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:17:46.138834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:47.110401 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:17:47.112393 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:17:47.240559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:17:47.244242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:17:47.265125 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:17:47.270151 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:17:47.270338 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:17:47.271150 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:17:47.271455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:47.272121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:48.081114 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:17:48.084115 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:17:48.129115 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:17:48.131114 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:17:48.242290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '044a29fe-43e3-43c2-a190-1862cc306700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CB7BE50>]}
[0m12:17:48.243275 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:17:48.244239 [info ] [MainThread]: 
[0m12:17:48.254241 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:17:48.257256 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:17:48.260243 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:17:48.261274 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:17:48.280361 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:17:48.283365 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:17:48.261274 => 2023-04-20 12:17:48.283365
[0m12:17:48.285364 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:17:48.346360 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:17:48.346360 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:17:48.346360 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:17:49.285599 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc0c1-3201-bbe1-0001-2d1600377026
[0m12:17:49.286584 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:17:49.286584 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:17:48.286362 => 2023-04-20 12:17:49.286584
[0m12:17:49.286584 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:17:49.390587 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:17:49.391586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '044a29fe-43e3-43c2-a190-1862cc306700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CB7BE50>]}
[0m12:17:49.392587 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.13s]
[0m12:17:49.395591 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:17:49.397585 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:49.398593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:49.398593 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:17:49.399596 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:17:49.399596 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:17:49.399596 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:17:49.400715 [info ] [MainThread]: 
[0m12:17:49.401953 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m12:17:49.402589 [debug] [MainThread]: Command end result
[0m12:17:49.422721 [info ] [MainThread]: 
[0m12:17:49.424592 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:17:49.425592 [info ] [MainThread]: 
[0m12:17:49.426597 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:17:49.427585 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:17:49.428598 [info ] [MainThread]: 
[0m12:17:49.431097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:17:49.435594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CAE5D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CD39B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001597CF138B0>]}
[0m12:17:49.437748 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:18:30.530211 | ae87d359-d80f-41a8-a1dc-919fe4786459 ==============================
[0m12:18:30.530211 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:18:30.532206 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:18:30.532206 [debug] [MainThread]: Tracking: tracking
[0m12:18:30.532206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17D06730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17D06C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17D06FD0>]}
[0m12:18:30.555217 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:18:30.646135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:30.646135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:30.654136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae87d359-d80f-41a8-a1dc-919fe4786459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17DEDEE0>]}
[0m12:18:30.665226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae87d359-d80f-41a8-a1dc-919fe4786459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17DDA160>]}
[0m12:18:30.666136 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:18:30.667151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae87d359-d80f-41a8-a1dc-919fe4786459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17DDA190>]}
[0m12:18:30.668139 [info ] [MainThread]: 
[0m12:18:30.670137 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:18:30.671135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:18:30.691172 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:18:30.692174 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:18:30.692599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:31.598577 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:18:31.600401 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:18:31.702042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:18:31.712051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:18:31.718041 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:18:31.721217 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:18:31.722036 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:18:31.722036 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:18:31.722867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:31.722867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:32.296036 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:18:32.299031 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:18:32.437791 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:18:32.439790 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:18:32.545683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae87d359-d80f-41a8-a1dc-919fe4786459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17F899A0>]}
[0m12:18:32.546681 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:18:32.548645 [info ] [MainThread]: 
[0m12:18:32.561646 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:18:32.563653 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:18:32.568668 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:18:32.570675 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:18:32.587645 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:18:32.589875 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:18:32.571904 => 2023-04-20 12:18:32.589875
[0m12:18:32.590644 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:18:32.640091 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:18:32.640091 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:18:32.641091 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:18:33.183753 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc0c2-3201-ba10-0001-2d1600372bc2
[0m12:18:33.183753 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:18:33.184753 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:18:32.590644 => 2023-04-20 12:18:33.184753
[0m12:18:33.185753 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:18:33.289668 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:18:33.289668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae87d359-d80f-41a8-a1dc-919fe4786459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1814F490>]}
[0m12:18:33.290636 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.72s]
[0m12:18:33.294636 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:18:33.296639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:18:33.297668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:33.298669 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:18:33.299112 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:18:33.299668 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:18:33.299668 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:18:33.300851 [info ] [MainThread]: 
[0m12:18:33.301640 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m12:18:33.303637 [debug] [MainThread]: Command end result
[0m12:18:33.319647 [info ] [MainThread]: 
[0m12:18:33.320884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:18:33.321647 [info ] [MainThread]: 
[0m12:18:33.322639 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:18:33.324660 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:18:33.326637 [info ] [MainThread]: 
[0m12:18:33.328638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:18:33.329641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17FAA040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17DCCEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC17D06A00>]}
[0m12:18:33.330642 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:24:31.740628 | 696ec4a5-0f00-4d4b-b233-ae2e8d5d30c5 ==============================
[0m12:24:31.740628 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:24:31.742591 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:24:31.742591 [debug] [MainThread]: Tracking: tracking
[0m12:24:31.742591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A96D3AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A96D3F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A96D3E80>]}
[0m12:24:31.765751 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:24:31.855713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:31.856907 [debug] [MainThread]: Partial parsing: updated file: incr_stream://models\dwh\conso_client.sql
[0m12:24:31.881738 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m12:24:31.900036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m12:24:31.913061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '696ec4a5-0f00-4d4b-b233-ae2e8d5d30c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A9834EB0>]}
[0m12:24:31.924023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '696ec4a5-0f00-4d4b-b233-ae2e8d5d30c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A97D22B0>]}
[0m12:24:31.925063 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:24:31.926024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '696ec4a5-0f00-4d4b-b233-ae2e8d5d30c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A9776520>]}
[0m12:24:31.927059 [info ] [MainThread]: 
[0m12:24:31.929024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:31.930021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:24:31.952024 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:24:31.952024 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:24:31.952024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:32.892485 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:24:32.894519 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:24:33.013912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:24:33.020911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:24:33.039936 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:24:33.043902 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:24:33.045313 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:24:33.045313 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:24:33.046122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:33.047091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:33.608882 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:24:33.611877 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:24:33.650330 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:24:33.653336 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:24:33.759702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '696ec4a5-0f00-4d4b-b233-ae2e8d5d30c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A96FC7F0>]}
[0m12:24:33.760705 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:24:33.762700 [info ] [MainThread]: 
[0m12:24:33.773705 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:24:33.774707 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:24:33.776699 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:24:33.777701 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:24:33.784699 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:24:33.786703 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:24:33.777701 => 2023-04-20 12:24:33.786703
[0m12:24:33.788758 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:24:33.800735 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:24:33.788758 => 2023-04-20 12:24:33.800735
[0m12:24:33.807737 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  The name argument to ref() must be a string, got <class 'NoneType'>
  
  > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
  > called by model conso_client (models\dwh\conso_client.sql)
[0m12:24:33.808707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696ec4a5-0f00-4d4b-b233-ae2e8d5d30c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A9A55F10>]}
[0m12:24:33.809701 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.03s]
[0m12:24:33.812736 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:24:33.814930 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:33.815705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:33.816704 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:24:33.816946 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:24:33.816946 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:24:33.816946 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:24:33.817702 [info ] [MainThread]: 
[0m12:24:33.819115 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m12:24:33.820702 [debug] [MainThread]: Command end result
[0m12:24:33.836062 [info ] [MainThread]: 
[0m12:24:33.838737 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:33.839701 [info ] [MainThread]: 
[0m12:24:33.842700 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:24:33.843764 [error] [MainThread]:   The name argument to ref() must be a string, got <class 'NoneType'>
[0m12:24:33.844700 [error] [MainThread]:   
[0m12:24:33.845717 [error] [MainThread]:   > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
[0m12:24:33.846699 [error] [MainThread]:   > called by model conso_client (models\dwh\conso_client.sql)
[0m12:24:33.848714 [info ] [MainThread]: 
[0m12:24:33.849702 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:24:33.850702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A96FC7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A9776520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255A9A64E80>]}
[0m12:24:33.851712 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:26:25.159190 | c4e81749-df42-4d31-8b63-10e8740e60fd ==============================
[0m12:26:25.159190 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:26:25.161113 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:26:25.161113 [debug] [MainThread]: Tracking: tracking
[0m12:26:25.161113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582745370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582745EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582745FA0>]}
[0m12:26:25.184122 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:26:25.278282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:25.278282 [debug] [MainThread]: Partial parsing: updated file: incr_stream://models\dwh\conso_client.sql
[0m12:26:25.303286 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m12:26:25.307249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582816340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002858285B3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002858285B370>]}
[0m12:26:25.308290 [debug] [MainThread]: Flushing usage events
[0m12:26:25.695744 [error] [MainThread]: Encountered an error:
Compilation Error in model conso_client (models\dwh\conso_client.sql)
  expected token ',', got 'src_table'
    line 5
      src_table='add_clients'


============================== 2023-04-20 12:26:40.365115 | a218926f-1398-4016-a623-f49d1641c8d2 ==============================
[0m12:26:40.365115 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:26:40.366911 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:26:40.367789 [debug] [MainThread]: Tracking: tracking
[0m12:26:40.367789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8E6B5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8E6B5C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8E6B5F70>]}
[0m12:26:40.387802 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:26:40.484824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:40.484824 [debug] [MainThread]: Partial parsing: updated file: incr_stream://models\dwh\conso_client.sql
[0m12:26:40.512787 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m12:26:40.534302 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m12:26:40.546338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a218926f-1398-4016-a623-f49d1641c8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8E823EE0>]}
[0m12:26:40.557463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a218926f-1398-4016-a623-f49d1641c8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8E7C0640>]}
[0m12:26:40.558306 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:26:40.558306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a218926f-1398-4016-a623-f49d1641c8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8E7665B0>]}
[0m12:26:40.560304 [info ] [MainThread]: 
[0m12:26:40.562315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:40.564317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:26:40.584338 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:26:40.584338 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:26:40.585229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:41.563898 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:26:41.567900 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:26:41.677956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:26:41.683896 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:26:41.705938 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:26:41.712897 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:26:41.713928 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:26:41.714889 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:26:41.714889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:41.715928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:42.311337 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:26:42.313332 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:26:42.653008 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:26:42.656039 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:26:42.755080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a218926f-1398-4016-a623-f49d1641c8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8EA0B070>]}
[0m12:26:42.755772 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:26:42.756771 [info ] [MainThread]: 
[0m12:26:42.766770 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:26:42.767771 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:26:42.771418 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:26:42.771772 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:26:42.777807 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:26:42.779769 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:26:42.771772 => 2023-04-20 12:26:42.779769
[0m12:26:42.779769 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:26:42.828773 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:26:42.829774 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:26:42.829774 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:26:43.438452 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc0ca-3201-bbe1-0001-2d160037703a
[0m12:26:43.439484 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:26:43.440488 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:26:42.780772 => 2023-04-20 12:26:43.439484
[0m12:26:43.440488 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:26:43.544142 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:26:43.545142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a218926f-1398-4016-a623-f49d1641c8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8E7C01C0>]}
[0m12:26:43.546142 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.78s]
[0m12:26:43.550138 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:26:43.553133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:43.554133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:43.555131 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:26:43.555131 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:26:43.555131 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:26:43.556133 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:26:43.557138 [info ] [MainThread]: 
[0m12:26:43.558177 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m12:26:43.559163 [debug] [MainThread]: Command end result
[0m12:26:43.575133 [info ] [MainThread]: 
[0m12:26:43.577219 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:26:43.578139 [info ] [MainThread]: 
[0m12:26:43.580177 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:26:43.581134 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:26:43.582132 [info ] [MainThread]: 
[0m12:26:43.585145 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:26:43.587132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8EA6B9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8EA6B730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F8EA6B490>]}
[0m12:26:43.588170 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:27:09.153958 | df61792a-e15a-4422-a6cf-88f0e8559b4b ==============================
[0m12:27:09.153958 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:27:09.155921 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:27:09.156968 [debug] [MainThread]: Tracking: tracking
[0m12:27:09.156968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB825CABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB825CAFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB825CAEB0>]}
[0m12:27:09.188924 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:27:09.287216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:09.287922 [debug] [MainThread]: Partial parsing: updated file: incr_stream://models\dwh\conso_client.sql
[0m12:27:09.313922 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m12:27:09.334302 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m12:27:09.349294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df61792a-e15a-4422-a6cf-88f0e8559b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB82723F10>]}
[0m12:27:09.360400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df61792a-e15a-4422-a6cf-88f0e8559b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB826C19D0>]}
[0m12:27:09.360400 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:27:09.361884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df61792a-e15a-4422-a6cf-88f0e8559b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB826665E0>]}
[0m12:27:09.363338 [info ] [MainThread]: 
[0m12:27:09.366295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:09.368336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:27:09.388407 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:27:09.389407 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:27:09.389407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:10.362761 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:27:10.365736 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:27:10.489721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:27:10.494669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:27:10.518698 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:27:10.524666 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:27:10.525934 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:27:10.526669 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:27:10.526669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:10.527833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:11.289333 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:27:11.293190 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:27:11.310741 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:27:11.314741 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:27:11.449337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df61792a-e15a-4422-a6cf-88f0e8559b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB8290E070>]}
[0m12:27:11.451364 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:27:11.454324 [info ] [MainThread]: 
[0m12:27:11.472303 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:27:11.473465 [info ] [Thread-1  ]: 1 of 1 START sql incremental model ARO_DWH.conso_client ........................ [RUN]
[0m12:27:11.477306 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:27:11.478334 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:27:11.485846 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:27:11.487467 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:27:11.479539 => 2023-04-20 12:27:11.487467
[0m12:27:11.487467 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:27:11.586607 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m12:27:11.636807 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:27:11.636807 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
create or replace transient table PERSO.ARO_DWH.conso_client  as
        (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO.add_clients
        );
[0m12:27:11.636807 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:27:14.119634 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m12:27:14.141265 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:27:14.142822 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
drop view if exists PERSO.ARO_DWH.conso_client__dbt_tmp cascade
[0m12:27:14.206894 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:27:14.249855 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:27:11.488305 => 2023-04-20 12:27:14.249855
[0m12:27:14.249855 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:27:14.357210 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df61792a-e15a-4422-a6cf-88f0e8559b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB82A33670>]}
[0m12:27:14.359924 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model ARO_DWH.conso_client ................... [[32mSUCCESS 1[0m in 2.88s]
[0m12:27:14.365959 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:27:14.369955 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:14.371955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:14.372956 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:27:14.373952 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:27:14.373952 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:27:14.374953 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:27:14.375920 [info ] [MainThread]: 
[0m12:27:14.377926 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m12:27:14.378950 [debug] [MainThread]: Command end result
[0m12:27:14.396939 [info ] [MainThread]: 
[0m12:27:14.397926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:14.399194 [info ] [MainThread]: 
[0m12:27:14.400925 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:27:14.401922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB82935C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB826C8F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB82666640>]}
[0m12:27:14.401922 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:27:27.105070 | 2e84d0e2-1c83-4caa-a457-f71557f72ab3 ==============================
[0m12:27:27.105070 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:27:27.107034 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:27:27.107034 [debug] [MainThread]: Tracking: tracking
[0m12:27:27.108071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03853B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03853BF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03853BE20>]}
[0m12:27:27.124034 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:27:27.227542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:27.228579 [debug] [MainThread]: Partial parsing: updated file: incr_stream://models\dwh\conso_client.sql
[0m12:27:27.255541 [debug] [MainThread]: 1603: static parser failed on dwh\conso_client.sql
[0m12:27:27.275327 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dwh\conso_client.sql
[0m12:27:27.287822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e84d0e2-1c83-4caa-a457-f71557f72ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C038694E80>]}
[0m12:27:27.298671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e84d0e2-1c83-4caa-a457-f71557f72ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C038631130>]}
[0m12:27:27.298671 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:27:27.299671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e84d0e2-1c83-4caa-a457-f71557f72ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0385D5550>]}
[0m12:27:27.301719 [info ] [MainThread]: 
[0m12:27:27.303755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:27.305672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:27:27.325682 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:27:27.326684 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:27:27.327695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:28.251431 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:27:28.255423 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:27:28.387641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:27:28.391898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:27:28.403450 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:27:28.410414 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:27:28.411412 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:27:28.411412 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:27:28.412412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:28.412412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:29.218660 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:27:29.220665 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:27:29.231621 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:27:29.233772 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:27:29.375659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e84d0e2-1c83-4caa-a457-f71557f72ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03855B4F0>]}
[0m12:27:29.376660 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:27:29.378325 [info ] [MainThread]: 
[0m12:27:29.385681 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:27:29.385681 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:27:29.387658 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:27:29.388660 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:27:29.397703 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:27:29.400664 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:27:29.388660 => 2023-04-20 12:27:29.400664
[0m12:27:29.400664 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:27:29.460546 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:27:29.461659 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:27:29.461659 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:27:30.164598 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc0cb-3201-ba10-0001-2d1600372bda
[0m12:27:30.165600 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:27:30.166596 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:27:29.401783 => 2023-04-20 12:27:30.166596
[0m12:27:30.166596 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:27:30.319335 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:27:30.320334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e84d0e2-1c83-4caa-a457-f71557f72ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0389CE2E0>]}
[0m12:27:30.320896 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.93s]
[0m12:27:30.323905 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:27:30.325690 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:30.326692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:30.326692 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:27:30.326692 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:27:30.326692 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:27:30.327765 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:27:30.327765 [info ] [MainThread]: 
[0m12:27:30.328866 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m12:27:30.330689 [debug] [MainThread]: Command end result
[0m12:27:30.343692 [info ] [MainThread]: 
[0m12:27:30.345692 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:30.346693 [info ] [MainThread]: 
[0m12:27:30.347692 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:27:30.348691 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:27:30.349690 [info ] [MainThread]: 
[0m12:27:30.351706 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:27:30.352732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0389C5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03855B460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0388DAC40>]}
[0m12:27:30.353700 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:30:43.312767 | 2dcf22ed-63f1-4223-8f7b-b740ce9d0bcd ==============================
[0m12:30:43.312767 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:30:43.314768 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:30:43.314768 [debug] [MainThread]: Tracking: tracking
[0m12:30:43.315814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5EC6B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5EC6F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5EC6E50>]}
[0m12:30:43.347729 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:30:43.441763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:43.442822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:43.450816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dcf22ed-63f1-4223-8f7b-b740ce9d0bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5FACDF0>]}
[0m12:30:43.461772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dcf22ed-63f1-4223-8f7b-b740ce9d0bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5F98040>]}
[0m12:30:43.462764 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:30:43.463918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dcf22ed-63f1-4223-8f7b-b740ce9d0bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5F981C0>]}
[0m12:30:43.464766 [info ] [MainThread]: 
[0m12:30:43.467734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:30:43.469840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:30:43.500732 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:30:43.505738 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:30:43.506737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:44.895100 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:30:44.898101 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:30:45.007371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:30:45.009272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:30:45.022270 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:30:45.025270 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:30:45.025270 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:30:45.026272 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:30:45.027276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:45.027276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:45.870843 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:30:45.873845 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:30:45.981979 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:30:45.986845 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:30:46.090557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dcf22ed-63f1-4223-8f7b-b740ce9d0bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5FF7250>]}
[0m12:30:46.091558 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:30:46.093560 [info ] [MainThread]: 
[0m12:30:46.109560 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:30:46.111726 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:30:46.114561 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:30:46.119566 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:30:46.134564 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:30:46.139557 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:30:46.121562 => 2023-04-20 12:30:46.139557
[0m12:30:46.140565 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:30:46.245722 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:30:46.245722 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
select count(1) from PERSO.ARO_DWH.S_conso_client
[0m12:30:46.246722 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:30:47.156915 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01abc0ce-3201-bb65-0001-2d1600376056
[0m12:30:47.157914 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:30:47.157914 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:30:46.141864 => 2023-04-20 12:30:47.157914
[0m12:30:47.158916 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:30:47.294257 [debug] [Thread-1  ]: Database Error in model conso_client (models\dwh\conso_client.sql)
  091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:30:47.295339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dcf22ed-63f1-4223-8f7b-b740ce9d0bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E4636880>]}
[0m12:30:47.296257 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 1.18s]
[0m12:30:47.300259 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:30:47.303273 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:30:47.304261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:47.304261 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:30:47.305327 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:30:47.305327 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:30:47.306262 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:30:47.306262 [info ] [MainThread]: 
[0m12:30:47.307514 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m12:30:47.309260 [debug] [MainThread]: Command end result
[0m12:30:47.325454 [info ] [MainThread]: 
[0m12:30:47.326259 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:47.328264 [info ] [MainThread]: 
[0m12:30:47.330268 [error] [MainThread]: [33mDatabase Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:30:47.334745 [error] [MainThread]:   091901 (01000): Base table 'PERSO.ARO.ADD_CLIENTS' dropped, cannot read from stream 'S_CONSO_CLIENT' in line 1 position 21.
[0m12:30:47.336719 [info ] [MainThread]: 
[0m12:30:47.337262 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:30:47.338303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5FE1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E61E90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E616CF40>]}
[0m12:30:47.339297 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:31:35.360411 | da8e6f4c-1c9c-46d0-bb91-d7e78cdf8989 ==============================
[0m12:31:35.360411 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:31:35.362271 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:31:35.362271 [debug] [MainThread]: Tracking: tracking
[0m12:31:35.363272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA135BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA135FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA135EB0>]}
[0m12:31:35.387222 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:31:35.476606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:35.476606 [debug] [MainThread]: Partial parsing: updated file: incr_stream://macros\materializations\incremental_stream.sql
[0m12:31:35.517524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da8e6f4c-1c9c-46d0-bb91-d7e78cdf8989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA21DEB0>]}
[0m12:31:35.526619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da8e6f4c-1c9c-46d0-bb91-d7e78cdf8989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA1CBEB0>]}
[0m12:31:35.527512 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:31:35.528513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8e6f4c-1c9c-46d0-bb91-d7e78cdf8989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA179040>]}
[0m12:31:35.529512 [info ] [MainThread]: 
[0m12:31:35.531512 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:35.533516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:31:35.555492 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:31:35.556457 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:31:35.556457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:36.495655 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:31:36.500659 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:31:36.621920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:31:36.627939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:31:36.642951 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:31:36.646922 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:31:36.648565 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:31:36.649226 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:31:36.649950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:36.650922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:37.295370 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:31:37.300329 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:31:37.491038 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:31:37.495037 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:31:37.622808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8e6f4c-1c9c-46d0-bb91-d7e78cdf8989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA1D9430>]}
[0m12:31:37.626809 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:31:37.631806 [info ] [MainThread]: 
[0m12:31:37.649175 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:31:37.650029 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:31:37.653991 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:31:37.655440 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:31:37.661995 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:31:37.664200 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:31:37.656026 => 2023-04-20 12:31:37.664200
[0m12:31:37.664990 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:31:37.711026 [info ] [Thread-1  ]:   =>  record(s) to merge
[0m12:31:37.711989 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:31:37.664990 => 2023-04-20 12:31:37.711989
[0m12:31:37.716991 [debug] [Thread-1  ]: Compilation Error in model conso_client (models\dwh\conso_client.sql)
  'v_count' is undefined
  
  > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
  > called by model conso_client (models\dwh\conso_client.sql)
[0m12:31:37.719431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da8e6f4c-1c9c-46d0-bb91-d7e78cdf8989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA49E880>]}
[0m12:31:37.720990 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental_stream model ARO_DWH.conso_client ........ [[31mERROR[0m in 0.07s]
[0m12:31:37.723027 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:31:37.724992 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:37.725995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:37.727019 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:31:37.727019 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:31:37.727019 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:31:37.727991 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:31:37.727991 [info ] [MainThread]: 
[0m12:31:37.728989 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m12:31:37.730001 [debug] [MainThread]: Command end result
[0m12:31:37.743992 [info ] [MainThread]: 
[0m12:31:37.744990 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:31:37.745991 [info ] [MainThread]: 
[0m12:31:37.746991 [error] [MainThread]: [33mCompilation Error in model conso_client (models\dwh\conso_client.sql)[0m
[0m12:31:37.748997 [error] [MainThread]:   'v_count' is undefined
[0m12:31:37.751164 [error] [MainThread]:   
[0m12:31:37.754266 [error] [MainThread]:   > in macro materialization_incremental_stream_snowflake (macros\materializations\incremental_stream.sql)
[0m12:31:37.755169 [error] [MainThread]:   > called by model conso_client (models\dwh\conso_client.sql)
[0m12:31:37.755992 [info ] [MainThread]: 
[0m12:31:37.757001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:37.757990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA179040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA21DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA13BAF0>]}
[0m12:31:37.758991 [debug] [MainThread]: Flushing usage events


============================== 2023-04-20 12:32:24.491012 | 404129a7-84cb-45a3-a38f-a3b6d87035dc ==============================
[0m12:32:24.491012 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:32:24.493008 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:32:24.493972 [debug] [MainThread]: Tracking: tracking
[0m12:32:24.493972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C67C123580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C67C123F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C67C123E80>]}
[0m12:32:24.514015 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:32:24.604781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:24.604781 [debug] [MainThread]: Partial parsing: updated file: incr_stream://macros\materializations\incremental_stream.sql
[0m12:32:24.613782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C67C1E87C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C67C1E8E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C67C1E8F10>]}
[0m12:32:24.614131 [debug] [MainThread]: Flushing usage events
[0m12:32:24.998708 [error] [MainThread]: Encountered an error:
Compilation Error
  Encountered unknown tag 'endset'. Jinja was looking for the following tags: 'elif' or 'else' or 'endif'. The innermost block that needs to be closed is 'if'.
    line 36
      {%- endset -%}


============================== 2023-04-20 12:33:37.749758 | 760b222c-b775-4b63-a9d4-bdbd59455e9d ==============================
[0m12:33:37.749758 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:33:37.751652 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\arover\\PycharmProjects\\incremental_stream', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'vars': 'nb_clients: 70', 'select': ['conso_client'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:33:37.752600 [debug] [MainThread]: Tracking: tracking
[0m12:33:37.752600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2744EF670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2744EFBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2744EFF40>]}
[0m12:33:37.773591 [debug] [MainThread]: checksum: 97d339037fb4c725d33dad66a7d001c43e0ce359acdc5ae7a2fbd33cddebf151, vars: {'nb_clients': 70}, profile: None, target: None, version: 1.4.6
[0m12:33:37.862627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:37.862627 [debug] [MainThread]: Partial parsing: updated file: incr_stream://macros\materializations\incremental_stream.sql
[0m12:33:37.900637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '760b222c-b775-4b63-a9d4-bdbd59455e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2745F8EE0>]}
[0m12:33:37.911630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '760b222c-b775-4b63-a9d4-bdbd59455e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D274596220>]}
[0m12:33:37.911630 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:33:37.912622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '760b222c-b775-4b63-a9d4-bdbd59455e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D274596310>]}
[0m12:33:37.914594 [info ] [MainThread]: 
[0m12:33:37.916596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:37.918595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO'
[0m12:33:37.939961 [debug] [ThreadPool]: Using snowflake connection "list_PERSO"
[0m12:33:37.941116 [debug] [ThreadPool]: On list_PERSO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO"} */
show terse schemas in database PERSO
    limit 10000
[0m12:33:37.941116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:38.928867 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:33:38.931668 [debug] [ThreadPool]: On list_PERSO: Close
[0m12:33:39.059005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO_DWH'
[0m12:33:39.071972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PERSO_ARO'
[0m12:33:39.074004 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO_DWH"
[0m12:33:39.077005 [debug] [ThreadPool]: Using snowflake connection "list_PERSO_ARO"
[0m12:33:39.077005 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO_DWH"} */
show terse objects in PERSO.ARO_DWH
[0m12:33:39.078186 [debug] [ThreadPool]: On list_PERSO_ARO: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "connection_name": "list_PERSO_ARO"} */
show terse objects in PERSO.ARO
[0m12:33:39.078186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:39.079080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:39.814921 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m12:33:39.817924 [debug] [ThreadPool]: On list_PERSO_ARO_DWH: Close
[0m12:33:40.017824 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m12:33:40.019824 [debug] [ThreadPool]: On list_PERSO_ARO: Close
[0m12:33:40.179644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '760b222c-b775-4b63-a9d4-bdbd59455e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2745ABE80>]}
[0m12:33:40.181136 [info ] [MainThread]: Concurrency: 4 threads (target='DEV')
[0m12:33:40.183138 [info ] [MainThread]: 
[0m12:33:40.198130 [debug] [Thread-1  ]: Began running node model.incr_stream.conso_client
[0m12:33:40.200133 [info ] [Thread-1  ]: 1 of 1 START sql incremental_stream model ARO_DWH.conso_client ................. [RUN]
[0m12:33:40.205158 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.incr_stream.conso_client'
[0m12:33:40.206365 [debug] [Thread-1  ]: Began compiling node model.incr_stream.conso_client
[0m12:33:40.216132 [debug] [Thread-1  ]: Writing injected SQL for node "model.incr_stream.conso_client"
[0m12:33:40.217601 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (compile): 2023-04-20 12:33:40.207129 => 2023-04-20 12:33:40.217158
[0m12:33:40.218159 [debug] [Thread-1  ]: Began executing node model.incr_stream.conso_client
[0m12:33:40.266163 [info ] [Thread-1  ]:   => No new data available in PERSO.ARO_DWH.S_conso_client
[0m12:33:40.268131 [debug] [Thread-1  ]: Writing runtime sql for node "model.incr_stream.conso_client"
[0m12:33:40.270128 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:33:40.271231 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP TABLE PERSO.ARO_DWH.conso_client;
[0m12:33:40.271231 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:33:40.931842 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m12:33:40.931842 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:33:40.932852 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
DROP STREAM PERSO.ARO_DWH.S_conso_client;
[0m12:33:41.013853 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:33:41.014850 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:33:41.015265 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE STREAM IF NOT EXISTS PERSO.ARO_DWH.S_conso_client ON TABLE PERSO.ARO.add_clients APPEND_ONLY=TRUE;
[0m12:33:41.334286 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:33:41.338282 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:33:41.340276 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE OR REPLACE VIEW PERSO.ARO_DWH.V_conso_client
    AS (select ID, FIRST_NAME, LAST_NAME, BIRTHDATE
from PERSO.ARO.add_clients);
[0m12:33:41.659762 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:33:41.660772 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:33:41.661795 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
CREATE TABLE IF NOT EXISTS PERSO.ARO_DWH.conso_client
AS SELECT * FROM (PERSO.ARO_DWH.V_conso_client);
[0m12:33:42.386016 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m12:33:42.387007 [debug] [Thread-1  ]: Using snowflake connection "model.incr_stream.conso_client"
[0m12:33:42.388008 [debug] [Thread-1  ]: On model.incr_stream.conso_client: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "my-snowflake-db", "target_name": "DEV", "node_id": "model.incr_stream.conso_client"} */
SELECT current_timestamp();
[0m12:33:42.463076 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m12:33:42.465076 [debug] [Thread-1  ]: Timing info for model.incr_stream.conso_client (execute): 2023-04-20 12:33:40.218159 => 2023-04-20 12:33:42.465076
[0m12:33:42.465076 [debug] [Thread-1  ]: On model.incr_stream.conso_client: Close
[0m12:33:42.597374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '760b222c-b775-4b63-a9d4-bdbd59455e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2745F8F40>]}
[0m12:33:42.598390 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental_stream model ARO_DWH.conso_client ............ [[32mSUCCESS 1[0m in 2.39s]
[0m12:33:42.602359 [debug] [Thread-1  ]: Finished running node model.incr_stream.conso_client
[0m12:33:42.604347 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:42.605382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:42.607371 [debug] [MainThread]: Connection 'list_PERSO' was properly closed.
[0m12:33:42.607371 [debug] [MainThread]: Connection 'list_PERSO_ARO_DWH' was properly closed.
[0m12:33:42.608345 [debug] [MainThread]: Connection 'list_PERSO_ARO' was properly closed.
[0m12:33:42.608345 [debug] [MainThread]: Connection 'model.incr_stream.conso_client' was properly closed.
[0m12:33:42.608345 [info ] [MainThread]: 
[0m12:33:42.609606 [info ] [MainThread]: Finished running 1 incremental_stream model in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m12:33:42.610391 [debug] [MainThread]: Command end result
[0m12:33:42.622343 [info ] [MainThread]: 
[0m12:33:42.624342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:42.625344 [info ] [MainThread]: 
[0m12:33:42.626347 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:33:42.627343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27482D340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27450B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2745961F0>]}
[0m12:33:42.627343 [debug] [MainThread]: Flushing usage events
